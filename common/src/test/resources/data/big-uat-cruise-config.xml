<?xml version="1.0" encoding="utf-8"?>
<!-- *
 * Copyright 2020 ThoughtWorks, Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *    http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * -->

<cruise xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="cruise-config.xsd" schemaVersion="17">
  <server artifactsdir="logs">
    <license user="Cruise UAT ThoughtWorks Beijing">O5jEQXU0iS9kBdn+l2rSO+uEXvik+G8uNRiaUr1qxOKKLa+EBKMmSFIpDrYw&#xD;
dwDsd+MtfgiuAk5MDFImDhOT7R9HuKV7qqGI/a5ktRcBsuPGbYcxwJwbN5pv&#xD;
OrEjueo23vMefUn/AxmPtgXaU++yqAPCJ/PXGBg+0LSpe40Z+m2OUz9Pr6BH&#xD;
bNoig0/gA57KaziiFazsMdD0EYy83gN7HQdolSEImIZJuW9ABG0WAzPhscFh&#xD;
hOI0BEABLEI+yIvWc8zfm6D8bhR4i+3ufPYc+q1J9+00VHY60QPgR2CBE3p5&#xD;
BvpkX64b6XCyV9logzYeEr2MRUzct0hkGhGYZkzMag==</license>
    <security>
      <ldap uri="ldap://localhost:12339" managerDn="cn=Active Directory Ldap User,ou=SomeSystems,ou=Accounts,ou=Principal,dc=corp,dc=somecompany,dc=com" managerPassword="some-password" searchBase="ou=Employees,ou=Company,ou=Principal,dc=corp,dc=somecompany,dc=com" searchFilter="(sAMAccountName={0})" />
      <passwordFile path="/etc/cruise/password.properties" />
      <roles>
        <role name="admins">
          <user>djrice</user>
          <user>vgarg</user>
        </role>
        <role name="developer">
          <user>hraberg</user>
          <user>vgarg</user>
          <user>goleys</user>
        </role>
        <role name="QA_lead">
          <user>vgarg</user>
        </role>
      </roles>
      <admins>
        <role>admins</role>
      </admins>
    </security>
    <mailhost hostname="chimpmail.somewhere.com" port="25" tls="false" from="ccedev@somewhere.com" admin="csteven@somewhere.com" />
  </server>
  <pipelines group="temp">
    <pipeline name="testing" labeltemplate="2.0.0.${CRUISE}-${TRUNK}">
      <trackingtool link="https://mingle.somewhere.com/projects/cruise/cards/${ID}" regex="#(\d+)" />
      <materials>
        <hg url="https://abc:def@fmtstdscm01.somewhere.com/cruise" materialName="trunk" />
        <pipeline pipelineName="cruise" stageName="dist-zip" materialName="CRUISE" />
      </materials>
      <stage name="twist">
        <jobs>
          <job name="jsunit">
            <tasks>
              <exec command="localivy/jruby/bin/jruby" args="-S buildr cruise:misc:jsunit ratchet=no test=no" />
            </tasks>
            <resources>
              <resource>testing</resource>
            </resources>
            <artifacts>
              <artifact src="target/server/jsunit/logs" />
            </artifacts>
          </job>
          <job name="linux-rails">
            <tasks>
              <exec command="localivy/jruby/bin/jruby" args="-S buildr clean cruise:rails:spec ratchet=no test=no" />
            </tasks>
            <tabs>
              <tab name="Console" path="cruise-output/console.log" />
              <tab name="Specs" path="specs/spec_full_report.html" />
            </tabs>
            <resources>
              <resource>testing</resource>
            </resources>
            <artifacts>
              <test src="target/specs" />
            </artifacts>
          </job>
          <job name="linux-firefox">
            <tasks>
              <exec command="localivy/jruby/bin/jruby" args="-S buildr clean build to=common ratchet=no" />
            </tasks>
            <tabs>
              <tab name="Console" path="cruise-output/console.log" />
              <tab name="Junit-time" path="reports/junit-time-report.html" />
            </tabs>
            <resources>
              <resource>testing</resource>
            </resources>
            <artifacts>
              <test src="target/reports" />
            </artifacts>
          </job>
          <job name="help">
            <tasks>
              <rake workingdir="helper" />
            </tasks>
            <tabs>
              <tab name="Documentation" path="output/build/index.html" />
            </tabs>
            <resources>
              <resource>testing</resource>
            </resources>
            <artifacts>
              <artifact src="helper/build" dest="output" />
            </artifacts>
          </job>
          <job name="smoke">
            <tasks>
              <exec command="rm" args="-rf target/*" />
              <exec command="localivy/jruby/bin/jruby" args="-S buildr clean dist cruise:cruise-twist-new:clean cruise:cruise-twist-new:compile cruise:cruise-twist-new:twist test=no twist=yes ratchet=no TWIST_TAGS='smoke'" />
            </tasks>
            <tabs>
              <tab name="Twist" path="twistreports/twist/html/index.html" />
            </tabs>
            <resources>
              <resource>testing</resource>
            </resources>
            <artifacts>
              <artifact src="target/reports/twist" dest="twistreports" />
              <artifact src="target/twist-agents/*/*.log" dest="agent/logs" />
              <artifact src="target/cruise-server-*/*.log" dest="server/logs" />
              <artifact src="target/cruise-server-*/config" dest="server/config" />
            </artifacts>
          </job>
          <job name="firefox">
            <tasks>
              <exec command="/bin/bash" args="-c 'rm -rf target/pkg/*.zip'" />
              <exec command="/bin/bash" args="-c 'rm -rf target/*'" />
              <fetchartifact pipeline="cruise" stage="dist-zip" job="zip" srcdir="pkg" dest="target" />
              <exec command="unzip" args="-o target/pkg/cruise-server-*-*.zip -d target" />
              <exec command="unzip" args="-o target/pkg/cruise-agent-*-*.zip -d target" />
              <exec command="chmod" args="+x target/cruise-server-*/server.sh" />
              <exec command="chmod" args="+x target/cruise-server-*/stop-server.sh" />
              <exec command="chmod" args="+x target/cruise-agent-*/agent.sh" />
              <exec command="chmod" args="+x target/cruise-agent-*/stop-agent.sh" />
              <exec command="localivy/jruby/bin/jruby" args="-S buildr cruise:cruise-twist-new:clean cruise:cruise-twist-new:compile cruise:cruise-twist-new:twist test=no twist=yes ratchet=no shine=yes TWIST_TAGS='smoke'" />
            </tasks>
            <tabs>
              <tab name="Twist" path="twistreports/twist/html/index.html" />
            </tabs>
            <resources>
              <resource>testing</resource>
            </resources>
            <artifacts>
              <artifact src="target/reports/twist" dest="twistreports" />
              <artifact src="target/twist-agents/*/*.log" dest="agent/logs" />
              <artifact src="target/cruise-server-*/*.log" dest="server/logs" />
              <artifact src="target/cruise-server-*/config" dest="server/config" />
              <test src="target/reports/twist/xml" />
            </artifacts>
          </job>
          <job name="debian">
            <environmentvariables>
              <variable name="JAVA_MEM">-Xmx750m</variable>
            </environmentvariables>
            <tasks>
              <exec command="localivy/jruby/bin/jruby" args="-S buildr clean cruise:pkg:debian test=no" />
            </tasks>
            <resources>
              <resource>testing</resource>
            </resources>
            <artifacts>
              <artifact src="target/pkg/*.*" dest="pkg" />
            </artifacts>
          </job>
        </jobs>
      </stage>
    </pipeline>
  </pipelines>
  <pipelines group="cruise-trunk">
    <pipeline name="cruise" labeltemplate="2.0.0.${COUNT}-${TRUNK}">
      <trackingtool link="https://mingle.somewhere.com/projects/cruise/cards/${ID}" regex="#(\d+)" />
      <materials>
        <hg url="https://abc:def@fmtstdscm01.somewhere.com/cruise" materialName="trunk">
          <filter>
            <ignore pattern="helper/**/*.*" />
            <ignore pattern="spike/**/*.*" />
            <ignore pattern="QA/**/*.*" />
            <ignore pattern="**/*.css" />
            <ignore pattern="performance/ec2/**/*.*" />
            <ignore pattern="performance/ec3/**/*.*" />
            <ignore pattern="manual-testing/**/*.*" />
            <ignore pattern="cruise-twist-new/**/*.*" />
          </filter>
        </hg>
      </materials>
      <stage name="dev">
        <approval type="success">
          <authorization>
            <role>admins</role>
          </authorization>
        </approval>
        <environmentvariables>
          <variable name="TLB_CRITERIA">com.thoughtworks.go.tlb.splitter.DefaultingTestSplitterCriteria</variable>
          <variable name="CRITERIA_DEFAULTING_ORDER">com.thoughtworks.go.tlb.splitter.CountBasedTestSplitterCriteria</variable>
          <variable name="TLB_TMP_DIR">/tmp</variable>
          <variable name="load_balance">no</variable>
          <variable name="TLB_USERNAME">both</variable>
          <variable name="TLB_PASSWORD">badger</variable>
          <variable name="TLB_ORDERER">com.thoughtworks.go.tlb.orderer.FailedFirstOrderer</variable>
        </environmentvariables>
        <jobs>
          <job name="jsunit">
            <tasks>
              <exec command="localivy/jruby/bin/jruby" args="-S buildr cruise:misc:jsunit ratchet=no test=no" />
            </tasks>
            <resources>
              <resource>linux</resource>
              <resource>java</resource>
            </resources>
            <artifacts>
              <artifact src="target/server/jsunit/logs" />
            </artifacts>
          </job>
          <job name="linux-rails">
            <tasks>
              <exec command="localivy/jruby/bin/jruby" args="-S buildr clean cruise:rails:spec ratchet=no test=no" />
            </tasks>
            <tabs>
              <tab name="Console" path="cruise-output/console.log" />
              <tab name="Specs" path="specs/spec_full_report.html" />
            </tabs>
            <resources>
              <resource>linux</resource>
              <resource>dev</resource>
            </resources>
            <artifacts>
              <test src="target/specs" />
            </artifacts>
          </job>
          <job name="windows-1">
            <environmentvariables>
              <variable name="TLB_TMP_DIR">C:\tlb_tmp_dir</variable>
            </environmentvariables>
            <tasks>
              <exec command="localivy/jruby/bin/jruby.bat" args="-S buildr clean build ratchet=no" />
            </tasks>
            <resources>
              <resource>windows</resource>
              <resource>dev</resource>
            </resources>
            <artifacts>
              <test src="target/reports" />
            </artifacts>
          </job>
          <job name="windows-2">
            <environmentvariables>
              <variable name="TLB_TMP_DIR">C:\tlb_tmp_dir</variable>
            </environmentvariables>
            <tasks>
              <exec command="localivy/jruby/bin/jruby.bat" args="-S buildr clean build ratchet=no" />
            </tasks>
            <resources>
              <resource>windows</resource>
              <resource>dev</resource>
            </resources>
            <artifacts>
              <test src="target/reports" />
            </artifacts>
          </job>
          <job name="windows-3">
            <environmentvariables>
              <variable name="TLB_TMP_DIR">C:\tlb_tmp_dir</variable>
            </environmentvariables>
            <tasks>
              <exec command="localivy/jruby/bin/jruby.bat" args="-S buildr clean build ratchet=no" />
            </tasks>
            <resources>
              <resource>windows</resource>
              <resource>dev</resource>
              <resource>blr</resource>
            </resources>
            <artifacts>
              <test src="target/reports" />
            </artifacts>
          </job>
          <job name="windows-4">
            <environmentvariables>
              <variable name="TLB_TMP_DIR">C:\tlb_tmp_dir</variable>
            </environmentvariables>
            <tasks>
              <exec command="localivy/jruby/bin/jruby.bat" args="-S buildr clean build ratchet=no" />
            </tasks>
            <resources>
              <resource>windows</resource>
              <resource>dev</resource>
            </resources>
            <artifacts>
              <test src="target/reports" />
            </artifacts>
          </job>
          <job name="windows-5">
            <environmentvariables>
              <variable name="TLB_TMP_DIR">C:\tlb_tmp_dir</variable>
            </environmentvariables>
            <tasks>
              <exec command="localivy/jruby/bin/jruby.bat" args="-S buildr clean build ratchet=no" />
            </tasks>
            <resources>
              <resource>windows</resource>
              <resource>dev</resource>
            </resources>
            <artifacts>
              <test src="target/reports" />
            </artifacts>
          </job>
          <job name="windows-6">
            <environmentvariables>
              <variable name="TLB_TMP_DIR">C:\tlb_tmp_dir</variable>
            </environmentvariables>
            <tasks>
              <exec command="localivy/jruby/bin/jruby.bat" args="-S buildr clean build ratchet=no" />
            </tasks>
            <resources>
              <resource>windows</resource>
              <resource>dev</resource>
            </resources>
            <artifacts>
              <test src="target/reports" />
            </artifacts>
          </job>
          <job name="windows-7">
            <environmentvariables>
              <variable name="TLB_TMP_DIR">C:\tlb_tmp_dir</variable>
            </environmentvariables>
            <tasks>
              <exec command="localivy/jruby/bin/jruby.bat" args="-S buildr clean build ratchet=no" />
            </tasks>
            <resources>
              <resource>windows</resource>
              <resource>dev</resource>
            </resources>
            <artifacts>
              <test src="target/reports" />
            </artifacts>
          </job>
          <job name="windows-8">
            <environmentvariables>
              <variable name="TLB_TMP_DIR">C:\tlb_tmp_dir</variable>
            </environmentvariables>
            <tasks>
              <exec command="localivy/jruby/bin/jruby.bat" args="-S buildr clean build ratchet=no" />
            </tasks>
            <resources>
              <resource>windows</resource>
              <resource>dev</resource>
            </resources>
            <artifacts>
              <test src="target/reports" />
            </artifacts>
          </job>
          <job name="windows-9">
            <environmentvariables>
              <variable name="TLB_TMP_DIR">C:\tlb_tmp_dir</variable>
            </environmentvariables>
            <tasks>
              <exec command="localivy/jruby/bin/jruby.bat" args="-S buildr clean build ratchet=no" />
            </tasks>
            <resources>
              <resource>windows</resource>
              <resource>dev</resource>
            </resources>
            <artifacts>
              <test src="target/reports" />
            </artifacts>
          </job>
          <job name="windows-10">
            <environmentvariables>
              <variable name="TLB_TMP_DIR">C:\tlb_tmp_dir</variable>
            </environmentvariables>
            <tasks>
              <exec command="localivy/jruby/bin/jruby.bat" args="-S buildr clean build ratchet=no" />
            </tasks>
            <resources>
              <resource>windows</resource>
              <resource>dev</resource>
            </resources>
            <artifacts>
              <test src="target/reports" />
            </artifacts>
          </job>
          <job name="linux-firefox-1">
            <tasks>
              <exec command="localivy/jruby/bin/jruby" args="-S buildr clean build ratchet=no" />
            </tasks>
            <tabs>
              <tab name="Console" path="cruise-output/console.log" />
              <tab name="Junit-time" path="reports/junit-time-report.html" />
            </tabs>
            <resources>
              <resource>linux</resource>
              <resource>dev</resource>
            </resources>
            <artifacts>
              <test src="target/reports" />
            </artifacts>
          </job>
          <job name="linux-firefox-2">
            <tasks>
              <exec command="localivy/jruby/bin/jruby" args="-S buildr clean build ratchet=no" />
            </tasks>
            <tabs>
              <tab name="Console" path="cruise-output/console.log" />
              <tab name="Junit-time" path="reports/junit-time-report.html" />
            </tabs>
            <resources>
              <resource>linux</resource>
              <resource>dev</resource>
            </resources>
            <artifacts>
              <test src="target/reports" />
            </artifacts>
          </job>
          <job name="linux-firefox-3">
            <tasks>
              <exec command="localivy/jruby/bin/jruby" args="-S buildr clean build ratchet=no" />
            </tasks>
            <tabs>
              <tab name="Console" path="cruise-output/console.log" />
              <tab name="Junit-time" path="reports/junit-time-report.html" />
            </tabs>
            <resources>
              <resource>linux</resource>
              <resource>dev</resource>
            </resources>
            <artifacts>
              <test src="target/reports" />
            </artifacts>
          </job>
          <job name="linux-firefox-4">
            <tasks>
              <exec command="localivy/jruby/bin/jruby" args="-S buildr clean build ratchet=no" />
            </tasks>
            <tabs>
              <tab name="Console" path="cruise-output/console.log" />
              <tab name="Junit-time" path="reports/junit-time-report.html" />
            </tabs>
            <resources>
              <resource>linux</resource>
              <resource>dev</resource>
            </resources>
            <artifacts>
              <test src="target/reports" />
            </artifacts>
          </job>
          <job name="linux-firefox-5">
            <tasks>
              <exec command="localivy/jruby/bin/jruby" args="-S buildr clean build ratchet=no" />
            </tasks>
            <tabs>
              <tab name="Console" path="cruise-output/console.log" />
              <tab name="Junit-time" path="reports/junit-time-report.html" />
            </tabs>
            <resources>
              <resource>linux</resource>
              <resource>dev</resource>
            </resources>
            <artifacts>
              <test src="target/reports" />
            </artifacts>
          </job>
          <job name="linux-firefox-6">
            <tasks>
              <exec command="localivy/jruby/bin/jruby" args="-S buildr clean build ratchet=no" />
            </tasks>
            <tabs>
              <tab name="Console" path="cruise-output/console.log" />
              <tab name="Junit-time" path="reports/junit-time-report.html" />
            </tabs>
            <resources>
              <resource>linux</resource>
              <resource>dev</resource>
            </resources>
            <artifacts>
              <test src="target/reports" />
            </artifacts>
          </job>
          <job name="linux-firefox-7">
            <tasks>
              <exec command="localivy/jruby/bin/jruby" args="-S buildr clean build ratchet=no" />
            </tasks>
            <tabs>
              <tab name="Console" path="cruise-output/console.log" />
              <tab name="Junit-time" path="reports/junit-time-report.html" />
            </tabs>
            <resources>
              <resource>linux</resource>
              <resource>dev</resource>
            </resources>
            <artifacts>
              <test src="target/reports" />
            </artifacts>
          </job>
          <job name="linux-firefox-8">
            <tasks>
              <exec command="localivy/jruby/bin/jruby" args="-S buildr clean build ratchet=no" />
            </tasks>
            <tabs>
              <tab name="Console" path="cruise-output/console.log" />
              <tab name="Junit-time" path="reports/junit-time-report.html" />
            </tabs>
            <resources>
              <resource>linux</resource>
              <resource>dev</resource>
            </resources>
            <artifacts>
              <test src="target/reports" />
            </artifacts>
          </job>
          <job name="linux-firefox-9">
            <tasks>
              <exec command="localivy/jruby/bin/jruby" args="-S buildr clean build ratchet=no" />
            </tasks>
            <tabs>
              <tab name="Console" path="cruise-output/console.log" />
              <tab name="Junit-time" path="reports/junit-time-report.html" />
            </tabs>
            <resources>
              <resource>linux</resource>
              <resource>dev</resource>
            </resources>
            <artifacts>
              <test src="target/reports" />
            </artifacts>
          </job>
          <job name="linux-firefox-10">
            <tasks>
              <exec command="localivy/jruby/bin/jruby" args="-S buildr clean build ratchet=no" />
            </tasks>
            <tabs>
              <tab name="Console" path="cruise-output/console.log" />
              <tab name="Junit-time" path="reports/junit-time-report.html" />
            </tabs>
            <resources>
              <resource>linux</resource>
              <resource>dev</resource>
            </resources>
            <artifacts>
              <test src="target/reports" />
            </artifacts>
          </job>
          <job name="help">
            <tasks>
              <rake workingdir="helper" />
            </tasks>
            <tabs>
              <tab name="Documentation" path="output/build/index.html" />
            </tabs>
            <resources>
              <resource>dev</resource>
              <resource>linux</resource>
            </resources>
            <artifacts>
              <artifact src="helper/build" dest="output" />
            </artifacts>
          </job>
          <job name="smoke">
            <tasks>
              <exec command="rm" args="-rf target/*" />
              <exec command="localivy/jruby/bin/jruby" args="-S buildr clean dist cruise:cruise-twist-new:clean cruise:cruise-twist-new:compile cruise:cruise-twist-new:twist test=no twist=yes ratchet=no TWIST_TAGS='smoke'" />
            </tasks>
            <tabs>
              <tab name="Twist" path="twistreports/twist/html/index.html" />
            </tabs>
            <resources>
              <resource>twist-new</resource>
              <resource>linux</resource>
            </resources>
            <artifacts>
              <artifact src="target/reports/twist" dest="twistreports" />
              <artifact src="target/twist-agents/*/*.log" dest="agent/logs" />
              <artifact src="target/cruise-server-*/*.log" dest="server/logs" />
              <artifact src="target/cruise-server-*/config" dest="server/config" />
            </artifacts>
          </job>
        </jobs>
      </stage>
      <stage name="dist-zip">
        <jobs>
          <job name="zip">
            <tasks>
              <exec command="localivy/jruby/bin/jruby" args="-S buildr clean cruise:pkg:zip test=no ratchet=no" />
            </tasks>
            <resources>
              <resource>java</resource>
              <resource>linux</resource>
            </resources>
            <artifacts>
              <artifact src="target/pkg/*.*" dest="pkg" />
            </artifacts>
          </job>
        </jobs>
      </stage>
      <stage name="dist-buildr">
        <jobs>
          <job name="debian">
            <environmentvariables>
              <variable name="JAVA_MEM">-Xmx750m</variable>
            </environmentvariables>
            <tasks>
              <exec command="localivy/jruby/bin/jruby" args="-S buildr clean cruise:pkg:debian test=no" />
            </tasks>
            <resources>
              <resource>java</resource>
              <resource>linux</resource>
            </resources>
            <artifacts>
              <artifact src="target/pkg/*.*" dest="pkg" />
            </artifacts>
          </job>
        </jobs>
      </stage>
      <stage name="REST-CandidateForUAT">
        <jobs>
          <job name="NewBuild">
            <tasks>
              <exec command="/bin/bash" args="-c &quot; curl -u operate:badger -d '' http://10.38.10.252:8153/cruise/api/pipelines/CandidateForUAT/schedule &quot;" />
            </tasks>
            <resources>
              <resource>linux</resource>
            </resources>
          </job>
        </jobs>
      </stage>
      <stage name="dist">
        <approval type="manual" />
        <jobs>
          <job name="linux-firefox">
            <tasks>
              <ant target="-Drun=all clean.systmpdir cruise.dist" />
            </tasks>
            <resources>
              <resource>dev</resource>
              <resource>linux</resource>
            </resources>
            <artifacts>
              <artifact src="target/pkg" />
            </artifacts>
          </job>
          <job name="dist-solaris">
            <tasks>
              <ant target="-Drun=all clean.ivy.localivy clean dist.sol" />
            </tasks>
            <resources>
              <resource>solaris</resource>
            </resources>
            <artifacts>
              <artifact src="target/pkg/cruise*.gz" dest="pkg" />
            </artifacts>
          </job>
        </jobs>
      </stage>
      <stage name="buildr-analysis">
        <jobs>
          <job name="analysis">
            <tasks>
              <exec command="localivy/jruby/bin/jruby" args="-S buildr analysis" />
            </tasks>
            <tabs>
              <tab name="Emma" path="target/emma/coverage.html" />
            </tabs>
            <resources>
              <resource>linux</resource>
            </resources>
            <artifacts>
              <artifact src="target/emma" dest="analysis" />
            </artifacts>
            <properties>
              <property name="coverage.class" src="target/emma/coverage.xml" xpath="substring-before(//report/data/all/coverage[starts-with(@type,'class')]/@value, '%')" />
              <property name="coverage.method" src="target/emma/coverage.xml" xpath="substring-before(//report/data/all/coverage[starts-with(@type,'method')]/@value, '%')" />
              <property name="coverage.block" src="target/emma/coverage.xml" xpath="substring-before(//report/data/all/coverage[starts-with(@type,'block')]/@value, '%')" />
              <property name="coverage.line" src="target/emma/coverage.xml" xpath="substring-before(//report/data/all/coverage[starts-with(@type,'line')]/@value, '%')" />
            </properties>
          </job>
        </jobs>
      </stage>
    </pipeline>
    <pipeline name="acceptance" labeltemplate="2.0.0.${CRUISE}-${TRUNK}">
      <trackingtool link="https://mingle.somewhere.com/projects/cruise/cards/${ID}" regex="#(\d+)" />
      <materials>
        <hg url="https://abc:def@fmtstdscm01.somewhere.com/cruise" materialName="trunk">
          <filter>
            <ignore pattern="agent/**/*.*" />
            <ignore pattern="agent-bootstrapper/**/*.*" />
            <ignore pattern="build/**/*.*" />
            <ignore pattern="cleanIEProxy/**/*.*" />
            <ignore pattern="common/**/*.*" />
            <ignore pattern="deploy/**/*.*" />
            <ignore pattern="docs/**/*.*" />
            <ignore pattern="helper/**/*.*" />
            <ignore pattern="installer/**/*.*" />
            <ignore pattern="lib/**/*.*" />
            <ignore pattern="localivy/**/*.*" />
            <ignore pattern="log/**/*.*" />
            <ignore pattern="logs/**/*.*" />
            <ignore pattern="manual-testing/**/*.*" />
            <ignore pattern="performance/**/*.*" />
            <ignore pattern="qatests/**/*.*" />
            <ignore pattern="scenarios/**/*.*" />
            <ignore pattern="self-hosting/**/*.*" />
            <ignore pattern="server/**/*.*" />
            <ignore pattern="spike/**/*.*" />
            <ignore pattern="tasks/**/*.*" />
            <ignore pattern="test-utils/**/*.*" />
            <ignore pattern="tools/**/*.*" />
            <ignore pattern="util/**/*.*" />
            <ignore pattern="vnc-recorder/**/*.*" />
            <ignore pattern="workspace/**/*.*" />
          </filter>
        </hg>
        <pipeline pipelineName="cruise" stageName="dist-zip" materialName="CRUISE" />
      </materials>
      <stage name="twist">
        <jobs>
          <job name="firefox-1">
            <tasks>
              <exec command="/bin/bash" args="-c 'rm -rf target/pkg/*.zip'" />
              <exec command="/bin/bash" args="-c 'rm -rf target/*'" />
              <fetchartifact pipeline="cruise" stage="dist-zip" job="zip" srcdir="pkg" dest="target" />
              <exec command="unzip" args="-o target/pkg/cruise-server-*-*.zip -d target" />
              <exec command="unzip" args="-o target/pkg/cruise-agent-*-*.zip -d target" />
              <exec command="chmod" args="+x target/cruise-server-*/server.sh" />
              <exec command="chmod" args="+x target/cruise-server-*/stop-server.sh" />
              <exec command="chmod" args="+x target/cruise-agent-*/agent.sh" />
              <exec command="chmod" args="+x target/cruise-agent-*/stop-agent.sh" />
              <exec command="localivy/jruby/bin/jruby" args="-S buildr cruise:cruise-twist-new:clean cruise:cruise-twist-new:compile cruise:cruise-twist-new:twist test=no twist=yes ratchet=no shine=yes TWIST_TAGS='!smoke,!windows'" />
            </tasks>
            <tabs>
              <tab name="Twist" path="twistreports/twist/html/index.html" />
            </tabs>
            <resources>
              <resource>twist-new</resource>
              <resource>linux</resource>
            </resources>
            <artifacts>
              <artifact src="target/reports/twist" dest="twistreports" />
              <artifact src="target/twist-agents/*/*.log" dest="agent/logs" />
              <artifact src="target/cruise-server-*/*.log" dest="server/logs" />
              <artifact src="target/cruise-server-*/config" dest="server/config" />
              <test src="target/reports/twist/xml" />
            </artifacts>
          </job>
          <job name="firefox-2">
            <tasks>
              <exec command="/bin/bash" args="-c 'rm -rf target/pkg/*.zip'" />
              <exec command="/bin/bash" args="-c 'rm -rf target/*'" />
              <fetchartifact pipeline="cruise" stage="dist-zip" job="zip" srcdir="pkg" dest="target" />
              <exec command="unzip" args="-o target/pkg/cruise-server-*-*.zip -d target" />
              <exec command="unzip" args="-o target/pkg/cruise-agent-*-*.zip -d target" />
              <exec command="chmod" args="+x target/cruise-server-*/server.sh" />
              <exec command="chmod" args="+x target/cruise-server-*/stop-server.sh" />
              <exec command="chmod" args="+x target/cruise-agent-*/agent.sh" />
              <exec command="chmod" args="+x target/cruise-agent-*/stop-agent.sh" />
              <exec command="localivy/jruby/bin/jruby" args="-S buildr cruise:cruise-twist-new:clean cruise:cruise-twist-new:compile cruise:cruise-twist-new:twist test=no twist=yes ratchet=no shine=yes TWIST_TAGS='!smoke,!windows'" />
            </tasks>
            <tabs>
              <tab name="Twist" path="twistreports/twist/html/index.html" />
            </tabs>
            <resources>
              <resource>twist-new</resource>
              <resource>linux</resource>
            </resources>
            <artifacts>
              <artifact src="target/reports/twist" dest="twistreports" />
              <artifact src="target/twist-agents/*/*.log" dest="agent/logs" />
              <artifact src="target/cruise-server-*/*.log" dest="server/logs" />
              <artifact src="target/cruise-server-*/config" dest="server/config" />
              <test src="target/reports/twist/xml" />
            </artifacts>
          </job>
          <job name="firefox-3">
            <tasks>
              <exec command="/bin/bash" args="-c 'rm -rf target/pkg/*.zip'" />
              <exec command="/bin/bash" args="-c 'rm -rf target/*'" />
              <fetchartifact pipeline="cruise" stage="dist-zip" job="zip" srcdir="pkg" dest="target" />
              <exec command="unzip" args="-o target/pkg/cruise-server-*-*.zip -d target" />
              <exec command="unzip" args="-o target/pkg/cruise-agent-*-*.zip -d target" />
              <exec command="chmod" args="+x target/cruise-server-*/server.sh" />
              <exec command="chmod" args="+x target/cruise-server-*/stop-server.sh" />
              <exec command="chmod" args="+x target/cruise-agent-*/agent.sh" />
              <exec command="chmod" args="+x target/cruise-agent-*/stop-agent.sh" />
              <exec command="localivy/jruby/bin/jruby" args="-S buildr cruise:cruise-twist-new:clean cruise:cruise-twist-new:compile cruise:cruise-twist-new:twist test=no twist=yes ratchet=no shine=yes TWIST_TAGS='!smoke,!windows'" />
            </tasks>
            <tabs>
              <tab name="Twist" path="twistreports/twist/html/index.html" />
            </tabs>
            <resources>
              <resource>twist-new</resource>
              <resource>linux</resource>
              <resource>blr</resource>
            </resources>
            <artifacts>
              <artifact src="target/reports/twist" dest="twistreports" />
              <artifact src="target/twist-agents/*/*.log" dest="agent/logs" />
              <artifact src="target/cruise-server-*/*.log" dest="server/logs" />
              <artifact src="target/cruise-server-*/config" dest="server/config" />
              <test src="target/reports/twist/xml" />
            </artifacts>
          </job>
          <job name="firefox-4">
            <tasks>
              <exec command="/bin/bash" args="-c 'rm -rf target/pkg/*.zip'" />
              <exec command="/bin/bash" args="-c 'rm -rf target/*'" />
              <fetchartifact pipeline="cruise" stage="dist-zip" job="zip" srcdir="pkg" dest="target" />
              <exec command="unzip" args="-o target/pkg/cruise-server-*-*.zip -d target" />
              <exec command="unzip" args="-o target/pkg/cruise-agent-*-*.zip -d target" />
              <exec command="chmod" args="+x target/cruise-server-*/server.sh" />
              <exec command="chmod" args="+x target/cruise-server-*/stop-server.sh" />
              <exec command="chmod" args="+x target/cruise-agent-*/agent.sh" />
              <exec command="chmod" args="+x target/cruise-agent-*/stop-agent.sh" />
              <exec command="localivy/jruby/bin/jruby" args="-S buildr cruise:cruise-twist-new:clean cruise:cruise-twist-new:compile cruise:cruise-twist-new:twist test=no twist=yes ratchet=no shine=yes TWIST_TAGS='!smoke,!windows'" />
            </tasks>
            <tabs>
              <tab name="Twist" path="twistreports/twist/html/index.html" />
            </tabs>
            <resources>
              <resource>twist-new</resource>
              <resource>linux</resource>
            </resources>
            <artifacts>
              <artifact src="target/reports/twist" dest="twistreports" />
              <artifact src="target/twist-agents/*/*.log" dest="agent/logs" />
              <artifact src="target/cruise-server-*/*.log" dest="server/logs" />
              <artifact src="target/cruise-server-*/config" dest="server/config" />
              <test src="target/reports/twist/xml" />
            </artifacts>
          </job>
          <job name="firefox-5">
            <tasks>
              <exec command="/bin/bash" args="-c 'rm -rf target/pkg/*.zip'" />
              <exec command="/bin/bash" args="-c 'rm -rf target/*'" />
              <fetchartifact pipeline="cruise" stage="dist-zip" job="zip" srcdir="pkg" dest="target" />
              <exec command="unzip" args="-o target/pkg/cruise-server-*-*.zip -d target" />
              <exec command="unzip" args="-o target/pkg/cruise-agent-*-*.zip -d target" />
              <exec command="chmod" args="+x target/cruise-server-*/server.sh" />
              <exec command="chmod" args="+x target/cruise-server-*/stop-server.sh" />
              <exec command="chmod" args="+x target/cruise-agent-*/agent.sh" />
              <exec command="chmod" args="+x target/cruise-agent-*/stop-agent.sh" />
              <exec command="localivy/jruby/bin/jruby" args="-S buildr cruise:cruise-twist-new:clean cruise:cruise-twist-new:compile cruise:cruise-twist-new:twist test=no twist=yes ratchet=no shine=yes TWIST_TAGS='!smoke,!windows'" />
            </tasks>
            <tabs>
              <tab name="Twist" path="twistreports/twist/html/index.html" />
            </tabs>
            <resources>
              <resource>twist-new</resource>
              <resource>linux</resource>
            </resources>
            <artifacts>
              <artifact src="target/reports/twist" dest="twistreports" />
              <artifact src="target/twist-agents/*/*.log" dest="agent/logs" />
              <artifact src="target/cruise-server-*/*.log" dest="server/logs" />
              <artifact src="target/cruise-server-*/config" dest="server/config" />
              <test src="target/reports/twist/xml" />
            </artifacts>
          </job>
          <job name="firefox-6">
            <tasks>
              <exec command="/bin/bash" args="-c 'rm -rf target/pkg/*.zip'" />
              <exec command="/bin/bash" args="-c 'rm -rf target/*'" />
              <fetchartifact pipeline="cruise" stage="dist-zip" job="zip" srcdir="pkg" dest="target" />
              <exec command="unzip" args="-o target/pkg/cruise-server-*-*.zip -d target" />
              <exec command="unzip" args="-o target/pkg/cruise-agent-*-*.zip -d target" />
              <exec command="chmod" args="+x target/cruise-server-*/server.sh" />
              <exec command="chmod" args="+x target/cruise-server-*/stop-server.sh" />
              <exec command="chmod" args="+x target/cruise-agent-*/agent.sh" />
              <exec command="chmod" args="+x target/cruise-agent-*/stop-agent.sh" />
              <exec command="localivy/jruby/bin/jruby" args="-S buildr cruise:cruise-twist-new:clean cruise:cruise-twist-new:compile cruise:cruise-twist-new:twist test=no twist=yes ratchet=no shine=yes TWIST_TAGS='!smoke,!windows'" />
            </tasks>
            <tabs>
              <tab name="Twist" path="twistreports/twist/html/index.html" />
            </tabs>
            <resources>
              <resource>twist-new</resource>
              <resource>linux</resource>
            </resources>
            <artifacts>
              <artifact src="target/reports/twist" dest="twistreports" />
              <artifact src="target/twist-agents/*/*.log" dest="agent/logs" />
              <artifact src="target/cruise-server-*/*.log" dest="server/logs" />
              <artifact src="target/cruise-server-*/config" dest="server/config" />
              <test src="target/reports/twist/xml" />
            </artifacts>
          </job>
          <job name="firefox-7">
            <tasks>
              <exec command="/bin/bash" args="-c 'rm -rf target/pkg/*.zip'" />
              <exec command="/bin/bash" args="-c 'rm -rf target/*'" />
              <fetchartifact pipeline="cruise" stage="dist-zip" job="zip" srcdir="pkg" dest="target" />
              <exec command="unzip" args="-o target/pkg/cruise-server-*-*.zip -d target" />
              <exec command="unzip" args="-o target/pkg/cruise-agent-*-*.zip -d target" />
              <exec command="chmod" args="+x target/cruise-server-*/server.sh" />
              <exec command="chmod" args="+x target/cruise-server-*/stop-server.sh" />
              <exec command="chmod" args="+x target/cruise-agent-*/agent.sh" />
              <exec command="chmod" args="+x target/cruise-agent-*/stop-agent.sh" />
              <exec command="localivy/jruby/bin/jruby" args="-S buildr cruise:cruise-twist-new:clean cruise:cruise-twist-new:compile cruise:cruise-twist-new:twist test=no twist=yes ratchet=no shine=yes TWIST_TAGS='!smoke,!windows'" />
            </tasks>
            <tabs>
              <tab name="Twist" path="twistreports/twist/html/index.html" />
            </tabs>
            <resources>
              <resource>twist-new</resource>
              <resource>linux</resource>
            </resources>
            <artifacts>
              <artifact src="target/reports/twist" dest="twistreports" />
              <artifact src="target/twist-agents/*/*.log" dest="agent/logs" />
              <artifact src="target/cruise-server-*/*.log" dest="server/logs" />
              <artifact src="target/cruise-server-*/config" dest="server/config" />
              <test src="target/reports/twist/xml" />
            </artifacts>
          </job>
        </jobs>
      </stage>
    </pipeline>
    <pipeline name="acceptance-ie" labeltemplate="2.0.0.${CRUISE}-${TRUNK}">
      <trackingtool link="https://mingle.somewhere.com/projects/cruise/cards/${ID}" regex="#(\d+)" />
      <materials>
        <hg url="https://abc:def@fmtstdscm01.somewhere.com/cruise" materialName="trunk">
          <filter>
            <ignore pattern="agent/**/*.*" />
            <ignore pattern="agent-bootstrapper/**/*.*" />
            <ignore pattern="build/**/*.*" />
            <ignore pattern="cleanIEProxy/**/*.*" />
            <ignore pattern="common/**/*.*" />
            <ignore pattern="deploy/**/*.*" />
            <ignore pattern="docs/**/*.*" />
            <ignore pattern="helper/**/*.*" />
            <ignore pattern="installer/**/*.*" />
            <ignore pattern="lib/**/*.*" />
            <ignore pattern="localivy/**/*.*" />
            <ignore pattern="log/**/*.*" />
            <ignore pattern="logs/**/*.*" />
            <ignore pattern="manual-testing/**/*.*" />
            <ignore pattern="performance/**/*.*" />
            <ignore pattern="qatests/**/*.*" />
            <ignore pattern="scenarios/**/*.*" />
            <ignore pattern="self-hosting/**/*.*" />
            <ignore pattern="server/**/*.*" />
            <ignore pattern="spike/**/*.*" />
            <ignore pattern="tasks/**/*.*" />
            <ignore pattern="test-utils/**/*.*" />
            <ignore pattern="tools/**/*.*" />
            <ignore pattern="util/**/*.*" />
            <ignore pattern="vnc-recorder/**/*.*" />
            <ignore pattern="workspace/**/*.*" />
          </filter>
        </hg>
        <pipeline pipelineName="cruise" stageName="dist-zip" materialName="CRUISE" />
      </materials>
      <stage name="twist">
        <jobs>
          <job name="ie" runOnAllAgents="true">
            <tasks>
              <exec command="rm" args="-rf target" />
              <exec command="mkdir" args="target" />
              <fetchartifact pipeline="cruise" stage="dist-zip" job="zip" srcdir="pkg" dest="target" />
              <exec command="unzip" args="-o target/pkg/cruise-server-*-*.zip -d target" />
              <exec command="unzip" args="-o target/pkg/cruise-agent-*-*.zip -d target" />
              <exec command="localivy/jruby/bin/jruby" args="-S buildr cruise:cruise-twist-new:clean cruise:cruise-twist-new:compile cruise:cruise-twist-new:twist test=no twist=yes ratchet=no shine=yes TWIST_TAGS='!smoke'" />
            </tasks>
            <tabs>
              <tab name="Twist" path="twistreports/twist/html/index.html" />
            </tabs>
            <resources>
              <resource>twist-new</resource>
              <resource>windows</resource>
            </resources>
            <artifacts>
              <artifact src="target/reports/twist" dest="twistreports" />
              <artifact src="target/twist-agents/*/*.log" dest="agent/logs" />
              <artifact src="target/cruise-server-*/*.log" dest="server/logs" />
              <artifact src="target/cruise-server-*/config" dest="server/config" />
              <test src="target/reports/twist/xml" />
            </artifacts>
          </job>
        </jobs>
      </stage>
    </pipeline>
    <pipeline name="cruise-branch" labeltemplate="2.0.0.${COUNT}-${BRANCH}">
      <trackingtool link="https://mingle.somewhere.com/projects/cruise/cards/${ID}" regex="#(\d+)" />
      <materials>
        <hg url="http://cruise03.somewhere.com:8000" materialName="branch">
          <filter>
            <ignore pattern="helper/**/*.*" />
            <ignore pattern="spike/**/*.*" />
            <ignore pattern="QA/**/*.*" />
            <ignore pattern="**/*.css" />
            <ignore pattern="performance/ec2/**/*.*" />
            <ignore pattern="performance/ec3/**/*.*" />
            <ignore pattern="manual-testing/**/*.*" />
            <ignore pattern="cruise-twist-new/**/*.*" />
          </filter>
        </hg>
      </materials>
      <stage name="dev">
        <approval type="success">
          <authorization>
            <role>admins</role>
          </authorization>
        </approval>
        <jobs>
          <job name="jsunit">
            <tasks>
              <exec command="localivy/jruby/bin/jruby" args="-S buildr cruise:misc:jsunit ratchet=no test=no shine=no" />
            </tasks>
            <resources>
              <resource>linux</resource>
              <resource>java</resource>
            </resources>
            <artifacts>
              <artifact src="target/server/jsunit/logs" />
            </artifacts>
          </job>
          <job name="linux-rails">
            <tasks>
              <exec command="localivy/jruby/bin/jruby" args="-S buildr cruise:rails:spec ratchet=no test=no shine=no" />
            </tasks>
            <tabs>
              <tab name="Console" path="cruise-output/console.log" />
              <tab name="Specs" path="specs/spec_full_report.html" />
            </tabs>
            <resources>
              <resource>linux</resource>
              <resource>dev</resource>
            </resources>
            <artifacts>
              <test src="target/specs" />
            </artifacts>
          </job>
          <job name="windows-1">
            <tasks>
              <exec command="localivy/jruby/bin/jruby.bat" args="-S buildr clean build ratchet=no shine=no" />
            </tasks>
            <resources>
              <resource>windows</resource>
              <resource>dev</resource>
            </resources>
            <artifacts>
              <test src="target/reports" />
            </artifacts>
          </job>
          <job name="windows-2">
            <tasks>
              <exec command="localivy/jruby/bin/jruby.bat" args="-S buildr clean build ratchet=no shine=no" />
            </tasks>
            <resources>
              <resource>windows</resource>
              <resource>dev</resource>
            </resources>
            <artifacts>
              <test src="target/reports" />
            </artifacts>
          </job>
          <job name="windows-3">
            <tasks>
              <exec command="localivy/jruby/bin/jruby.bat" args="-S buildr clean build ratchet=no shine=no" />
            </tasks>
            <resources>
              <resource>windows</resource>
              <resource>dev</resource>
            </resources>
            <artifacts>
              <test src="target/reports" />
            </artifacts>
          </job>
          <job name="windows-4">
            <tasks>
              <exec command="localivy/jruby/bin/jruby.bat" args="-S buildr clean build ratchet=no shine=no" />
            </tasks>
            <resources>
              <resource>windows</resource>
              <resource>dev</resource>
            </resources>
            <artifacts>
              <test src="target/reports" />
            </artifacts>
          </job>
          <job name="windows-5">
            <tasks>
              <exec command="localivy/jruby/bin/jruby.bat" args="-S buildr clean build ratchet=no shine=no" />
            </tasks>
            <resources>
              <resource>windows</resource>
              <resource>dev</resource>
            </resources>
            <artifacts>
              <test src="target/reports" />
            </artifacts>
          </job>
          <job name="windows-6">
            <tasks>
              <exec command="localivy/jruby/bin/jruby.bat" args="-S buildr clean build ratchet=no shine=no" />
            </tasks>
            <resources>
              <resource>windows</resource>
              <resource>dev</resource>
            </resources>
            <artifacts>
              <test src="target/reports" />
            </artifacts>
          </job>
          <job name="windows-7">
            <tasks>
              <exec command="localivy/jruby/bin/jruby.bat" args="-S buildr clean build ratchet=no shine=no" />
            </tasks>
            <resources>
              <resource>windows</resource>
              <resource>dev</resource>
            </resources>
            <artifacts>
              <test src="target/reports" />
            </artifacts>
          </job>
          <job name="windows-8">
            <tasks>
              <exec command="localivy/jruby/bin/jruby.bat" args="-S buildr clean build ratchet=no shine=no" />
            </tasks>
            <resources>
              <resource>windows</resource>
              <resource>dev</resource>
            </resources>
            <artifacts>
              <test src="target/reports" />
            </artifacts>
          </job>
          <job name="windows-9">
            <tasks>
              <exec command="localivy/jruby/bin/jruby.bat" args="-S buildr clean build ratchet=no shine=no" />
            </tasks>
            <resources>
              <resource>windows</resource>
              <resource>dev</resource>
            </resources>
            <artifacts>
              <test src="target/reports" />
            </artifacts>
          </job>
          <job name="windows-10">
            <tasks>
              <exec command="localivy/jruby/bin/jruby.bat" args="-S buildr clean build ratchet=no shine=no" />
            </tasks>
            <resources>
              <resource>windows</resource>
              <resource>dev</resource>
            </resources>
            <artifacts>
              <test src="target/reports" />
            </artifacts>
          </job>
          <job name="linux-firefox-1">
            <tasks>
              <exec command="localivy/jruby/bin/jruby" args="-S buildr clean build ratchet=no shine=no" />
            </tasks>
            <tabs>
              <tab name="Console" path="cruise-output/console.log" />
              <tab name="Junit-time" path="reports/junit-time-report.html" />
            </tabs>
            <resources>
              <resource>linux</resource>
              <resource>dev</resource>
            </resources>
            <artifacts>
              <test src="target/reports" />
            </artifacts>
          </job>
          <job name="linux-firefox-2">
            <tasks>
              <exec command="localivy/jruby/bin/jruby" args="-S buildr clean build ratchet=no shine=no" />
            </tasks>
            <tabs>
              <tab name="Console" path="cruise-output/console.log" />
              <tab name="Junit-time" path="reports/junit-time-report.html" />
            </tabs>
            <resources>
              <resource>linux</resource>
              <resource>dev</resource>
            </resources>
            <artifacts>
              <test src="target/reports" />
            </artifacts>
          </job>
          <job name="linux-firefox-3">
            <tasks>
              <exec command="localivy/jruby/bin/jruby" args="-S buildr clean build ratchet=no shine=no" />
            </tasks>
            <tabs>
              <tab name="Console" path="cruise-output/console.log" />
              <tab name="Junit-time" path="reports/junit-time-report.html" />
            </tabs>
            <resources>
              <resource>linux</resource>
              <resource>dev</resource>
            </resources>
            <artifacts>
              <test src="target/reports" />
            </artifacts>
          </job>
          <job name="linux-firefox-4">
            <tasks>
              <exec command="localivy/jruby/bin/jruby" args="-S buildr clean build ratchet=no shine=no" />
            </tasks>
            <tabs>
              <tab name="Console" path="cruise-output/console.log" />
              <tab name="Junit-time" path="reports/junit-time-report.html" />
            </tabs>
            <resources>
              <resource>linux</resource>
              <resource>dev</resource>
            </resources>
            <artifacts>
              <test src="target/reports" />
            </artifacts>
          </job>
          <job name="linux-firefox-5">
            <tasks>
              <exec command="localivy/jruby/bin/jruby" args="-S buildr clean build ratchet=no shine=no" />
            </tasks>
            <tabs>
              <tab name="Console" path="cruise-output/console.log" />
              <tab name="Junit-time" path="reports/junit-time-report.html" />
            </tabs>
            <resources>
              <resource>linux</resource>
              <resource>dev</resource>
            </resources>
            <artifacts>
              <test src="target/reports" />
            </artifacts>
          </job>
          <job name="linux-firefox-6">
            <tasks>
              <exec command="localivy/jruby/bin/jruby" args="-S buildr clean build ratchet=no shine=no" />
            </tasks>
            <tabs>
              <tab name="Console" path="cruise-output/console.log" />
              <tab name="Junit-time" path="reports/junit-time-report.html" />
            </tabs>
            <resources>
              <resource>linux</resource>
              <resource>dev</resource>
            </resources>
            <artifacts>
              <test src="target/reports" />
            </artifacts>
          </job>
          <job name="linux-firefox-7">
            <tasks>
              <exec command="localivy/jruby/bin/jruby" args="-S buildr clean build ratchet=no shine=no" />
            </tasks>
            <tabs>
              <tab name="Console" path="cruise-output/console.log" />
              <tab name="Junit-time" path="reports/junit-time-report.html" />
            </tabs>
            <resources>
              <resource>linux</resource>
              <resource>dev</resource>
            </resources>
            <artifacts>
              <test src="target/reports" />
            </artifacts>
          </job>
          <job name="linux-firefox-8">
            <tasks>
              <exec command="localivy/jruby/bin/jruby" args="-S buildr clean build ratchet=no shine=no" />
            </tasks>
            <tabs>
              <tab name="Console" path="cruise-output/console.log" />
              <tab name="Junit-time" path="reports/junit-time-report.html" />
            </tabs>
            <resources>
              <resource>linux</resource>
              <resource>dev</resource>
            </resources>
            <artifacts>
              <test src="target/reports" />
            </artifacts>
          </job>
          <job name="linux-firefox-9">
            <tasks>
              <exec command="localivy/jruby/bin/jruby" args="-S buildr clean build ratchet=no shine=no" />
            </tasks>
            <tabs>
              <tab name="Console" path="cruise-output/console.log" />
              <tab name="Junit-time" path="reports/junit-time-report.html" />
            </tabs>
            <resources>
              <resource>linux</resource>
              <resource>dev</resource>
            </resources>
            <artifacts>
              <test src="target/reports" />
            </artifacts>
          </job>
          <job name="linux-firefox-10">
            <tasks>
              <exec command="localivy/jruby/bin/jruby" args="-S buildr clean build ratchet=no shine=no" />
            </tasks>
            <tabs>
              <tab name="Console" path="cruise-output/console.log" />
              <tab name="Junit-time" path="reports/junit-time-report.html" />
            </tabs>
            <resources>
              <resource>linux</resource>
              <resource>dev</resource>
            </resources>
            <artifacts>
              <test src="target/reports" />
            </artifacts>
          </job>
          <job name="help">
            <tasks>
              <rake workingdir="helper" />
            </tasks>
            <tabs>
              <tab name="Documentation" path="output/build/index.html" />
            </tabs>
            <resources>
              <resource>dev</resource>
              <resource>linux</resource>
            </resources>
            <artifacts>
              <artifact src="helper/build" dest="output" />
            </artifacts>
          </job>
          <job name="smoke">
            <tasks>
              <exec command="rm" args="-rf target/*" />
              <exec command="localivy/jruby/bin/jruby" args="-S buildr clean dist cruise:cruise-twist-new:clean cruise:cruise-twist-new:compile cruise:cruise-twist-new:twist test=no twist=yes ratchet=no  shine=no TWIST_TAGS='smoke'" />
            </tasks>
            <tabs>
              <tab name="Twist" path="twistreports/twist/html/index.html" />
            </tabs>
            <resources>
              <resource>twist-new</resource>
              <resource>linux</resource>
            </resources>
            <artifacts>
              <artifact src="target/reports/twist" dest="twistreports" />
              <artifact src="target/twist-agents/*/*.log" dest="agent/logs" />
              <artifact src="target/cruise-server-*/*.log" dest="server/logs" />
              <artifact src="target/cruise-server-*/config" dest="server/config" />
            </artifacts>
          </job>
        </jobs>
      </stage>
      <stage name="dist-zip">
        <jobs>
          <job name="zip">
            <tasks>
              <exec command="localivy/jruby/bin/jruby" args="-S buildr clean cruise:pkg:zip test=no ratchet=no shine=no" />
            </tasks>
            <resources>
              <resource>java</resource>
              <resource>linux</resource>
            </resources>
            <artifacts>
              <artifact src="target/pkg/*.*" dest="pkg" />
            </artifacts>
          </job>
        </jobs>
      </stage>
      <stage name="twist">
        <jobs>
          <job name="firefox-1">
            <tasks>
              <exec command="/bin/bash" args="-c 'rm -rf target/pkg/*.zip'" />
              <exec command="/bin/bash" args="-c 'rm -rf target/*'" />
              <fetchartifact pipeline="cruise-branch" stage="dist-zip" job="zip" srcdir="pkg" dest="target" />
              <exec command="unzip" args="-o target/pkg/cruise-server-*-*.zip -d target" />
              <exec command="unzip" args="-o target/pkg/cruise-agent-*-*.zip -d target" />
              <exec command="chmod" args="+x target/cruise-server-*/server.sh" />
              <exec command="chmod" args="+x target/cruise-server-*/stop-server.sh" />
              <exec command="chmod" args="+x target/cruise-agent-*/agent.sh" />
              <exec command="chmod" args="+x target/cruise-agent-*/stop-agent.sh" />
              <exec command="localivy/jruby/bin/jruby" args="-S buildr cruise:cruise-twist-new:clean cruise:cruise-twist-new:compile cruise:cruise-twist-new:twist test=no twist=yes ratchet=no shine=no TWIST_TAGS='!smoke,!windows'" />
            </tasks>
            <tabs>
              <tab name="Twist" path="twistreports/twist/html/index.html" />
            </tabs>
            <resources>
              <resource>twist-new</resource>
              <resource>linux</resource>
            </resources>
            <artifacts>
              <artifact src="target/reports/twist" dest="twistreports" />
              <artifact src="target/twist-agents/*/*.log" dest="agent/logs" />
              <artifact src="target/cruise-server-*/*.log" dest="server/logs" />
              <artifact src="target/cruise-server-*/config" dest="server/config" />
            </artifacts>
          </job>
          <job name="firefox-2">
            <tasks>
              <exec command="/bin/bash" args="-c 'rm -rf target/pkg/*.zip'" />
              <exec command="/bin/bash" args="-c 'rm -rf target/*'" />
              <fetchartifact pipeline="cruise-branch" stage="dist-zip" job="zip" srcdir="pkg" dest="target" />
              <exec command="unzip" args="-o target/pkg/cruise-server-*-*.zip -d target" />
              <exec command="unzip" args="-o target/pkg/cruise-agent-*-*.zip -d target" />
              <exec command="chmod" args="+x target/cruise-server-*/server.sh" />
              <exec command="chmod" args="+x target/cruise-server-*/stop-server.sh" />
              <exec command="chmod" args="+x target/cruise-agent-*/agent.sh" />
              <exec command="chmod" args="+x target/cruise-agent-*/stop-agent.sh" />
              <exec command="localivy/jruby/bin/jruby" args="-S buildr cruise:cruise-twist-new:clean cruise:cruise-twist-new:compile cruise:cruise-twist-new:twist test=no twist=yes ratchet=no shine=no TWIST_TAGS='!smoke,!windows'" />
            </tasks>
            <tabs>
              <tab name="Twist" path="twistreports/twist/html/index.html" />
            </tabs>
            <resources>
              <resource>twist-new</resource>
              <resource>linux</resource>
            </resources>
            <artifacts>
              <artifact src="target/reports/twist" dest="twistreports" />
              <artifact src="target/twist-agents/*/*.log" dest="agent/logs" />
              <artifact src="target/cruise-server-*/*.log" dest="server/logs" />
              <artifact src="target/cruise-server-*/config" dest="server/config" />
            </artifacts>
          </job>
          <job name="firefox-3">
            <tasks>
              <exec command="/bin/bash" args="-c 'rm -rf target/pkg/*.zip'" />
              <exec command="/bin/bash" args="-c 'rm -rf target/*'" />
              <fetchartifact pipeline="cruise-branch" stage="dist-zip" job="zip" srcdir="pkg" dest="target" />
              <exec command="unzip" args="-o target/pkg/cruise-server-*-*.zip -d target" />
              <exec command="unzip" args="-o target/pkg/cruise-agent-*-*.zip -d target" />
              <exec command="chmod" args="+x target/cruise-server-*/server.sh" />
              <exec command="chmod" args="+x target/cruise-server-*/stop-server.sh" />
              <exec command="chmod" args="+x target/cruise-agent-*/agent.sh" />
              <exec command="chmod" args="+x target/cruise-agent-*/stop-agent.sh" />
              <exec command="localivy/jruby/bin/jruby" args="-S buildr cruise:cruise-twist-new:clean cruise:cruise-twist-new:compile cruise:cruise-twist-new:twist test=no twist=yes ratchet=no shine=no TWIST_TAGS='!smoke,!windows'" />
            </tasks>
            <tabs>
              <tab name="Twist" path="twistreports/twist/html/index.html" />
            </tabs>
            <resources>
              <resource>twist-new</resource>
              <resource>linux</resource>
            </resources>
            <artifacts>
              <artifact src="target/reports/twist" dest="twistreports" />
              <artifact src="target/twist-agents/*/*.log" dest="agent/logs" />
              <artifact src="target/cruise-server-*/*.log" dest="server/logs" />
              <artifact src="target/cruise-server-*/config" dest="server/config" />
            </artifacts>
          </job>
          <job name="firefox-4">
            <tasks>
              <exec command="/bin/bash" args="-c 'rm -rf target/pkg/*.zip'" />
              <exec command="/bin/bash" args="-c 'rm -rf target/*'" />
              <fetchartifact pipeline="cruise-branch" stage="dist-zip" job="zip" srcdir="pkg" dest="target" />
              <exec command="unzip" args="-o target/pkg/cruise-server-*-*.zip -d target" />
              <exec command="unzip" args="-o target/pkg/cruise-agent-*-*.zip -d target" />
              <exec command="chmod" args="+x target/cruise-server-*/server.sh" />
              <exec command="chmod" args="+x target/cruise-server-*/stop-server.sh" />
              <exec command="chmod" args="+x target/cruise-agent-*/agent.sh" />
              <exec command="chmod" args="+x target/cruise-agent-*/stop-agent.sh" />
              <exec command="localivy/jruby/bin/jruby" args="-S buildr cruise:cruise-twist-new:clean cruise:cruise-twist-new:compile cruise:cruise-twist-new:twist test=no twist=yes ratchet=no shine=no TWIST_TAGS='!smoke,!windows'" />
            </tasks>
            <tabs>
              <tab name="Twist" path="twistreports/twist/html/index.html" />
            </tabs>
            <resources>
              <resource>twist-new</resource>
              <resource>linux</resource>
            </resources>
            <artifacts>
              <artifact src="target/reports/twist" dest="twistreports" />
              <artifact src="target/twist-agents/*/*.log" dest="agent/logs" />
              <artifact src="target/cruise-server-*/*.log" dest="server/logs" />
              <artifact src="target/cruise-server-*/config" dest="server/config" />
            </artifacts>
          </job>
          <job name="firefox-5">
            <tasks>
              <exec command="/bin/bash" args="-c 'rm -rf target/pkg/*.zip'" />
              <exec command="/bin/bash" args="-c 'rm -rf target/*'" />
              <fetchartifact pipeline="cruise-branch" stage="dist-zip" job="zip" srcdir="pkg" dest="target" />
              <exec command="unzip" args="-o target/pkg/cruise-server-*-*.zip -d target" />
              <exec command="unzip" args="-o target/pkg/cruise-agent-*-*.zip -d target" />
              <exec command="chmod" args="+x target/cruise-server-*/server.sh" />
              <exec command="chmod" args="+x target/cruise-server-*/stop-server.sh" />
              <exec command="chmod" args="+x target/cruise-agent-*/agent.sh" />
              <exec command="chmod" args="+x target/cruise-agent-*/stop-agent.sh" />
              <exec command="localivy/jruby/bin/jruby" args="-S buildr cruise:cruise-twist-new:clean cruise:cruise-twist-new:compile cruise:cruise-twist-new:twist test=no twist=yes ratchet=no shine=no TWIST_TAGS='!smoke,!windows'" />
            </tasks>
            <tabs>
              <tab name="Twist" path="twistreports/twist/html/index.html" />
            </tabs>
            <resources>
              <resource>twist-new</resource>
              <resource>linux</resource>
            </resources>
            <artifacts>
              <artifact src="target/reports/twist" dest="twistreports" />
              <artifact src="target/twist-agents/*/*.log" dest="agent/logs" />
              <artifact src="target/cruise-server-*/*.log" dest="server/logs" />
              <artifact src="target/cruise-server-*/config" dest="server/config" />
            </artifacts>
          </job>
          <job name="firefox-6">
            <tasks>
              <exec command="/bin/bash" args="-c 'rm -rf target/pkg/*.zip'" />
              <exec command="/bin/bash" args="-c 'rm -rf target/*'" />
              <fetchartifact pipeline="cruise-branch" stage="dist-zip" job="zip" srcdir="pkg" dest="target" />
              <exec command="unzip" args="-o target/pkg/cruise-server-*-*.zip -d target" />
              <exec command="unzip" args="-o target/pkg/cruise-agent-*-*.zip -d target" />
              <exec command="chmod" args="+x target/cruise-server-*/server.sh" />
              <exec command="chmod" args="+x target/cruise-server-*/stop-server.sh" />
              <exec command="chmod" args="+x target/cruise-agent-*/agent.sh" />
              <exec command="chmod" args="+x target/cruise-agent-*/stop-agent.sh" />
              <exec command="localivy/jruby/bin/jruby" args="-S buildr cruise:cruise-twist-new:clean cruise:cruise-twist-new:compile cruise:cruise-twist-new:twist test=no twist=yes ratchet=no shine=no TWIST_TAGS='!smoke,!windows'" />
            </tasks>
            <tabs>
              <tab name="Twist" path="twistreports/twist/html/index.html" />
            </tabs>
            <resources>
              <resource>twist-new</resource>
              <resource>linux</resource>
            </resources>
            <artifacts>
              <artifact src="target/reports/twist" dest="twistreports" />
              <artifact src="target/twist-agents/*/*.log" dest="agent/logs" />
              <artifact src="target/cruise-server-*/*.log" dest="server/logs" />
              <artifact src="target/cruise-server-*/config" dest="server/config" />
            </artifacts>
          </job>
          <job name="firefox-7">
            <tasks>
              <exec command="/bin/bash" args="-c 'rm -rf target/pkg/*.zip'" />
              <exec command="/bin/bash" args="-c 'rm -rf target/*'" />
              <fetchartifact pipeline="cruise-branch" stage="dist-zip" job="zip" srcdir="pkg" dest="target" />
              <exec command="unzip" args="-o target/pkg/cruise-server-*-*.zip -d target" />
              <exec command="unzip" args="-o target/pkg/cruise-agent-*-*.zip -d target" />
              <exec command="chmod" args="+x target/cruise-server-*/server.sh" />
              <exec command="chmod" args="+x target/cruise-server-*/stop-server.sh" />
              <exec command="chmod" args="+x target/cruise-agent-*/agent.sh" />
              <exec command="chmod" args="+x target/cruise-agent-*/stop-agent.sh" />
              <exec command="localivy/jruby/bin/jruby" args="-S buildr cruise:cruise-twist-new:clean cruise:cruise-twist-new:compile cruise:cruise-twist-new:twist test=no twist=yes ratchet=no shine=no TWIST_TAGS='!smoke,!windows'" />
            </tasks>
            <tabs>
              <tab name="Twist" path="twistreports/twist/html/index.html" />
            </tabs>
            <resources>
              <resource>twist-new</resource>
              <resource>linux</resource>
            </resources>
            <artifacts>
              <artifact src="target/reports/twist" dest="twistreports" />
              <artifact src="target/twist-agents/*/*.log" dest="agent/logs" />
              <artifact src="target/cruise-server-*/*.log" dest="server/logs" />
              <artifact src="target/cruise-server-*/config" dest="server/config" />
            </artifacts>
          </job>
          <job name="ie-1">
            <tasks>
              <exec command="rm" args="-rf target" />
              <exec command="mkdir" args="target" />
              <fetchartifact pipeline="cruise-branch" stage="dist-zip" job="zip" srcdir="pkg" dest="target" />
              <exec command="unzip" args="-o target/pkg/cruise-server-*-*.zip -d target" />
              <exec command="unzip" args="-o target/pkg/cruise-agent-*-*.zip -d target" />
              <exec command="localivy/jruby/bin/jruby" args="-S buildr cruise:cruise-twist-new:clean cruise:cruise-twist-new:compile cruise:cruise-twist-new:twist test=no twist=yes ratchet=no shine=no TWIST_TAGS='!smoke'" />
            </tasks>
            <tabs>
              <tab name="Twist" path="twistreports/twist/html/index.html" />
            </tabs>
            <resources>
              <resource>twist-new</resource>
              <resource>windows</resource>
            </resources>
            <artifacts>
              <artifact src="target/reports/twist" dest="twistreports" />
              <artifact src="target/twist-agents/*/*.log" dest="agent/logs" />
              <artifact src="target/cruise-server-*/*.log" dest="server/logs" />
              <artifact src="target/cruise-server-*/config" dest="server/config" />
            </artifacts>
          </job>
          <job name="ie-2">
            <tasks>
              <exec command="rm" args="-rf target" />
              <exec command="mkdir" args="target" />
              <fetchartifact pipeline="cruise-branch" stage="dist-zip" job="zip" srcdir="pkg" dest="target" />
              <exec command="unzip" args="-o target/pkg/cruise-server-*-*.zip -d target" />
              <exec command="unzip" args="-o target/pkg/cruise-agent-*-*.zip -d target" />
              <exec command="localivy/jruby/bin/jruby" args="-S buildr cruise:cruise-twist-new:clean cruise:cruise-twist-new:compile cruise:cruise-twist-new:twist test=no twist=yes ratchet=no shine=no TWIST_TAGS='!smoke'" />
            </tasks>
            <tabs>
              <tab name="Twist" path="twistreports/twist/html/index.html" />
            </tabs>
            <resources>
              <resource>twist-new</resource>
              <resource>windows</resource>
            </resources>
            <artifacts>
              <artifact src="target/reports/twist" dest="twistreports" />
              <artifact src="target/twist-agents/*/*.log" dest="agent/logs" />
              <artifact src="target/cruise-server-*/*.log" dest="server/logs" />
              <artifact src="target/cruise-server-*/config" dest="server/config" />
            </artifacts>
          </job>
          <job name="ie-3">
            <tasks>
              <exec command="rm" args="-rf target" />
              <exec command="mkdir" args="target" />
              <fetchartifact pipeline="cruise-branch" stage="dist-zip" job="zip" srcdir="pkg" dest="target" />
              <exec command="unzip" args="-o target/pkg/cruise-server-*-*.zip -d target" />
              <exec command="unzip" args="-o target/pkg/cruise-agent-*-*.zip -d target" />
              <exec command="localivy/jruby/bin/jruby" args="-S buildr cruise:cruise-twist-new:clean cruise:cruise-twist-new:compile cruise:cruise-twist-new:twist test=no twist=yes ratchet=no shine=no TWIST_TAGS='!smoke'" />
            </tasks>
            <tabs>
              <tab name="Twist" path="twistreports/twist/html/index.html" />
            </tabs>
            <resources>
              <resource>twist-new</resource>
              <resource>windows</resource>
            </resources>
            <artifacts>
              <artifact src="target/reports/twist" dest="twistreports" />
              <artifact src="target/twist-agents/*/*.log" dest="agent/logs" />
              <artifact src="target/cruise-server-*/*.log" dest="server/logs" />
              <artifact src="target/cruise-server-*/config" dest="server/config" />
            </artifacts>
          </job>
          <job name="ie-4">
            <tasks>
              <exec command="rm" args="-rf target" />
              <exec command="mkdir" args="target" />
              <fetchartifact pipeline="cruise-branch" stage="dist-zip" job="zip" srcdir="pkg" dest="target" />
              <exec command="unzip" args="-o target/pkg/cruise-server-*-*.zip -d target" />
              <exec command="unzip" args="-o target/pkg/cruise-agent-*-*.zip -d target" />
              <exec command="localivy/jruby/bin/jruby" args="-S buildr cruise:cruise-twist-new:clean cruise:cruise-twist-new:compile cruise:cruise-twist-new:twist test=no twist=yes ratchet=no shine=no TWIST_TAGS='!smoke'" />
            </tasks>
            <tabs>
              <tab name="Twist" path="twistreports/twist/html/index.html" />
            </tabs>
            <resources>
              <resource>twist-new</resource>
              <resource>windows</resource>
            </resources>
            <artifacts>
              <artifact src="target/reports/twist" dest="twistreports" />
              <artifact src="target/twist-agents/*/*.log" dest="agent/logs" />
              <artifact src="target/cruise-server-*/*.log" dest="server/logs" />
              <artifact src="target/cruise-server-*/config" dest="server/config" />
            </artifacts>
          </job>
          <job name="ie-5">
            <tasks>
              <exec command="rm" args="-rf target" />
              <exec command="mkdir" args="target" />
              <fetchartifact pipeline="cruise-branch" stage="dist-zip" job="zip" srcdir="pkg" dest="target" />
              <exec command="unzip" args="-o target/pkg/cruise-server-*-*.zip -d target" />
              <exec command="unzip" args="-o target/pkg/cruise-agent-*-*.zip -d target" />
              <exec command="localivy/jruby/bin/jruby" args="-S buildr cruise:cruise-twist-new:clean cruise:cruise-twist-new:compile cruise:cruise-twist-new:twist test=no twist=yes ratchet=no shine=no TWIST_TAGS='!smoke'" />
            </tasks>
            <tabs>
              <tab name="Twist" path="twistreports/twist/html/index.html" />
            </tabs>
            <resources>
              <resource>twist-new</resource>
              <resource>windows</resource>
            </resources>
            <artifacts>
              <artifact src="target/reports/twist" dest="twistreports" />
              <artifact src="target/twist-agents/*/*.log" dest="agent/logs" />
              <artifact src="target/cruise-server-*/*.log" dest="server/logs" />
              <artifact src="target/cruise-server-*/config" dest="server/config" />
            </artifacts>
          </job>
          <job name="ie-6">
            <tasks>
              <exec command="rm" args="-rf target" />
              <exec command="mkdir" args="target" />
              <fetchartifact pipeline="cruise-branch" stage="dist-zip" job="zip" srcdir="pkg" dest="target" />
              <exec command="unzip" args="-o target/pkg/cruise-server-*-*.zip -d target" />
              <exec command="unzip" args="-o target/pkg/cruise-agent-*-*.zip -d target" />
              <exec command="localivy/jruby/bin/jruby" args="-S buildr cruise:cruise-twist-new:clean cruise:cruise-twist-new:compile cruise:cruise-twist-new:twist test=no twist=yes ratchet=no shine=no TWIST_TAGS='!smoke'" />
            </tasks>
            <tabs>
              <tab name="Twist" path="twistreports/twist/html/index.html" />
            </tabs>
            <resources>
              <resource>twist-new</resource>
              <resource>windows</resource>
            </resources>
            <artifacts>
              <artifact src="target/reports/twist" dest="twistreports" />
              <artifact src="target/twist-agents/*/*.log" dest="agent/logs" />
              <artifact src="target/cruise-server-*/*.log" dest="server/logs" />
              <artifact src="target/cruise-server-*/config" dest="server/config" />
            </artifacts>
          </job>
          <job name="ie-7">
            <tasks>
              <exec command="rm" args="-rf target" />
              <exec command="mkdir" args="target" />
              <fetchartifact pipeline="cruise-branch" stage="dist-zip" job="zip" srcdir="pkg" dest="target" />
              <exec command="unzip" args="-o target/pkg/cruise-server-*-*.zip -d target" />
              <exec command="unzip" args="-o target/pkg/cruise-agent-*-*.zip -d target" />
              <exec command="localivy/jruby/bin/jruby" args="-S buildr cruise:cruise-twist-new:clean cruise:cruise-twist-new:compile cruise:cruise-twist-new:twist test=no twist=yes ratchet=no shine=no TWIST_TAGS='!smoke'" />
            </tasks>
            <tabs>
              <tab name="Twist" path="twistreports/twist/html/index.html" />
            </tabs>
            <resources>
              <resource>twist-new</resource>
              <resource>windows</resource>
            </resources>
            <artifacts>
              <artifact src="target/reports/twist" dest="twistreports" />
              <artifact src="target/twist-agents/*/*.log" dest="agent/logs" />
              <artifact src="target/cruise-server-*/*.log" dest="server/logs" />
              <artifact src="target/cruise-server-*/config" dest="server/config" />
            </artifacts>
          </job>
        </jobs>
      </stage>
      <stage name="dist">
        <approval type="manual" />
        <jobs>
          <job name="linux-firefox">
            <tasks>
              <ant target="-Drun=all clean.systmpdir cruise.dist " />
            </tasks>
            <resources>
              <resource>dev</resource>
              <resource>linux</resource>
            </resources>
            <artifacts>
              <artifact src="target/pkg" />
            </artifacts>
          </job>
          <job name="dist-solaris">
            <tasks>
              <ant target="-Drun=all clean.ivy.localivy clean dist.sol " />
            </tasks>
            <resources>
              <resource>solaris</resource>
            </resources>
            <artifacts>
              <artifact src="target/pkg/cruise*.gz" dest="pkg" />
            </artifacts>
          </job>
        </jobs>
      </stage>
    </pipeline>
  </pipelines>
  <pipelines group="cruise-archive">
    <pipeline name="cleanArtifacts">
      <timer>59 59 23 ? * *</timer>
      <materials>
        <svn url="http://10.18.3.171:8080/svn/artifactsmanagement/trunk" username="cce" password="go.pass" dest="keptfolder" />
        <svn url="http://cruisetools.googlecode.com/svn/trunk/artifactsmanagement/lib" dest="app" />
      </materials>
      <stage name="defaultStage">
        <approval type="manual" />
        <jobs>
          <job name="defaultJob">
            <tasks>
              <exec command="/bin/bash" args="-c &quot; cp  foldersToBeKept.txt ../app&quot;" workingdir="keptfolder" />
              <rake target="dirname=/var/lib/cruise-server/logs/pipelines time=2w" workingdir="app" />
            </tasks>
            <tabs>
              <tab name="FilterList" path="filterlist/foldersToBeKept.txt" />
            </tabs>
            <resources>
              <resource>UAT-Server</resource>
            </resources>
            <artifacts>
              <artifact src="app/foldersToBeKept.txt" dest="filterlist" />
            </artifacts>
          </job>
        </jobs>
      </stage>
    </pipeline>
    <pipeline name="cruise-1.3.2" labeltemplate="1.3.2.${COUNT}-${BRANCH-1.3.2}">
      <trackingtool link="https://mingle.somewhere.com/projects/cruise/cards/${ID}" regex="#(\d+)" />
      <materials>
        <hg url="https://abc:def@fmtstdscm01.somewhere.com/cruise-1.3.2" materialName="branch-1.3.2">
          <filter>
            <ignore pattern="helper/**/*.*" />
            <ignore pattern="spike/**/*.*" />
            <ignore pattern="QA/**/*.*" />
            <ignore pattern="**/*.css" />
            <ignore pattern="performance/ec2/**/*.*" />
            <ignore pattern="performance/ec3/**/*.*" />
            <ignore pattern="manual-testing/**/*.*" />
          </filter>
        </hg>
      </materials>
      <stage name="dev">
        <approval type="manual" />
        <jobs>
          <job name="windows-1">
            <tasks>
              <ant target="-Drun=all clean.systmpdir clean.ivy.localivy clean checkstyle ut ft" />
              <ant target="output-agent-environment-information">
                <runif status="failed" />
              </ant>
            </tasks>
            <resources>
              <resource>windows</resource>
              <resource>dev</resource>
            </resources>
          </job>
          <job name="windows-2">
            <tasks>
              <ant target="-Drun=all clean.systmpdir clean.ivy.localivy clean checkstyle ut ft" />
            </tasks>
            <resources>
              <resource>windows</resource>
              <resource>dev</resource>
            </resources>
            <artifacts>
              <test src="target/reports" />
            </artifacts>
          </job>
          <job name="windows-3">
            <tasks>
              <ant target="-Drun=all clean.systmpdir clean.ivy.localivy clean checkstyle ut ft" />
            </tasks>
            <resources>
              <resource>windows</resource>
              <resource>dev</resource>
            </resources>
            <artifacts>
              <test src="target/reports" />
            </artifacts>
          </job>
          <job name="windows-4">
            <tasks>
              <ant target="-Drun=all clean.systmpdir clean.ivy.localivy clean checkstyle ut ft" />
            </tasks>
            <resources>
              <resource>windows</resource>
              <resource>dev</resource>
            </resources>
            <artifacts>
              <test src="target/reports" />
            </artifacts>
          </job>
          <job name="windows-5">
            <tasks>
              <ant target="-Drun=all clean.systmpdir clean.ivy.localivy clean checkstyle ut ft" />
            </tasks>
            <resources>
              <resource>windows</resource>
              <resource>dev</resource>
            </resources>
            <artifacts>
              <test src="target/reports" />
            </artifacts>
          </job>
          <job name="windows-6">
            <tasks>
              <ant target="-Drun=all clean.systmpdir clean.ivy.localivy clean checkstyle ut ft" />
            </tasks>
            <resources>
              <resource>windows</resource>
              <resource>dev</resource>
            </resources>
            <artifacts>
              <test src="target/reports" />
            </artifacts>
          </job>
          <job name="linux-firefox">
            <tasks>
              <ant target="-Drun=all  clean.systmpdir clean.ivy.localivy clean checkstyle ut ft" />
              <ant target="time" />
            </tasks>
            <tabs>
              <tab name="Console" path="cruise-output/console.log" />
              <tab name="Junit-time" path="reports/junit-time-report.html" />
            </tabs>
            <resources>
              <resource>linux</resource>
              <resource>dev</resource>
            </resources>
            <artifacts>
              <test src="target/reports" />
            </artifacts>
          </job>
          <job name="linux-firefox-2">
            <tasks>
              <ant target="-Drun=all  clean.systmpdir clean.ivy.localivy clean checkstyle ut ft" />
              <ant target="time" />
            </tasks>
            <tabs>
              <tab name="Console" path="cruise-output/console.log" />
              <tab name="Junit-time" path="reports/junit-time-report.html" />
            </tabs>
            <resources>
              <resource>linux</resource>
              <resource>dev</resource>
            </resources>
            <artifacts>
              <test src="target/reports" />
            </artifacts>
          </job>
          <job name="linux-firefox-3">
            <tasks>
              <ant target="-Drun=all  clean.systmpdir clean.ivy.localivy clean checkstyle ut ft" />
              <ant target="time" />
            </tasks>
            <tabs>
              <tab name="Console" path="cruise-output/console.log" />
              <tab name="Junit-time" path="reports/junit-time-report.html" />
            </tabs>
            <resources>
              <resource>linux</resource>
              <resource>dev</resource>
            </resources>
            <artifacts>
              <test src="target/reports" />
            </artifacts>
          </job>
          <job name="linux-firefox-4">
            <tasks>
              <ant target="-Drun=all  clean.systmpdir clean.ivy.localivy clean checkstyle ut ft" />
              <ant target="time" />
            </tasks>
            <tabs>
              <tab name="Console" path="cruise-output/console.log" />
              <tab name="Junit-time" path="reports/junit-time-report.html" />
            </tabs>
            <resources>
              <resource>linux</resource>
              <resource>dev</resource>
            </resources>
            <artifacts>
              <test src="target/reports" />
            </artifacts>
          </job>
          <job name="linux-firefox-5">
            <tasks>
              <ant target="-Drun=all  clean.systmpdir clean.ivy.localivy clean checkstyle ut ft" />
              <ant target="time" />
            </tasks>
            <tabs>
              <tab name="Console" path="cruise-output/console.log" />
              <tab name="Junit-time" path="reports/junit-time-report.html" />
            </tabs>
            <resources>
              <resource>linux</resource>
              <resource>dev</resource>
            </resources>
            <artifacts>
              <test src="target/reports" />
            </artifacts>
          </job>
          <job name="linux-firefox-6">
            <tasks>
              <ant target="-Drun=all  clean.systmpdir clean.ivy.localivy clean checkstyle ut ft" />
              <ant target="time" />
            </tasks>
            <tabs>
              <tab name="Console" path="cruise-output/console.log" />
              <tab name="Junit-time" path="reports/junit-time-report.html" />
            </tabs>
            <resources>
              <resource>linux</resource>
              <resource>dev</resource>
            </resources>
            <artifacts>
              <test src="target/reports" />
            </artifacts>
          </job>
          <job name="help">
            <tasks>
              <rake workingdir="helper" />
              <rake target="build:book" workingdir="helper" />
            </tasks>
            <tabs>
              <tab name="Documentation" path="output/build/index.html" />
            </tabs>
            <resources>
              <resource>dev</resource>
              <resource>linux</resource>
            </resources>
            <artifacts>
              <artifact src="helper/build" dest="output" />
              <artifact src="helper/single_file.html" dest="output" />
            </artifacts>
          </job>
          <job name="jsunit">
            <tasks>
              <ant target="-Drun=all clean.systmpdir clean.ivy.localivy clean jsunit" />
            </tasks>
            <resources>
              <resource>linux</resource>
              <resource>java</resource>
            </resources>
            <artifacts>
              <artifact src="server/jsunit/logs" />
            </artifacts>
          </job>
        </jobs>
      </stage>
      <stage name="dist-zip">
        <jobs>
          <job name="linux-firefox">
            <tasks>
              <ant target="-Drun=all clean.systmpdir -Dtest.skip=true clean.ivy.localivy clean uat-dist-zip dist.deb" />
            </tasks>
            <resources>
              <resource>java</resource>
              <resource>debian</resource>
            </resources>
            <artifacts>
              <artifact src="target/cruise-server-1.3.2" dest="target" />
              <artifact src="target/cruise-agent-1.3.2" dest="target" />
              <artifact src="target/pkg/**/*.*" dest="pkg" />
            </artifacts>
          </job>
        </jobs>
      </stage>
      <stage name="twist-tests">
        <approval type="success">
          <authorization>
            <role>admins</role>
          </authorization>
        </approval>
        <jobs>
          <job name="analysis">
            <tasks>
              <ant target="-Drun=all dev">
                <oncancel>
                  <exec command="pkill" args="-f 'java.*ant.*-Drun=all dev'" />
                </oncancel>
              </ant>
              <exec command="ruby" args="spike/smell-counter/script/count_cruise_smells.rb target/smells.xml" />
            </tasks>
            <tabs>
              <tab name="Emma" path="analysis/emma/coverage.html" />
              <tab name="JDepend" path="analysis/jdepend/jdepend-report.html" />
              <tab name="ncss_util" path="analysis/javancss/javancss_metrics_util.html" />
              <tab name="ncss_common" path="analysis/javancss/javancss_metrics_common.html" />
              <tab name="ncss_agent" path="analysis/javancss/javancss_metrics_agent.html" />
              <tab name="ncss_server" path="analysis/javancss/javancss_metrics_server.html" />
            </tabs>
            <resources>
              <resource>analysis</resource>
            </resources>
            <artifacts>
              <artifact src="target/emma" dest="analysis" />
              <artifact src="target/jdepend" dest="analysis" />
              <artifact src="target/javancss" dest="analysis" />
              <artifact src="target/smells.xml" dest="smells" />
            </artifacts>
            <properties>
              <property name="coverage.class" src="target/emma/coverage.xml" xpath="substring-before(//report/data/all/coverage[starts-with(@type,'class')]/@value, '%')" />
              <property name="coverage.method" src="target/emma/coverage.xml" xpath="substring-before(//report/data/all/coverage[starts-with(@type,'method')]/@value, '%')" />
              <property name="coverage.block" src="target/emma/coverage.xml" xpath="substring-before(//report/data/all/coverage[starts-with(@type,'block')]/@value, '%')" />
              <property name="coverage.line" src="target/emma/coverage.xml" xpath="substring-before(//report/data/all/coverage[starts-with(@type,'line')]/@value, '%')" />
              <property name="smell.count" src="target/smells.xml" xpath="string(/smells/@count)" />
              <property name="ncss.agent.function.ncss" src="target/javancss/javancss_metrics_agent.xml" xpath="string(//function_averages/ncss)" />
              <property name="ncss.common.function.ncss" src="target/javancss/javancss_metrics_common.xml" xpath="string(//function_averages/ncss)" />
              <property name="ncss.server.function.ncss" src="target/javancss/javancss_metrics_server.xml" xpath="string(//function_averages/ncss)" />
              <property name="ncss.util.function.ncss" src="target/javancss/javancss_metrics_util.xml" xpath="string(//function_averages/ncss)" />
              <property name="ncss.agent.function.ccn" src="target/javancss/javancss_metrics_agent.xml" xpath="string(//function_averages/ccn)" />
              <property name="ncss.common.function.ccn" src="target/javancss/javancss_metrics_common.xml" xpath="string(//function_averages/ccn)" />
              <property name="ncss.server.function.ccn" src="target/javancss/javancss_metrics_server.xml" xpath="string(//function_averages/ccn)" />
              <property name="ncss.util.function.ccn" src="target/javancss/javancss_metrics_util.xml" xpath="string(//function_averages/ccn)" />
              <property name="ncss.agent.ncss" src="target/javancss/javancss_metrics_agent.xml" xpath="string(//functions/ncss)" />
              <property name="ncss.common.ncss" src="target/javancss/javancss_metrics_common.xml" xpath="string(//functions/ncss)" />
              <property name="ncss.server.ncss" src="target/javancss/javancss_metrics_server.xml" xpath="string(//functions/ncss)" />
              <property name="ncss.util.ncss" src="target/javancss/javancss_metrics_util.xml" xpath="string(//functions/ncss)" />
            </properties>
          </job>
          <job name="long-running">
            <tasks>
              <ant target="-Drun=all clean.systmpdir clean.ivy.localivy clean checkstyle ut.longrunning" />
              <ant target="time" />
            </tasks>
            <tabs>
              <tab name="Junit-time" path="reports/junit-time-report.html" />
            </tabs>
            <resources>
              <resource>long-run</resource>
            </resources>
            <artifacts>
              <test src="target/reports" />
            </artifacts>
          </job>
          <job name="twist-firefox">
            <tasks>
              <ant target="clean clean_4_twist" />
              <fetchartifact pipeline="cruise-1.3.2" stage="dist-zip" job="linux-firefox" srcdir="target/cruise-server-1.3.2" dest="target" />
              <fetchartifact pipeline="cruise-1.3.2" stage="dist-zip" job="linux-firefox" srcdir="target/cruise-agent-1.3.2" dest="target" />
              <exec command="chmod" args="+x target/cruise-server-*/server.sh" />
              <exec command="chmod" args="+x target/cruise-server-*/stop-server.sh" />
              <exec command="chmod" args="+x target/cruise-agent-*/agent.sh" />
              <exec command="chmod" args="+x target/cruise-agent-*/stop-agent.sh" />
              <ant target="twist">
                <oncancel>
                  <ant target="kill_twist" />
                </oncancel>
              </ant>
            </tasks>
            <tabs>
              <tab name="twist" path="twistreports/html/index.html" />
            </tabs>
            <resources>
              <resource>linux</resource>
              <resource>twist-new</resource>
            </resources>
            <artifacts>
              <artifact src="target/reports/html" dest="twistreports" />
              <artifact src="target/reports/xml" dest="twistreports" />
              <artifact src="target/reports/screenshots" dest="twistreports" />
              <artifact src="target/reports/recording" dest="recording" />
              <artifact src="target/cruise-agent-1.3.2/cruise-agent.log" />
              <artifact src="target/cruise-server-1.3.2/config/cruise-config.xml" />
              <artifact src="target/cruise-server-1.3.2/cruise-server.log" />
              <test src="target/reports/xml" />
            </artifacts>
          </job>
          <job name="twist-firefox-2">
            <tasks>
              <ant target="clean clean_4_twist" />
              <fetchartifact pipeline="cruise-1.3.2" stage="dist-zip" job="linux-firefox" srcdir="target/cruise-server-1.3.2" dest="target" />
              <fetchartifact pipeline="cruise-1.3.2" stage="dist-zip" job="linux-firefox" srcdir="target/cruise-agent-1.3.2" dest="target" />
              <exec command="chmod" args="+x target/cruise-server-*/server.sh" />
              <exec command="chmod" args="+x target/cruise-server-*/stop-server.sh" />
              <exec command="chmod" args="+x target/cruise-agent-*/agent.sh" />
              <exec command="chmod" args="+x target/cruise-agent-*/stop-agent.sh" />
              <ant target="twist">
                <oncancel>
                  <ant target="kill_twist" />
                </oncancel>
              </ant>
            </tasks>
            <tabs>
              <tab name="twist" path="twistreports/html/index.html" />
            </tabs>
            <resources>
              <resource>linux</resource>
              <resource>twist-new</resource>
            </resources>
            <artifacts>
              <artifact src="target/reports/html" dest="twistreports" />
              <artifact src="target/reports/xml" dest="twistreports" />
              <artifact src="target/reports/screenshots" dest="twistreports" />
              <artifact src="target/reports/recording" dest="recording" />
              <artifact src="target/cruise-agent-1.3.2/cruise-agent.log" />
              <artifact src="target/cruise-server-1.3.2/config/cruise-config.xml" />
              <artifact src="target/cruise-server-1.3.2/cruise-server.log" />
              <test src="target/reports/xml" />
            </artifacts>
          </job>
          <job name="twist-firefox-3">
            <tasks>
              <ant target="clean clean_4_twist" />
              <fetchartifact pipeline="cruise-1.3.2" stage="dist-zip" job="linux-firefox" srcdir="target/cruise-server-1.3.2" dest="target" />
              <fetchartifact pipeline="cruise-1.3.2" stage="dist-zip" job="linux-firefox" srcdir="target/cruise-agent-1.3.2" dest="target" />
              <exec command="chmod" args="+x target/cruise-server-*/server.sh" />
              <exec command="chmod" args="+x target/cruise-server-*/stop-server.sh" />
              <exec command="chmod" args="+x target/cruise-agent-*/agent.sh" />
              <exec command="chmod" args="+x target/cruise-agent-*/stop-agent.sh" />
              <ant target="twist">
                <oncancel>
                  <ant target="kill_twist" />
                </oncancel>
              </ant>
            </tasks>
            <tabs>
              <tab name="twist" path="twistreports/html/index.html" />
            </tabs>
            <resources>
              <resource>linux</resource>
              <resource>twist-new</resource>
            </resources>
            <artifacts>
              <artifact src="target/reports/html" dest="twistreports" />
              <artifact src="target/reports/xml" dest="twistreports" />
              <artifact src="target/reports/screenshots" dest="twistreports" />
              <artifact src="target/reports/recording" dest="recording" />
              <artifact src="target/cruise-agent-1.3.2/cruise-agent.log" />
              <artifact src="target/cruise-server-1.3.2/config/cruise-config.xml" />
              <artifact src="target/cruise-server-1.3.2/cruise-server.log" />
              <test src="target/reports/xml" />
            </artifacts>
          </job>
          <job name="twist-firefox-4">
            <tasks>
              <ant target="clean clean_4_twist" />
              <fetchartifact pipeline="cruise-1.3.2" stage="dist-zip" job="linux-firefox" srcdir="target/cruise-server-1.3.2" dest="target" />
              <fetchartifact pipeline="cruise-1.3.2" stage="dist-zip" job="linux-firefox" srcdir="target/cruise-agent-1.3.2" dest="target" />
              <exec command="chmod" args="+x target/cruise-server-*/server.sh" />
              <exec command="chmod" args="+x target/cruise-server-*/stop-server.sh" />
              <exec command="chmod" args="+x target/cruise-agent-*/agent.sh" />
              <exec command="chmod" args="+x target/cruise-agent-*/stop-agent.sh" />
              <ant target="twist">
                <oncancel>
                  <ant target="kill_twist" />
                </oncancel>
              </ant>
            </tasks>
            <tabs>
              <tab name="twist" path="twistreports/html/index.html" />
              <tab name="Recording" path="recording/recording/twist-recording.html" />
            </tabs>
            <resources>
              <resource>linux</resource>
              <resource>twist-new</resource>
            </resources>
            <artifacts>
              <artifact src="target/reports/html" dest="twistreports" />
              <artifact src="target/reports/xml" dest="twistreports" />
              <artifact src="target/reports/screenshots" dest="twistreports" />
              <artifact src="target/reports/recording" dest="recording" />
              <artifact src="target/cruise-agent-1.3.2/cruise-agent.log" />
              <artifact src="target/cruise-server-1.3.2/config/cruise-config.xml" />
              <artifact src="target/cruise-server-1.3.2/cruise-server.log" />
              <test src="target/reports/xml" />
            </artifacts>
          </job>
          <job name="twist-firefox-5">
            <tasks>
              <ant target="clean clean_4_twist" />
              <fetchartifact pipeline="cruise-1.3.2" stage="dist-zip" job="linux-firefox" srcdir="target/cruise-server-1.3.2" dest="target" />
              <fetchartifact pipeline="cruise-1.3.2" stage="dist-zip" job="linux-firefox" srcdir="target/cruise-agent-1.3.2" dest="target" />
              <exec command="chmod" args="+x target/cruise-server-*/server.sh" />
              <exec command="chmod" args="+x target/cruise-server-*/stop-server.sh" />
              <exec command="chmod" args="+x target/cruise-agent-*/agent.sh" />
              <exec command="chmod" args="+x target/cruise-agent-*/stop-agent.sh" />
              <ant target="twist">
                <oncancel>
                  <ant target="kill_twist" />
                </oncancel>
              </ant>
            </tasks>
            <tabs>
              <tab name="twist" path="twistreports/html/index.html" />
            </tabs>
            <resources>
              <resource>linux</resource>
              <resource>twist-new</resource>
            </resources>
            <artifacts>
              <artifact src="target/reports/html" dest="twistreports" />
              <artifact src="target/reports/xml" dest="twistreports" />
              <artifact src="target/reports/screenshots" dest="twistreports" />
              <artifact src="target/reports/recording" dest="recording" />
              <artifact src="target/cruise-agent-1.3.2/cruise-agent.log" />
              <artifact src="target/cruise-server-1.3.2/config/cruise-config.xml" />
              <artifact src="target/cruise-server-1.3.2/cruise-server.log" />
              <test src="target/reports/xml" />
            </artifacts>
          </job>
          <job name="twist-firefox-6">
            <tasks>
              <ant target="clean clean_4_twist" />
              <fetchartifact pipeline="cruise-1.3.2" stage="dist-zip" job="linux-firefox" srcdir="target/cruise-server-1.3.2" dest="target" />
              <fetchartifact pipeline="cruise-1.3.2" stage="dist-zip" job="linux-firefox" srcdir="target/cruise-agent-1.3.2" dest="target" />
              <exec command="chmod" args="+x target/cruise-server-*/server.sh" />
              <exec command="chmod" args="+x target/cruise-server-*/stop-server.sh" />
              <exec command="chmod" args="+x target/cruise-agent-*/agent.sh" />
              <exec command="chmod" args="+x target/cruise-agent-*/stop-agent.sh" />
              <ant target="twist">
                <oncancel>
                  <ant target="kill_twist" />
                </oncancel>
              </ant>
            </tasks>
            <tabs>
              <tab name="twist" path="twistreports/html/index.html" />
            </tabs>
            <resources>
              <resource>linux</resource>
              <resource>twist-new</resource>
            </resources>
            <artifacts>
              <artifact src="target/reports/html" dest="twistreports" />
              <artifact src="target/reports/xml" dest="twistreports" />
              <artifact src="target/reports/screenshots" dest="twistreports" />
              <artifact src="target/reports/recording" dest="recording" />
              <artifact src="target/cruise-agent-1.3.2/cruise-agent.log" />
              <artifact src="target/cruise-server-1.3.2/config/cruise-config.xml" />
              <artifact src="target/cruise-server-1.3.2/cruise-server.log" />
              <test src="target/reports/xml" />
            </artifacts>
          </job>
          <job name="ie7">
            <tasks>
              <ant target="clean" />
              <fetchartifact pipeline="cruise-1.3.2" stage="dist-zip" job="linux-firefox" srcdir="target/cruise-server-1.3.2" dest="target" />
              <fetchartifact pipeline="cruise-1.3.2" stage="dist-zip" job="linux-firefox" srcdir="target/cruise-agent-1.3.2" dest="target" />
              <ant target="twist" />
            </tasks>
            <tabs>
              <tab name="twist" path="twistreports/html/index.html" />
            </tabs>
            <resources>
              <resource>windows</resource>
              <resource>java</resource>
            </resources>
            <artifacts>
              <artifact src="target/reports/html" dest="twistreports" />
              <artifact src="target/reports/xml" dest="twistreports" />
              <artifact src="target/reports/screenshots" dest="twistreports" />
              <artifact src="target/reports/recording" dest="recording" />
              <artifact src="target/cruise-agent-1.3.2/cruise-agent.log" />
              <artifact src="target/cruise-server-1.3.2/config/cruise-config.xml" />
              <artifact src="target/cruise-server-1.3.2/cruise-server.log" />
              <test src="target/reports/xml" />
            </artifacts>
          </job>
          <job name="ie7-2">
            <tasks>
              <ant target="clean" />
              <fetchartifact pipeline="cruise-1.3.2" stage="dist-zip" job="linux-firefox" srcdir="target/cruise-server-1.3.2" dest="target" />
              <fetchartifact pipeline="cruise-1.3.2" stage="dist-zip" job="linux-firefox" srcdir="target/cruise-agent-1.3.2" dest="target" />
              <ant target="twist" />
            </tasks>
            <tabs>
              <tab name="twist" path="twistreports/html/index.html" />
            </tabs>
            <resources>
              <resource>windows</resource>
              <resource>java</resource>
            </resources>
            <artifacts>
              <artifact src="target/reports/html" dest="twistreports" />
              <artifact src="target/reports/xml" dest="twistreports" />
              <artifact src="target/reports/screenshots" dest="twistreports" />
              <artifact src="target/reports/recording" dest="recording" />
              <artifact src="target/cruise-agent-1.3.2/cruise-agent.log" />
              <artifact src="target/cruise-server-1.3.2/db/h2db" />
              <artifact src="target/cruise-server-1.3.2/config/cruise-config.xml" />
              <artifact src="target/cruise-server-1.3.2/cruise-server.log" />
              <test src="target/reports/xml" />
            </artifacts>
          </job>
          <job name="ie7-3">
            <tasks>
              <ant target="clean" />
              <fetchartifact pipeline="cruise-1.3.2" stage="dist-zip" job="linux-firefox" srcdir="target/cruise-server-1.3.2" dest="target" />
              <fetchartifact pipeline="cruise-1.3.2" stage="dist-zip" job="linux-firefox" srcdir="target/cruise-agent-1.3.2" dest="target" />
              <ant target="twist" />
            </tasks>
            <tabs>
              <tab name="twist" path="twistreports/html/index.html" />
            </tabs>
            <resources>
              <resource>windows</resource>
              <resource>java</resource>
            </resources>
            <artifacts>
              <artifact src="target/reports/html" dest="twistreports" />
              <artifact src="target/reports/xml" dest="twistreports" />
              <artifact src="target/reports/screenshots" dest="twistreports" />
              <artifact src="target/reports/recording" dest="recording" />
              <artifact src="target/cruise-agent-1.3.2/cruise-agent.log" />
              <artifact src="target/cruise-server-1.3.2/db/h2db" />
              <artifact src="target/cruise-server-1.3.2/config/cruise-config.xml" />
              <artifact src="target/cruise-server-1.3.2/cruise-server.log" />
              <test src="target/reports/xml" />
            </artifacts>
          </job>
          <job name="ie7-4">
            <tasks>
              <ant target="clean" />
              <fetchartifact pipeline="cruise-1.3.2" stage="dist-zip" job="linux-firefox" srcdir="target/cruise-server-1.3.2" dest="target" />
              <fetchartifact pipeline="cruise-1.3.2" stage="dist-zip" job="linux-firefox" srcdir="target/cruise-agent-1.3.2" dest="target" />
              <ant target="twist" />
            </tasks>
            <tabs>
              <tab name="twist" path="twistreports/html/index.html" />
            </tabs>
            <resources>
              <resource>windows</resource>
              <resource>java</resource>
            </resources>
            <artifacts>
              <artifact src="target/reports/html" dest="twistreports" />
              <artifact src="target/reports/xml" dest="twistreports" />
              <artifact src="target/reports/screenshots" dest="twistreports" />
              <artifact src="target/reports/recording" dest="recording" />
              <artifact src="target/cruise-agent-1.3.2/cruise-agent.log" />
              <artifact src="target/cruise-server-1.3.2/db/h2db" />
              <artifact src="target/cruise-server-1.3.2/config/cruise-config.xml" />
              <artifact src="target/cruise-server-1.3.2/cruise-server.log" />
              <test src="target/reports/xml" />
            </artifacts>
          </job>
          <job name="ie7-5">
            <tasks>
              <ant target="clean" />
              <fetchartifact pipeline="cruise-1.3.2" stage="dist-zip" job="linux-firefox" srcdir="target/cruise-server-1.3.2" dest="target" />
              <fetchartifact pipeline="cruise-1.3.2" stage="dist-zip" job="linux-firefox" srcdir="target/cruise-agent-1.3.2" dest="target" />
              <ant target="twist" />
            </tasks>
            <tabs>
              <tab name="twist" path="twistreports/html/index.html" />
            </tabs>
            <resources>
              <resource>windows</resource>
              <resource>java</resource>
            </resources>
            <artifacts>
              <artifact src="target/reports/html" dest="twistreports" />
              <artifact src="target/reports/xml" dest="twistreports" />
              <artifact src="target/reports/screenshots" dest="twistreports" />
              <artifact src="target/reports/recording" dest="recording" />
              <artifact src="target/cruise-agent-1.3.2/cruise-agent.log" />
              <artifact src="target/cruise-server-1.3.2/db/h2db" />
              <artifact src="target/cruise-server-1.3.2/config/cruise-config.xml" />
              <artifact src="target/cruise-server-1.3.2/cruise-server.log" />
              <test src="target/reports/xml" />
            </artifacts>
          </job>
          <job name="ie7-6">
            <tasks>
              <ant target="clean" />
              <fetchartifact pipeline="cruise-1.3.2" stage="dist-zip" job="linux-firefox" srcdir="target/cruise-server-1.3.2" dest="target" />
              <fetchartifact pipeline="cruise-1.3.2" stage="dist-zip" job="linux-firefox" srcdir="target/cruise-agent-1.3.2" dest="target" />
              <ant target="twist" />
            </tasks>
            <tabs>
              <tab name="twist" path="twistreports/html/index.html" />
            </tabs>
            <resources>
              <resource>windows</resource>
              <resource>java</resource>
            </resources>
            <artifacts>
              <artifact src="target/reports/html" dest="twistreports" />
              <artifact src="target/reports/xml" dest="twistreports" />
              <artifact src="target/reports/screenshots" dest="twistreports" />
              <artifact src="target/reports/recording" dest="recording" />
              <artifact src="target/cruise-agent-1.3.2/cruise-agent.log" />
              <artifact src="target/cruise-server-1.3.2/db/h2db" />
              <artifact src="target/cruise-server-1.3.2/config/cruise-config.xml" />
              <artifact src="target/cruise-server-1.3.2/cruise-server.log" />
              <test src="target/reports/xml" />
            </artifacts>
          </job>
        </jobs>
      </stage>
      <stage name="dist">
        <approval type="manual" />
        <jobs>
          <job name="linux-firefox">
            <tasks>
              <ant target="-Drun=all clean.systmpdir cruise.dist" />
            </tasks>
            <resources>
              <resource>debian</resource>
            </resources>
            <artifacts>
              <artifact src="target/pkg" />
            </artifacts>
          </job>
          <job name="dist-solaris">
            <tasks>
              <ant target="-Drun=all clean.ivy.localivy clean compile dist.sol" />
            </tasks>
            <resources>
              <resource>solaris</resource>
            </resources>
            <artifacts>
              <artifact src="target/pkg/cruise*.gz" dest="pkg" />
            </artifacts>
          </job>
        </jobs>
      </stage>
      <stage name="uat">
        <approval type="manual">
          <authorization>
            <user>lqiao</user>
          </authorization>
        </approval>
        <jobs>
          <job name="deploy">
            <resources>
              <resource>debian</resource>
            </resources>
          </job>
        </jobs>
      </stage>
      <stage name="production">
        <approval type="manual" />
        <jobs>
          <job name="deploy">
            <resources>
              <resource>linux</resource>
            </resources>
          </job>
        </jobs>
      </stage>
      <stage name="publish">
        <approval type="manual" />
        <jobs>
          <job name="deploy">
            <resources>
              <resource>linux</resource>
            </resources>
          </job>
        </jobs>
      </stage>
    </pipeline>
    <pipeline name="cruise-1.1" labeltemplate="1.3.1.${COUNT}">
      <trackingtool link="https://mingle.somewhere.com/projects/cruise/cards/${ID}" regex="#(\d+)" />
      <materials>
        <hg url="https://abc:def@fmtstdscm01.somewhere.com/cruise-1.3">
          <filter>
            <ignore pattern="helper/**/*.*" />
            <ignore pattern="spike/**/*.*" />
            <ignore pattern="QA/**/*.*" />
            <ignore pattern="**/*.css" />
            <ignore pattern="performance/ec2/**/*.*" />
            <ignore pattern="manual-testing/**/*.*" />
          </filter>
        </hg>
      </materials>
      <stage name="dev">
        <approval type="manual">
          <authorization>
            <role>admins</role>
          </authorization>
        </approval>
        <jobs>
          <job name="windows-1">
            <tasks>
              <ant target="-Drun=all clean.systmpdir clean.ivy.localivy clean checkstyle ut ft" />
              <ant target="output-agent-environment-information">
                <runif status="failed" />
              </ant>
            </tasks>
            <resources>
              <resource>windows</resource>
              <resource>dev</resource>
            </resources>
          </job>
          <job name="windows-2">
            <tasks>
              <ant target="-Drun=all clean.systmpdir clean.ivy.localivy clean checkstyle ut ft" />
            </tasks>
            <resources>
              <resource>windows</resource>
              <resource>dev</resource>
            </resources>
            <artifacts>
              <test src="target/reports" />
            </artifacts>
          </job>
          <job name="windows-3">
            <tasks>
              <ant target="-Drun=all clean.systmpdir clean.ivy.localivy clean checkstyle ut ft" />
            </tasks>
            <resources>
              <resource>windows</resource>
              <resource>dev</resource>
            </resources>
            <artifacts>
              <test src="target/reports" />
            </artifacts>
          </job>
          <job name="windows-4">
            <tasks>
              <ant target="-Drun=all clean.systmpdir clean.ivy.localivy clean checkstyle ut ft" />
            </tasks>
            <resources>
              <resource>windows</resource>
              <resource>dev</resource>
            </resources>
            <artifacts>
              <test src="target/reports" />
            </artifacts>
          </job>
          <job name="windows-5">
            <tasks>
              <ant target="-Drun=all clean.systmpdir clean.ivy.localivy clean checkstyle ut ft" />
            </tasks>
            <resources>
              <resource>windows</resource>
              <resource>dev</resource>
            </resources>
            <artifacts>
              <test src="target/reports" />
            </artifacts>
          </job>
          <job name="windows-6">
            <tasks>
              <ant target="-Drun=all clean.systmpdir clean.ivy.localivy clean checkstyle ut ft" />
            </tasks>
            <resources>
              <resource>windows</resource>
              <resource>dev</resource>
            </resources>
            <artifacts>
              <test src="target/reports" />
            </artifacts>
          </job>
          <job name="linux-firefox">
            <tasks>
              <ant target="-Drun=all  clean.systmpdir clean.ivy.localivy clean checkstyle ut ft" />
              <ant target="time" />
            </tasks>
            <tabs>
              <tab name="Console" path="cruise-output/console.log" />
              <tab name="Junit-time" path="reports/junit-time-report.html" />
            </tabs>
            <resources>
              <resource>linux</resource>
              <resource>dev</resource>
            </resources>
            <artifacts>
              <test src="target/reports" />
            </artifacts>
          </job>
          <job name="linux-firefox-2">
            <tasks>
              <ant target="-Drun=all  clean.systmpdir clean.ivy.localivy clean checkstyle ut ft" />
              <ant target="time" />
            </tasks>
            <tabs>
              <tab name="Console" path="cruise-output/console.log" />
              <tab name="Junit-time" path="reports/junit-time-report.html" />
            </tabs>
            <resources>
              <resource>linux</resource>
              <resource>dev</resource>
            </resources>
            <artifacts>
              <test src="target/reports" />
            </artifacts>
          </job>
          <job name="linux-firefox-3">
            <tasks>
              <ant target="-Drun=all  clean.systmpdir clean.ivy.localivy clean checkstyle ut ft" />
              <ant target="time" />
            </tasks>
            <tabs>
              <tab name="Console" path="cruise-output/console.log" />
              <tab name="Junit-time" path="reports/junit-time-report.html" />
            </tabs>
            <resources>
              <resource>linux</resource>
              <resource>dev</resource>
            </resources>
            <artifacts>
              <test src="target/reports" />
            </artifacts>
          </job>
          <job name="linux-firefox-4">
            <tasks>
              <ant target="-Drun=all  clean.systmpdir clean.ivy.localivy clean checkstyle ut ft" />
              <ant target="time" />
            </tasks>
            <tabs>
              <tab name="Console" path="cruise-output/console.log" />
              <tab name="Junit-time" path="reports/junit-time-report.html" />
            </tabs>
            <resources>
              <resource>linux</resource>
              <resource>dev</resource>
            </resources>
            <artifacts>
              <test src="target/reports" />
            </artifacts>
          </job>
          <job name="linux-firefox-5">
            <tasks>
              <ant target="-Drun=all  clean.systmpdir clean.ivy.localivy clean checkstyle ut ft" />
              <ant target="time" />
            </tasks>
            <tabs>
              <tab name="Console" path="cruise-output/console.log" />
              <tab name="Junit-time" path="reports/junit-time-report.html" />
            </tabs>
            <resources>
              <resource>linux</resource>
              <resource>dev</resource>
            </resources>
            <artifacts>
              <test src="target/reports" />
            </artifacts>
          </job>
          <job name="linux-firefox-6">
            <tasks>
              <ant target="-Drun=all  clean.systmpdir clean.ivy.localivy clean checkstyle ut ft" />
              <ant target="time" />
            </tasks>
            <tabs>
              <tab name="Console" path="cruise-output/console.log" />
              <tab name="Junit-time" path="reports/junit-time-report.html" />
            </tabs>
            <resources>
              <resource>linux</resource>
              <resource>dev</resource>
            </resources>
            <artifacts>
              <test src="target/reports" />
            </artifacts>
          </job>
          <job name="help">
            <tasks>
              <rake workingdir="helper" />
            </tasks>
            <tabs>
              <tab name="Documentation" path="output/build/index.html" />
            </tabs>
            <resources>
              <resource>run-help</resource>
            </resources>
            <artifacts>
              <artifact src="helper/build" dest="output" />
            </artifacts>
          </job>
          <job name="jsunit">
            <tasks>
              <ant target="-Drun=all clean.systmpdir clean.ivy.localivy clean jsunit" />
            </tasks>
            <resources>
              <resource>linux</resource>
              <resource>java</resource>
            </resources>
            <artifacts>
              <artifact src="server/jsunit/logs" />
            </artifacts>
          </job>
        </jobs>
      </stage>
      <stage name="dist-zip">
        <jobs>
          <job name="linux-firefox">
            <tasks>
              <ant target="-Drun=all clean.systmpdir -Dtest.skip=true clean.ivy.localivy clean uat-dist-zip dist.deb" />
            </tasks>
            <resources>
              <resource>java</resource>
              <resource>debian</resource>
            </resources>
            <artifacts>
              <artifact src="target/cruise-server-1.3.1" dest="target" />
              <artifact src="target/cruise-agent-1.3.1" dest="target" />
              <artifact src="target/pkg/**/*.*" dest="pkg" />
            </artifacts>
          </job>
        </jobs>
      </stage>
      <stage name="twist-tests">
        <jobs>
          <job name="analysis">
            <tasks>
              <ant target="-Drun=all dev">
                <oncancel>
                  <exec command="pkill" args="-f 'java.*ant.*-Drun=all dev'" />
                </oncancel>
              </ant>
              <exec command="ruby" args="spike/smell-counter/script/count_cruise_smells.rb target/smells.xml" />
            </tasks>
            <tabs>
              <tab name="Emma" path="analysis/emma/coverage.html" />
              <tab name="JDepend" path="analysis/jdepend/jdepend-report.html" />
              <tab name="ncss_util" path="analysis/javancss/javancss_metrics_util.html" />
              <tab name="ncss_common" path="analysis/javancss/javancss_metrics_common.html" />
              <tab name="ncss_agent" path="analysis/javancss/javancss_metrics_agent.html" />
              <tab name="ncss_server" path="analysis/javancss/javancss_metrics_server.html" />
            </tabs>
            <resources>
              <resource>analysis</resource>
            </resources>
            <artifacts>
              <artifact src="target/emma" dest="analysis" />
              <artifact src="target/jdepend" dest="analysis" />
              <artifact src="target/javancss" dest="analysis" />
              <artifact src="target/smells.xml" dest="smells" />
            </artifacts>
            <properties>
              <property name="coverage.class" src="target/emma/coverage.xml" xpath="substring-before(//report/data/all/coverage[starts-with(@type,'class')]/@value, '%')" />
              <property name="coverage.method" src="target/emma/coverage.xml" xpath="substring-before(//report/data/all/coverage[starts-with(@type,'method')]/@value, '%')" />
              <property name="coverage.block" src="target/emma/coverage.xml" xpath="substring-before(//report/data/all/coverage[starts-with(@type,'block')]/@value, '%')" />
              <property name="coverage.line" src="target/emma/coverage.xml" xpath="substring-before(//report/data/all/coverage[starts-with(@type,'line')]/@value, '%')" />
              <property name="smell.count" src="target/smells.xml" xpath="string(/smells/@count)" />
              <property name="ncss.agent.function.ncss" src="target/javancss/javancss_metrics_agent.xml" xpath="string(//function_averages/ncss)" />
              <property name="ncss.common.function.ncss" src="target/javancss/javancss_metrics_common.xml" xpath="string(//function_averages/ncss)" />
              <property name="ncss.server.function.ncss" src="target/javancss/javancss_metrics_server.xml" xpath="string(//function_averages/ncss)" />
              <property name="ncss.util.function.ncss" src="target/javancss/javancss_metrics_util.xml" xpath="string(//function_averages/ncss)" />
              <property name="ncss.agent.function.ccn" src="target/javancss/javancss_metrics_agent.xml" xpath="string(//function_averages/ccn)" />
              <property name="ncss.common.function.ccn" src="target/javancss/javancss_metrics_common.xml" xpath="string(//function_averages/ccn)" />
              <property name="ncss.server.function.ccn" src="target/javancss/javancss_metrics_server.xml" xpath="string(//function_averages/ccn)" />
              <property name="ncss.util.function.ccn" src="target/javancss/javancss_metrics_util.xml" xpath="string(//function_averages/ccn)" />
              <property name="ncss.agent.ncss" src="target/javancss/javancss_metrics_agent.xml" xpath="string(//functions/ncss)" />
              <property name="ncss.common.ncss" src="target/javancss/javancss_metrics_common.xml" xpath="string(//functions/ncss)" />
              <property name="ncss.server.ncss" src="target/javancss/javancss_metrics_server.xml" xpath="string(//functions/ncss)" />
              <property name="ncss.util.ncss" src="target/javancss/javancss_metrics_util.xml" xpath="string(//functions/ncss)" />
            </properties>
          </job>
          <job name="long-running">
            <tasks>
              <ant target="-Drun=all clean.systmpdir clean.ivy.localivy clean checkstyle ut.longrunning" />
              <ant target="time" />
            </tasks>
            <tabs>
              <tab name="Junit-time" path="reports/junit-time-report.html" />
            </tabs>
            <resources>
              <resource>long-run</resource>
            </resources>
            <artifacts>
              <test src="target/reports" />
            </artifacts>
          </job>
          <job name="twist-firefox">
            <tasks>
              <ant target="clean clean_4_twist" />
              <fetchartifact pipeline="cruise-1.1" stage="dist-zip" job="linux-firefox" srcdir="target/cruise-server-1.3.1" dest="target" />
              <fetchartifact pipeline="cruise-1.1" stage="dist-zip" job="linux-firefox" srcdir="target/cruise-agent-1.3.1" dest="target" />
              <exec command="chmod" args="+x target/cruise-server-1.3.1/server.sh" />
              <exec command="chmod" args="+x target/cruise-server-1.3.1/stop-server.sh" />
              <exec command="chmod" args="+x target/cruise-agent-1.3.1/agent.sh" />
              <exec command="chmod" args="+x target/cruise-agent-1.3.1/stop-agent.sh" />
              <ant target="twist">
                <oncancel>
                  <ant target="kill_twist" />
                </oncancel>
              </ant>
            </tasks>
            <tabs>
              <tab name="twist" path="twistreports/html/index.html" />
            </tabs>
            <resources>
              <resource>ubuntu</resource>
            </resources>
            <artifacts>
              <artifact src="target/reports/html" dest="twistreports" />
              <artifact src="target/reports/xml" dest="twistreports" />
              <artifact src="target/reports/screenshots" dest="twistreports" />
              <artifact src="target/reports/recording" dest="recording" />
              <artifact src="target/cruise-agent-1.3.1/cruise-agent.log" />
              <artifact src="target/cruise-server-1.3.1/config/cruise-config.xml" />
              <artifact src="target/cruise-server-1.3.1/cruise-server.log" />
              <test src="target/reports/xml" />
            </artifacts>
          </job>
          <job name="twist-firefox-2">
            <tasks>
              <ant target="clean clean_4_twist" />
              <fetchartifact pipeline="cruise-1.1" stage="dist-zip" job="linux-firefox" srcdir="target/cruise-server-1.3.1" dest="target" />
              <fetchartifact pipeline="cruise-1.1" stage="dist-zip" job="linux-firefox" srcdir="target/cruise-agent-1.3.1" dest="target" />
              <exec command="chmod" args="+x target/cruise-server-1.3.1/server.sh" />
              <exec command="chmod" args="+x target/cruise-server-1.3.1/stop-server.sh" />
              <exec command="chmod" args="+x target/cruise-agent-1.3.1/agent.sh" />
              <exec command="chmod" args="+x target/cruise-agent-1.3.1/stop-agent.sh" />
              <ant target="twist">
                <oncancel>
                  <ant target="kill_twist" />
                </oncancel>
              </ant>
            </tasks>
            <tabs>
              <tab name="twist" path="twistreports/html/index.html" />
            </tabs>
            <resources>
              <resource>ubuntu</resource>
            </resources>
            <artifacts>
              <artifact src="target/reports/html" dest="twistreports" />
              <artifact src="target/reports/xml" dest="twistreports" />
              <artifact src="target/reports/screenshots" dest="twistreports" />
              <artifact src="target/reports/recording" dest="recording" />
              <artifact src="target/cruise-agent-1.3.1/cruise-agent.log" />
              <artifact src="target/cruise-server-1.3.1/config/cruise-config.xml" />
              <artifact src="target/cruise-server-1.3.1/cruise-server.log" />
              <test src="target/reports/xml" />
            </artifacts>
          </job>
          <job name="twist-firefox-3">
            <tasks>
              <ant target="clean clean_4_twist" />
              <fetchartifact pipeline="cruise-1.1" stage="dist-zip" job="linux-firefox" srcdir="target/cruise-server-1.3.1" dest="target" />
              <fetchartifact pipeline="cruise-1.1" stage="dist-zip" job="linux-firefox" srcdir="target/cruise-agent-1.3.1" dest="target" />
              <exec command="chmod" args="+x target/cruise-server-1.3.1/server.sh" />
              <exec command="chmod" args="+x target/cruise-server-1.3.1/stop-server.sh" />
              <exec command="chmod" args="+x target/cruise-agent-1.3.1/agent.sh" />
              <exec command="chmod" args="+x target/cruise-agent-1.3.1/stop-agent.sh" />
              <ant target="twist">
                <oncancel>
                  <ant target="kill_twist" />
                </oncancel>
              </ant>
            </tasks>
            <tabs>
              <tab name="twist" path="twistreports/html/index.html" />
            </tabs>
            <resources>
              <resource>ubuntu</resource>
            </resources>
            <artifacts>
              <artifact src="target/reports/html" dest="twistreports" />
              <artifact src="target/reports/xml" dest="twistreports" />
              <artifact src="target/reports/screenshots" dest="twistreports" />
              <artifact src="target/reports/recording" dest="recording" />
              <artifact src="target/cruise-agent-1.3.1/cruise-agent.log" />
              <artifact src="target/cruise-server-1.3.1/config/cruise-config.xml" />
              <artifact src="target/cruise-server-1.3.1/cruise-server.log" />
              <test src="target/reports/xml" />
            </artifacts>
          </job>
          <job name="twist-firefox-4">
            <tasks>
              <ant target="clean clean_4_twist" />
              <fetchartifact pipeline="cruise-1.1" stage="dist-zip" job="linux-firefox" srcdir="target/cruise-server-1.3.1" dest="target" />
              <fetchartifact pipeline="cruise-1.1" stage="dist-zip" job="linux-firefox" srcdir="target/cruise-agent-1.3.1" dest="target" />
              <exec command="chmod" args="+x target/cruise-server-1.3.1/server.sh" />
              <exec command="chmod" args="+x target/cruise-server-1.3.1/stop-server.sh" />
              <exec command="chmod" args="+x target/cruise-agent-1.3.1/agent.sh" />
              <exec command="chmod" args="+x target/cruise-agent-1.3.1/stop-agent.sh" />
              <ant target="twist">
                <oncancel>
                  <ant target="kill_twist" />
                </oncancel>
              </ant>
            </tasks>
            <tabs>
              <tab name="twist" path="twistreports/html/index.html" />
              <tab name="Recording" path="recording/recording/twist-recording.html" />
            </tabs>
            <resources>
              <resource>ubuntu</resource>
            </resources>
            <artifacts>
              <artifact src="target/reports/html" dest="twistreports" />
              <artifact src="target/reports/xml" dest="twistreports" />
              <artifact src="target/reports/screenshots" dest="twistreports" />
              <artifact src="target/reports/recording" dest="recording" />
              <artifact src="target/cruise-agent-1.3.1/cruise-agent.log" />
              <artifact src="target/cruise-server-1.3.1/config/cruise-config.xml" />
              <artifact src="target/cruise-server-1.3.1/cruise-server.log" />
              <test src="target/reports/xml" />
            </artifacts>
          </job>
          <job name="twist-firefox-5">
            <tasks>
              <ant target="clean clean_4_twist" />
              <fetchartifact pipeline="cruise-1.1" stage="dist-zip" job="linux-firefox" srcdir="target/cruise-server-1.3.1" dest="target" />
              <fetchartifact pipeline="cruise-1.1" stage="dist-zip" job="linux-firefox" srcdir="target/cruise-agent-1.3.1" dest="target" />
              <exec command="chmod" args="+x target/cruise-server-1.3.1/server.sh" />
              <exec command="chmod" args="+x target/cruise-server-1.3.1/stop-server.sh" />
              <exec command="chmod" args="+x target/cruise-agent-1.3.1/agent.sh" />
              <exec command="chmod" args="+x target/cruise-agent-1.3.1/stop-agent.sh" />
              <ant target="twist">
                <oncancel>
                  <ant target="kill_twist" />
                </oncancel>
              </ant>
            </tasks>
            <tabs>
              <tab name="twist" path="twistreports/html/index.html" />
            </tabs>
            <resources>
              <resource>ubuntu</resource>
            </resources>
            <artifacts>
              <artifact src="target/reports/html" dest="twistreports" />
              <artifact src="target/reports/xml" dest="twistreports" />
              <artifact src="target/reports/screenshots" dest="twistreports" />
              <artifact src="target/reports/recording" dest="recording" />
              <artifact src="target/cruise-agent-1.3.1/cruise-agent.log" />
              <artifact src="target/cruise-server-1.3.1/config/cruise-config.xml" />
              <artifact src="target/cruise-server-1.3.1/cruise-server.log" />
              <test src="target/reports/xml" />
            </artifacts>
          </job>
          <job name="twist-firefox-6">
            <tasks>
              <ant target="clean clean_4_twist" />
              <fetchartifact pipeline="cruise-1.1" stage="dist-zip" job="linux-firefox" srcdir="target/cruise-server-1.3.1" dest="target" />
              <fetchartifact pipeline="cruise-1.1" stage="dist-zip" job="linux-firefox" srcdir="target/cruise-agent-1.3.1" dest="target" />
              <exec command="chmod" args="+x target/cruise-server-1.3.1/server.sh" />
              <exec command="chmod" args="+x target/cruise-server-1.3.1/stop-server.sh" />
              <exec command="chmod" args="+x target/cruise-agent-1.3.1/agent.sh" />
              <exec command="chmod" args="+x target/cruise-agent-1.3.1/stop-agent.sh" />
              <ant target="twist">
                <oncancel>
                  <ant target="kill_twist" />
                </oncancel>
              </ant>
            </tasks>
            <tabs>
              <tab name="twist" path="twistreports/html/index.html" />
            </tabs>
            <resources>
              <resource>ubuntu</resource>
            </resources>
            <artifacts>
              <artifact src="target/reports/html" dest="twistreports" />
              <artifact src="target/reports/xml" dest="twistreports" />
              <artifact src="target/reports/screenshots" dest="twistreports" />
              <artifact src="target/reports/recording" dest="recording" />
              <artifact src="target/cruise-agent-1.3.1/cruise-agent.log" />
              <artifact src="target/cruise-server-1.3.1/config/cruise-config.xml" />
              <artifact src="target/cruise-server-1.3.1/cruise-server.log" />
              <test src="target/reports/xml" />
            </artifacts>
          </job>
          <job name="ie7">
            <tasks>
              <ant target="clean" />
              <fetchartifact pipeline="cruise-1.1" stage="dist-zip" job="linux-firefox" srcdir="target/cruise-server-1.3.1" dest="target" />
              <fetchartifact pipeline="cruise-1.1" stage="dist-zip" job="linux-firefox" srcdir="target/cruise-agent-1.3.1" dest="target" />
              <ant target="twist" />
            </tasks>
            <tabs>
              <tab name="twist" path="twistreports/html/index.html" />
            </tabs>
            <resources>
              <resource>windows</resource>
              <resource>ie7</resource>
              <resource>java</resource>
            </resources>
            <artifacts>
              <artifact src="target/reports/html" dest="twistreports" />
              <artifact src="target/reports/xml" dest="twistreports" />
              <artifact src="target/reports/screenshots" dest="twistreports" />
              <artifact src="target/reports/recording" dest="recording" />
              <artifact src="target/cruise-agent-1.3.1/cruise-agent.log" />
              <artifact src="target/cruise-server-1.3.1/config/cruise-config.xml" />
              <artifact src="target/cruise-server-1.3.1/cruise-server.log" />
              <test src="target/reports/xml" />
            </artifacts>
          </job>
          <job name="ie7-2">
            <tasks>
              <ant target="clean" />
              <fetchartifact pipeline="cruise-1.1" stage="dist-zip" job="linux-firefox" srcdir="target/cruise-server-1.3.1" dest="target" />
              <fetchartifact pipeline="cruise-1.1" stage="dist-zip" job="linux-firefox" srcdir="target/cruise-agent-1.3.1" dest="target" />
              <ant target="twist" />
            </tasks>
            <tabs>
              <tab name="twist" path="twistreports/html/index.html" />
            </tabs>
            <resources>
              <resource>windows</resource>
              <resource>ie7</resource>
              <resource>java</resource>
            </resources>
            <artifacts>
              <artifact src="target/reports/html" dest="twistreports" />
              <artifact src="target/reports/xml" dest="twistreports" />
              <artifact src="target/reports/screenshots" dest="twistreports" />
              <artifact src="target/reports/recording" dest="recording" />
              <artifact src="target/cruise-agent-1.3.1/cruise-agent.log" />
              <artifact src="target/cruise-server-1.3.1/db/h2db" />
              <artifact src="target/cruise-server-1.3.1/config/cruise-config.xml" />
              <artifact src="target/cruise-server-1.3.1/cruise-server.log" />
              <test src="target/reports/xml" />
            </artifacts>
          </job>
          <job name="ie7-3">
            <tasks>
              <ant target="clean" />
              <fetchartifact pipeline="cruise-1.1" stage="dist-zip" job="linux-firefox" srcdir="target/cruise-server-1.3.1" dest="target" />
              <fetchartifact pipeline="cruise-1.1" stage="dist-zip" job="linux-firefox" srcdir="target/cruise-agent-1.3.1" dest="target" />
              <ant target="twist" />
            </tasks>
            <tabs>
              <tab name="twist" path="twistreports/html/index.html" />
            </tabs>
            <resources>
              <resource>windows</resource>
              <resource>ie7</resource>
              <resource>java</resource>
            </resources>
            <artifacts>
              <artifact src="target/reports/html" dest="twistreports" />
              <artifact src="target/reports/xml" dest="twistreports" />
              <artifact src="target/reports/screenshots" dest="twistreports" />
              <artifact src="target/reports/recording" dest="recording" />
              <artifact src="target/cruise-agent-1.3.1/cruise-agent.log" />
              <artifact src="target/cruise-server-1.3.1/db/h2db" />
              <artifact src="target/cruise-server-1.3.1/config/cruise-config.xml" />
              <artifact src="target/cruise-server-1.3.1/cruise-server.log" />
              <test src="target/reports/xml" />
            </artifacts>
          </job>
          <job name="ie7-4">
            <tasks>
              <ant target="clean" />
              <fetchartifact pipeline="cruise-1.1" stage="dist-zip" job="linux-firefox" srcdir="target/cruise-server-1.3.1" dest="target" />
              <fetchartifact pipeline="cruise-1.1" stage="dist-zip" job="linux-firefox" srcdir="target/cruise-agent-1.3.1" dest="target" />
              <ant target="twist" />
            </tasks>
            <tabs>
              <tab name="twist" path="twistreports/html/index.html" />
            </tabs>
            <resources>
              <resource>windows</resource>
              <resource>ie7</resource>
              <resource>java</resource>
            </resources>
            <artifacts>
              <artifact src="target/reports/html" dest="twistreports" />
              <artifact src="target/reports/xml" dest="twistreports" />
              <artifact src="target/reports/screenshots" dest="twistreports" />
              <artifact src="target/reports/recording" dest="recording" />
              <artifact src="target/cruise-agent-1.3.1/cruise-agent.log" />
              <artifact src="target/cruise-server-1.3.1/db/h2db" />
              <artifact src="target/cruise-server-1.3.1/config/cruise-config.xml" />
              <artifact src="target/cruise-server-1.3.1/cruise-server.log" />
              <test src="target/reports/xml" />
            </artifacts>
          </job>
          <job name="ie7-5">
            <tasks>
              <ant target="clean" />
              <fetchartifact pipeline="cruise-1.1" stage="dist-zip" job="linux-firefox" srcdir="target/cruise-server-1.3.1" dest="target" />
              <fetchartifact pipeline="cruise-1.1" stage="dist-zip" job="linux-firefox" srcdir="target/cruise-agent-1.3.1" dest="target" />
              <ant target="twist" />
            </tasks>
            <tabs>
              <tab name="twist" path="twistreports/html/index.html" />
            </tabs>
            <resources>
              <resource>windows</resource>
              <resource>ie7</resource>
              <resource>java</resource>
            </resources>
            <artifacts>
              <artifact src="target/reports/html" dest="twistreports" />
              <artifact src="target/reports/xml" dest="twistreports" />
              <artifact src="target/reports/screenshots" dest="twistreports" />
              <artifact src="target/reports/recording" dest="recording" />
              <artifact src="target/cruise-agent-1.3.1/cruise-agent.log" />
              <artifact src="target/cruise-server-1.3.1/db/h2db" />
              <artifact src="target/cruise-server-1.3.1/config/cruise-config.xml" />
              <artifact src="target/cruise-server-1.3.1/cruise-server.log" />
              <test src="target/reports/xml" />
            </artifacts>
          </job>
          <job name="ie7-6">
            <tasks>
              <ant target="clean" />
              <fetchartifact pipeline="cruise-1.1" stage="dist-zip" job="linux-firefox" srcdir="target/cruise-server-1.3.1" dest="target" />
              <fetchartifact pipeline="cruise-1.1" stage="dist-zip" job="linux-firefox" srcdir="target/cruise-agent-1.3.1" dest="target" />
              <ant target="twist" />
            </tasks>
            <tabs>
              <tab name="twist" path="twistreports/html/index.html" />
            </tabs>
            <resources>
              <resource>windows</resource>
              <resource>ie7</resource>
              <resource>java</resource>
            </resources>
            <artifacts>
              <artifact src="target/reports/html" dest="twistreports" />
              <artifact src="target/reports/xml" dest="twistreports" />
              <artifact src="target/reports/screenshots" dest="twistreports" />
              <artifact src="target/reports/recording" dest="recording" />
              <artifact src="target/cruise-agent-1.3.1/cruise-agent.log" />
              <artifact src="target/cruise-server-1.3.1/db/h2db" />
              <artifact src="target/cruise-server-1.3.1/config/cruise-config.xml" />
              <artifact src="target/cruise-server-1.3.1/cruise-server.log" />
              <test src="target/reports/xml" />
            </artifacts>
          </job>
        </jobs>
      </stage>
      <stage name="dist">
        <approval type="manual" />
        <jobs>
          <job name="linux-firefox">
            <tasks>
              <ant target="-Drun=all clean.systmpdir cruise.dist" />
            </tasks>
            <resources>
              <resource>debian</resource>
            </resources>
            <artifacts>
              <artifact src="target/pkg" />
            </artifacts>
          </job>
          <job name="dist-solaris">
            <tasks>
              <ant target="-Drun=all clean.ivy.localivy clean compile dist.sol" />
            </tasks>
            <resources>
              <resource>solaris</resource>
            </resources>
            <artifacts>
              <artifact src="target/pkg/cruise*.gz" dest="pkg" />
            </artifacts>
          </job>
        </jobs>
      </stage>
      <stage name="uat">
        <approval type="manual">
          <authorization>
            <user>lqiao</user>
          </authorization>
        </approval>
        <jobs>
          <job name="deploy">
            <resources>
              <resource>debian</resource>
            </resources>
          </job>
        </jobs>
      </stage>
      <stage name="production">
        <approval type="manual" />
        <jobs>
          <job name="deploy">
            <resources>
              <resource>linux</resource>
            </resources>
          </job>
        </jobs>
      </stage>
      <stage name="publish">
        <approval type="manual" />
        <jobs>
          <job name="deploy">
            <resources>
              <resource>linux</resource>
            </resources>
          </job>
        </jobs>
      </stage>
    </pipeline>
    <pipeline name="performance-tests" isLocked="true">
      <materials>
        <hg url="https://abc:def@fmtstdscm01.somewhere.com/cruise-performance">
          <filter>
            <ignore pattern="**/*.*" />
          </filter>
        </hg>
        <pipeline pipelineName="cruise" stageName="dist-zip" />
      </materials>
      <stage name="start-server">
        <approval type="manual" />
        <jobs>
          <job name="start-server">
            <tasks>
              <fetchartifact pipeline="cruise" stage="dist-zip" job="zip" srcdir="pkg" />
              <rake target="start_server" />
            </tasks>
            <resources>
              <resource>linux</resource>
              <resource>performance-server</resource>
            </resources>
          </job>
        </jobs>
      </stage>
      <stage name="run-tests">
        <jobs>
          <job name="httperf">
            <tasks>
              <rake target="performance_httperf" />
            </tasks>
            <resources>
              <resource>linux</resource>
              <resource>performance</resource>
            </resources>
          </job>
        </jobs>
      </stage>
    </pipeline>
    <pipeline name="performance-1.3.2">
      <trackingtool link="https://mingle.somewhere.com/trunk/projects/cruise/cards/${ID}" regex="#(\d+)" />
      <materials>
        <hg url="https://abc:def@fmtstdscm01.somewhere.com/cruise-performance">
          <filter>
            <ignore pattern="**/*.*" />
          </filter>
        </hg>
        <pipeline pipelineName="cruise-1.3.2" stageName="dist-zip" />
      </materials>
      <stage name="performance">
        <approval type="manual" />
        <jobs>
          <job name="performance">
            <tasks>
              <fetchartifact pipeline="cruise-1.3.2" stage="dist-zip" job="linux-firefox" srcfile="target/cruise-server-1.3.2/cruise.jar" dest="cruise-perf-13" />
              <fetchartifact pipeline="cruise-1.3.2" stage="dist-zip" job="linux-firefox" srcfile="target/cruise-agent-1.3.2/agent-bootstrapper.jar" dest="cruise-perf-13" />
              <exec command="/bin/bash" args="run_cruise.sh" />
            </tasks>
            <tabs>
              <tab name="performance" path="results/analysis.html" />
            </tabs>
            <resources>
              <resource>ec2</resource>
            </resources>
            <artifacts>
              <artifact src="results" />
            </artifacts>
          </job>
        </jobs>
      </stage>
    </pipeline>
    <pipeline name="performance">
      <trackingtool link="https://mingle.somewhere.com/trunk/projects/cruise/cards/${ID}" regex="#(\d+)" />
      <materials>
        <hg url="https://abc:def@fmtstdscm01.somewhere.com/cruise-performance">
          <filter>
            <ignore pattern="**/*.*" />
          </filter>
        </hg>
        <pipeline pipelineName="cruise" stageName="dist-zip" />
      </materials>
      <stage name="performance">
        <approval type="manual" />
        <jobs>
          <job name="performance">
            <tasks>
              <fetchartifact pipeline="cruise" stage="dist-zip" job="zip" srcdir="pkg" />
              <exec command="unzip" args="pkg/*.zip -d pkg/" />
              <exec command="cp" args="pkg/cruise-server-1.3.2/cruise.jar cruise-perf-13" />
              <exec command="cp" args="pkg/cruise-agent-1.3.2/agent-bootstrapper.jar cruise-perf-13" />
              <exec command="/bin/bash" args="run_cruise.sh" />
            </tasks>
            <tabs>
              <tab name="performance" path="results/analysis.html" />
            </tabs>
            <resources>
              <resource>ec2</resource>
            </resources>
            <artifacts>
              <artifact src="results" />
            </artifacts>
          </job>
        </jobs>
      </stage>
    </pipeline>
    <pipeline name="old-analysis" labeltemplate="1.3.2.${COUNT}-${TRUNK}">
      <trackingtool link="https://mingle.somewhere.com/projects/cruise/cards/${ID}" regex="#(\d+)" />
      <materials>
        <hg url="hg://disabled-for-now-so-it-does-not-check-out-full-repo-onto-disk-space-starved-agents" autoUpdate="false" materialName="trunk" />
      </materials>
      <stage name="analysis">
        <approval type="manual" />
        <jobs>
          <job name="analysis">
            <tasks>
              <ant target="-Drun=all dev">
                <oncancel>
                  <exec command="pkill" args="-f 'java.*ant.*-Drun=all dev'" />
                </oncancel>
              </ant>
              <exec command="ruby" args="spike/smell-counter/script/count_cruise_smells.rb target/smells.xml" />
            </tasks>
            <tabs>
              <tab name="Emma" path="analysis/emma/coverage.html" />
              <tab name="JDepend" path="analysis/jdepend/jdepend-report.html" />
              <tab name="ncss_util" path="analysis/javancss/javancss_metrics_util.html" />
              <tab name="ncss_common" path="analysis/javancss/javancss_metrics_common.html" />
              <tab name="ncss_agent" path="analysis/javancss/javancss_metrics_agent.html" />
              <tab name="ncss_server" path="analysis/javancss/javancss_metrics_server.html" />
            </tabs>
            <resources>
              <resource>linux</resource>
            </resources>
            <artifacts>
              <artifact src="target/emma" dest="analysis" />
              <artifact src="target/jdepend" dest="analysis" />
              <artifact src="target/javancss" dest="analysis" />
              <artifact src="target/smells.xml" dest="smells" />
            </artifacts>
            <properties>
              <property name="coverage.class" src="target/emma/coverage.xml" xpath="substring-before(//report/data/all/coverage[starts-with(@type,'class')]/@value, '%')" />
              <property name="coverage.method" src="target/emma/coverage.xml" xpath="substring-before(//report/data/all/coverage[starts-with(@type,'method')]/@value, '%')" />
              <property name="coverage.block" src="target/emma/coverage.xml" xpath="substring-before(//report/data/all/coverage[starts-with(@type,'block')]/@value, '%')" />
              <property name="coverage.line" src="target/emma/coverage.xml" xpath="substring-before(//report/data/all/coverage[starts-with(@type,'line')]/@value, '%')" />
              <property name="smell.count" src="target/smells.xml" xpath="string(/smells/@count)" />
              <property name="ncss.agent.function.ncss" src="target/javancss/javancss_metrics_agent.xml" xpath="string(//function_averages/ncss)" />
              <property name="ncss.common.function.ncss" src="target/javancss/javancss_metrics_common.xml" xpath="string(//function_averages/ncss)" />
              <property name="ncss.server.function.ncss" src="target/javancss/javancss_metrics_server.xml" xpath="string(//function_averages/ncss)" />
              <property name="ncss.util.function.ncss" src="target/javancss/javancss_metrics_util.xml" xpath="string(//function_averages/ncss)" />
              <property name="ncss.agent.function.ccn" src="target/javancss/javancss_metrics_agent.xml" xpath="string(//function_averages/ccn)" />
              <property name="ncss.common.function.ccn" src="target/javancss/javancss_metrics_common.xml" xpath="string(//function_averages/ccn)" />
              <property name="ncss.server.function.ccn" src="target/javancss/javancss_metrics_server.xml" xpath="string(//function_averages/ccn)" />
              <property name="ncss.util.function.ccn" src="target/javancss/javancss_metrics_util.xml" xpath="string(//function_averages/ccn)" />
              <property name="ncss.agent.ncss" src="target/javancss/javancss_metrics_agent.xml" xpath="string(//functions/ncss)" />
              <property name="ncss.common.ncss" src="target/javancss/javancss_metrics_common.xml" xpath="string(//functions/ncss)" />
              <property name="ncss.server.ncss" src="target/javancss/javancss_metrics_server.xml" xpath="string(//functions/ncss)" />
              <property name="ncss.util.ncss" src="target/javancss/javancss_metrics_util.xml" xpath="string(//functions/ncss)" />
            </properties>
          </job>
        </jobs>
      </stage>
    </pipeline>
  </pipelines>
  <pipelines group="Shine">
    <pipeline name="Shine">
      <materials>
        <hg url="https://shine_builder:16c3A3q2X@fmtstdscm01.somewhere.com/shine" />
      </materials>
      <stage name="build">
        <jobs>
          <job name="compile-test">
            <tasks>
              <exec command="jrake" args="ci:build" />
            </tasks>
            <resources>
              <resource>shine</resource>
            </resources>
            <artifacts>
              <test src="backend/target/metrics/xml/junit" dest="backend" />
              <test src="test-utils/target/metrics/xml/junit" dest="test-utils" />
              <artifact src="backend/target/dist/shine-backend.jar" dest="backend/dist/" />
              <artifact src="utils/target/dist/shine-utils.jar" dest="utils/dist/" />
              <artifact src="test-utils/target/dist/shine-test-utils.jar" dest="test-utils/dist/" />
            </artifacts>
          </job>
        </jobs>
      </stage>
      <stage name="twist">
        <jobs>
          <job name="twist">
            <tasks>
              <exec command="jrake" args="clean dashboard:kill tdb:clear" />
              <fetchartifact pipeline="Shine" stage="build" job="compile-test" srcfile="backend/dist/shine-backend.jar" dest="backend/target/dist" />
              <fetchartifact pipeline="Shine" stage="build" job="compile-test" srcfile="utils/dist/shine-utils.jar" dest="utils/target/dist" />
              <fetchartifact pipeline="Shine" stage="build" job="compile-test" srcfile="test-utils/dist/shine-test-utils.jar" dest="test-utils/target/dist" />
              <exec command="jrake" args="dashboard:start_in_background">
                <oncancel>
                  <exec command="jrake" args="dashboard:kill" />
                </oncancel>
              </exec>
              <exec command="jrake" args="twist:test" />
              <exec command="jrake">
                <arg value="dashboard:kill" />
                <runif status="any" />
              </exec>
            </tasks>
            <tabs>
              <tab name="twist" path="twist/reports/html/index.html" />
            </tabs>
            <resources>
              <resource>shine</resource>
            </resources>
            <artifacts>
              <test src="twist/target/reports/xml" dest="twist/reports" />
              <artifact src="twist/target/reports/html" dest="twist/reports" />
            </artifacts>
          </job>
        </jobs>
      </stage>
      <stage name="dist">
        <jobs>
          <job name="tarballs">
            <tasks>
              <exec command="jrake" args="clean" />
              <fetchartifact pipeline="Shine" stage="build" job="compile-test" srcfile="backend/dist/shine-backend.jar" dest="backend/target/dist" />
              <fetchartifact pipeline="Shine" stage="build" job="compile-test" srcfile="utils/dist/shine-utils.jar" dest="utils/target/dist" />
              <fetchartifact pipeline="Shine" stage="build" job="compile-test" srcfile="test-utils/dist/shine-test-utils.jar" dest="test-utils/target/dist" />
              <exec command="jrake" args="ci:dist" />
            </tasks>
            <resources>
              <resource>shine</resource>
            </resources>
            <artifacts>
              <artifact src="target/shine-cruise" />
            </artifacts>
          </job>
        </jobs>
      </stage>
      <stage name="metrics">
        <jobs>
          <job name="reports">
            <tasks>
              <exec command="jrake" args="clean ci:metrics" />
            </tasks>
            <tabs>
              <tab name="be-emma" path="backend/emma/emma-coverage.html" />
              <tab name="ccn-treemap" path="backend/svg/interactive-complexity-treemap.svg" />
              <tab name="cov-treemap" path="backend/svg/interactive-coverage-treemap.svg" />
            </tabs>
            <resources>
              <resource>shine</resource>
            </resources>
            <artifacts>
              <artifact src="backend/target/metrics/html/emma" dest="backend" />
              <artifact src="backend/target/metrics/svg" dest="backend" />
            </artifacts>
          </job>
        </jobs>
      </stage>
    </pipeline>
  </pipelines>
  <pipelines group="AutoDeployBuilds">
    <pipeline name="PBS-SFO" labeltemplate="1.3.2.${cruise_pipeline}">
      <timer>59 59 23 ? * *</timer>
      <materials>
        <hg url="https://abc:def@fmtstdscm01.somewhere.com/cruise_qa" />
        <pipeline pipelineName="cruise" stageName="dist-buildr" materialName="cruise_pipeline" />
      </materials>
      <stage name="DeployNewBuild">
        <jobs>
          <job name="Deploy" runOnAllAgents="true">
            <environmentvariables>
              <variable name="USER_ID">cruise</variable>
              <variable name="PASSWORD">go.pass</variable>
            </environmentvariables>
            <tasks>
              <exec command="/bin/bash" args="-c &quot; rm -f target/pkg/* &quot;" />
              <fetchartifact pipeline="cruise" stage="dist-buildr" job="debian" srcdir="pkg" dest="target" />
              <ant buildfile="auto-deploy-testing/auto_deploy_on_qabox.xml" target="deploy.new.server" />
            </tasks>
            <resources>
              <resource>pbs-sfo</resource>
            </resources>
          </job>
        </jobs>
      </stage>
    </pipeline>
    <pipeline name="auto-deploy-testing-ubuntu" labeltemplate="1.3.2.${cruise_pipeline}" isLocked="false">
      <trackingtool link="https://mingle.somewhere.com/projects/cruise/cards/${ID}" regex="#(\d+)" />
      <materials>
        <hg url="https://abc:def@fmtstdscm01.somewhere.com/cruise_qa" />
        <pipeline pipelineName="cruise" stageName="dist-buildr" materialName="cruise_pipeline" />
      </materials>
      <stage name="auto-upgrade">
        <approval type="manual" />
        <jobs>
          <job name="upgrade.from.1.3.2.to.latest.on.ubuntu">
            <environmentvariables>
              <variable name="MACHINE_IP">10.18.3.5</variable>
              <variable name="PASSWORD">go.pass</variable>
            </environmentvariables>
            <tasks>
              <exec command="/bin/bash" args="-c &quot; rm -f target/pkg/* &quot;" />
              <fetchartifact pipeline="cruise" stage="dist-buildr" job="debian" srcdir="pkg" dest="target" />
              <ant buildfile="auto-deploy-testing/auto_upgrade_on_ubuntu.xml" target="upgrade.cruise -Dfrom.version='1.3.2'" />
            </tasks>
            <resources>
              <resource>ubuntu</resource>
            </resources>
            <artifacts>
              <artifact src="auto-deploy-testing/*.txt" />
              <test src="auto-deploy-testing/target/reports/xml" />
            </artifacts>
          </job>
          <job name="upgrade.from.1.3.1.to.latest.on.ubuntu">
            <environmentvariables>
              <variable name="MACHINE_IP">10.18.3.5</variable>
              <variable name="PASSWORD">go.pass</variable>
            </environmentvariables>
            <tasks>
              <exec command="/bin/bash" args="-c &quot; rm -f target/pkg/* &quot;" />
              <fetchartifact pipeline="cruise" stage="dist-buildr" job="debian" srcdir="pkg" dest="target" />
              <ant buildfile="auto-deploy-testing/auto_upgrade_on_ubuntu.xml" target="upgrade.cruise -Dfrom.version='1.3.1'" />
            </tasks>
            <resources>
              <resource>ubuntu</resource>
            </resources>
            <artifacts>
              <artifact src="auto-deploy-testing/*.txt" />
              <test src="auto-deploy-testing/target/reports/xml" />
            </artifacts>
          </job>
          <job name="upgrade.from.1.3.0.to.latest.on.ubuntu">
            <environmentvariables>
              <variable name="MACHINE_IP">10.18.3.5</variable>
              <variable name="PASSWORD">go.pass</variable>
            </environmentvariables>
            <tasks>
              <exec command="/bin/bash" args="-c &quot; rm -f target/pkg/* &quot;" />
              <fetchartifact pipeline="cruise" stage="dist-buildr" job="debian" srcdir="pkg" dest="target" />
              <ant buildfile="auto-deploy-testing/auto_upgrade_on_ubuntu.xml" target="upgrade.cruise -Dfrom.version='1.3.0'" />
            </tasks>
            <resources>
              <resource>ubuntu</resource>
            </resources>
            <artifacts>
              <artifact src="auto-deploy-testing/*.txt" />
              <test src="auto-deploy-testing/target/reports/xml" />
            </artifacts>
          </job>
          <job name="upgrade.from.1.2.1.to.latest.on.ubuntu">
            <environmentvariables>
              <variable name="MACHINE_IP">10.18.3.5</variable>
              <variable name="PASSWORD">go.pass</variable>
            </environmentvariables>
            <tasks>
              <exec command="/bin/bash" args="-c &quot; rm -f target/pkg/* &quot;" />
              <fetchartifact pipeline="cruise" stage="dist-buildr" job="debian" srcdir="pkg" dest="target" />
              <ant buildfile="auto-deploy-testing/auto_upgrade_on_ubuntu.xml" target="upgrade.cruise -Dfrom.version='1.2.1'" />
            </tasks>
            <resources>
              <resource>ubuntu</resource>
            </resources>
            <artifacts>
              <artifact src="auto-deploy-testing/*.txt" />
              <test src="auto-deploy-testing/target/reports/xml" />
            </artifacts>
          </job>
          <job name="upgrade.from.1.2.0.to.latest.on.ubuntu">
            <environmentvariables>
              <variable name="MACHINE_IP">10.18.3.5</variable>
              <variable name="PASSWORD">go.pass</variable>
            </environmentvariables>
            <tasks>
              <exec command="/bin/bash" args="-c &quot; rm -f target/pkg/* &quot;" />
              <fetchartifact pipeline="cruise" stage="dist-buildr" job="debian" srcdir="pkg" dest="target" />
              <ant buildfile="auto-deploy-testing/auto_upgrade_on_ubuntu.xml" target="upgrade.cruise -Dfrom.version='1.2.0'" />
            </tasks>
            <resources>
              <resource>ubuntu</resource>
            </resources>
            <artifacts>
              <artifact src="auto-deploy-testing/*.txt" />
              <test src="auto-deploy-testing/target/reports/xml" />
            </artifacts>
          </job>
        </jobs>
      </stage>
      <stage name="fresh-install">
        <jobs>
          <job name="fresh.install.cruise.on.ubuntu">
            <environmentvariables>
              <variable name="MACHINE_IP">10.18.3.5</variable>
              <variable name="PASSWORD">go.pass</variable>
            </environmentvariables>
            <tasks>
              <exec command="/bin/bash" args="-c &quot; rm -f target/pkg/* &quot;" />
              <fetchartifact pipeline="cruise" stage="dist-buildr" job="debian" srcdir="pkg" dest="target" />
              <ant buildfile="auto-deploy-testing/auto_deploy_on_ubuntu.xml" target="install.cruise" />
            </tasks>
            <resources>
              <resource>ubuntu</resource>
            </resources>
            <artifacts>
              <artifact src="auto-deploy-testing/*.txt" />
              <test src="auto-deploy-testing/target/reports/xml" />
            </artifacts>
          </job>
        </jobs>
      </stage>
    </pipeline>
    <pipeline name="auto-deploy-testing-other-os" labeltemplate="1.3.2.${cruise_pipeline}" isLocked="false">
      <trackingtool link="https://mingle.somewhere.com/projects/cruise/cards/${ID}" regex="#(\d+)" />
      <materials>
        <hg url="https://abc:def@fmtstdscm01.somewhere.com/cruise_qa" />
        <pipeline pipelineName="cruise" stageName="dist" materialName="cruise_pipeline" />
      </materials>
      <stage name="auto-upgrade">
        <approval type="manual" />
        <jobs>
          <job name="upgrade.from.1.3.2.to.latest.on.suse10">
            <environmentvariables>
              <variable name="MACHINE_IP">10.18.3.196</variable>
              <variable name="PASSWORD">go.pass</variable>
            </environmentvariables>
            <tasks>
              <exec command="/bin/bash" args="-c &quot; rm -f target/pkg/* &quot;" />
              <fetchartifact pipeline="cruise" stage="dist" job="linux-firefox" srcdir="pkg" dest="target" />
              <fetchartifact pipeline="cruise" stage="dist" job="dist-solaris" srcdir="pkg" dest="target" />
              <ant buildfile="auto-deploy-testing/auto_upgrade_on_SUSE.xml" target="upgrade.cruise -Dfrom.version='1.3.2'" />
            </tasks>
            <resources>
              <resource>suse</resource>
            </resources>
            <artifacts>
              <artifact src="auto-deploy-testing/*.txt" />
              <test src="auto-deploy-testing/target/reports/xml" />
            </artifacts>
          </job>
          <job name="upgrade.from.1.3.1.to.latest.on.suse10">
            <environmentvariables>
              <variable name="MACHINE_IP">10.18.3.196</variable>
              <variable name="PASSWORD">go.pass</variable>
            </environmentvariables>
            <tasks>
              <exec command="/bin/bash" args="-c &quot; rm -f target/pkg/* &quot;" />
              <fetchartifact pipeline="cruise" stage="dist" job="linux-firefox" srcdir="pkg" dest="target" />
              <fetchartifact pipeline="cruise" stage="dist" job="dist-solaris" srcdir="pkg" dest="target" />
              <ant buildfile="auto-deploy-testing/auto_upgrade_on_SUSE.xml" target="upgrade.cruise -Dfrom.version='1.3.1'" />
            </tasks>
            <resources>
              <resource>suse</resource>
            </resources>
            <artifacts>
              <artifact src="auto-deploy-testing/*.txt" />
              <test src="auto-deploy-testing/target/reports/xml" />
            </artifacts>
          </job>
          <job name="upgrade.from.1.3.0.to.latest.on.suse10">
            <environmentvariables>
              <variable name="MACHINE_IP">10.18.3.196</variable>
              <variable name="PASSWORD">go.pass</variable>
            </environmentvariables>
            <tasks>
              <exec command="/bin/bash" args="-c &quot; rm -f target/pkg/* &quot;" />
              <fetchartifact pipeline="cruise" stage="dist" job="linux-firefox" srcdir="pkg" dest="target" />
              <fetchartifact pipeline="cruise" stage="dist" job="dist-solaris" srcdir="pkg" dest="target" />
              <ant buildfile="auto-deploy-testing/auto_upgrade_on_SUSE.xml" target="upgrade.cruise -Dfrom.version='1.3.0'" />
            </tasks>
            <resources>
              <resource>suse</resource>
            </resources>
            <artifacts>
              <artifact src="auto-deploy-testing/*.txt" />
              <test src="auto-deploy-testing/target/reports/xml" />
            </artifacts>
          </job>
          <job name="upgrade.from.1.3.2.to.latest.on.rhel5">
            <environmentvariables>
              <variable name="USER_ID">cruise_builder</variable>
              <variable name="MACHINE_IP">10.18.7.153</variable>
              <variable name="PASSWORD">VJamxt6z</variable>
            </environmentvariables>
            <tasks>
              <exec command="/bin/bash" args="-c &quot; rm -f target/pkg/* &quot;" />
              <fetchartifact pipeline="cruise" stage="dist" job="linux-firefox" srcdir="pkg" dest="target" />
              <fetchartifact pipeline="cruise" stage="dist" job="dist-solaris" srcdir="pkg" dest="target" />
              <ant buildfile="auto-deploy-testing/auto_upgrade_on_redhat.xml" target="upgrade.cruise -Dfrom.version='1.3.2'" />
            </tasks>
            <resources>
              <resource>redhat</resource>
            </resources>
            <artifacts>
              <artifact src="auto-deploy-testing/*.txt" />
              <test src="auto-deploy-testing/target/reports/xml" />
            </artifacts>
          </job>
          <job name="upgrade.from.1.3.1.to.latest.on.rhel5">
            <environmentvariables>
              <variable name="USER_ID">cruise_builder</variable>
              <variable name="MACHINE_IP">10.18.7.153</variable>
              <variable name="PASSWORD">VJamxt6z</variable>
            </environmentvariables>
            <tasks>
              <exec command="/bin/bash" args="-c &quot; rm -f target/pkg/* &quot;" />
              <fetchartifact pipeline="cruise" stage="dist" job="linux-firefox" srcdir="pkg" dest="target" />
              <fetchartifact pipeline="cruise" stage="dist" job="dist-solaris" srcdir="pkg" dest="target" />
              <ant buildfile="auto-deploy-testing/auto_upgrade_on_redhat.xml" target="upgrade.cruise -Dfrom.version='1.3.1'" />
            </tasks>
            <resources>
              <resource>redhat</resource>
            </resources>
            <artifacts>
              <artifact src="auto-deploy-testing/*.txt" />
              <test src="auto-deploy-testing/target/reports/xml" />
            </artifacts>
          </job>
          <job name="upgrade.from.1.3.0.to.latest.on.rhel5">
            <environmentvariables>
              <variable name="USER_ID">cruise_builder</variable>
              <variable name="MACHINE_IP">10.18.7.153</variable>
              <variable name="PASSWORD">VJamxt6z</variable>
            </environmentvariables>
            <tasks>
              <exec command="/bin/bash" args="-c &quot; rm -f target/pkg/* &quot;" />
              <fetchartifact pipeline="cruise" stage="dist" job="linux-firefox" srcdir="pkg" dest="target" />
              <fetchartifact pipeline="cruise" stage="dist" job="dist-solaris" srcdir="pkg" dest="target" />
              <ant buildfile="auto-deploy-testing/auto_upgrade_on_redhat.xml" target="upgrade.cruise -Dfrom.version='1.3.0'" />
            </tasks>
            <resources>
              <resource>redhat</resource>
            </resources>
            <artifacts>
              <artifact src="auto-deploy-testing/*.txt" />
              <test src="auto-deploy-testing/target/reports/xml" />
            </artifacts>
          </job>
          <job name="upgrade.from.1.2.1.to.latest.on.rhel5">
            <environmentvariables>
              <variable name="USER_ID">cruise_builder</variable>
              <variable name="MACHINE_IP">10.18.7.153</variable>
              <variable name="PASSWORD">VJamxt6z</variable>
            </environmentvariables>
            <tasks>
              <exec command="/bin/bash" args="-c &quot; rm -f target/pkg/* &quot;" />
              <fetchartifact pipeline="cruise" stage="dist" job="linux-firefox" srcdir="pkg" dest="target" />
              <fetchartifact pipeline="cruise" stage="dist" job="dist-solaris" srcdir="pkg" dest="target" />
              <ant buildfile="auto-deploy-testing/auto_upgrade_on_redhat.xml" target="upgrade.cruise -Dfrom.version='1.2.1'" />
            </tasks>
            <resources>
              <resource>redhat</resource>
            </resources>
            <artifacts>
              <artifact src="auto-deploy-testing/*.txt" />
              <test src="auto-deploy-testing/target/reports/xml" />
            </artifacts>
          </job>
          <job name="upgrade.from.1.2.0.to.latest.on.rhel5">
            <environmentvariables>
              <variable name="USER_ID">cruise_builder</variable>
              <variable name="MACHINE_IP">10.18.7.153</variable>
              <variable name="PASSWORD">VJamxt6z</variable>
            </environmentvariables>
            <tasks>
              <exec command="/bin/bash" args="-c &quot; rm -f target/pkg/* &quot;" />
              <fetchartifact pipeline="cruise" stage="dist" job="linux-firefox" srcdir="pkg" dest="target" />
              <fetchartifact pipeline="cruise" stage="dist" job="dist-solaris" srcdir="pkg" dest="target" />
              <ant buildfile="auto-deploy-testing/auto_upgrade_on_redhat.xml" target="upgrade.cruise -Dfrom.version='1.2.0'" />
            </tasks>
            <resources>
              <resource>redhat</resource>
            </resources>
            <artifacts>
              <artifact src="auto-deploy-testing/*.txt" />
              <test src="auto-deploy-testing/target/reports/xml" />
            </artifacts>
          </job>
        </jobs>
      </stage>
      <stage name="fresh-install">
        <jobs>
          <job name="fresh.install.cruise.on.rhel5">
            <environmentvariables>
              <variable name="USER_ID">cruise_builder</variable>
              <variable name="MACHINE_IP">10.18.7.153</variable>
              <variable name="PASSWORD">VJamxt6z</variable>
            </environmentvariables>
            <tasks>
              <exec command="/bin/bash" args="-c &quot; rm -f target/pkg/* &quot;" />
              <fetchartifact pipeline="cruise" stage="dist" job="linux-firefox" srcdir="pkg" dest="target" />
              <fetchartifact pipeline="cruise" stage="dist" job="dist-solaris" srcdir="pkg" dest="target" />
              <ant buildfile="auto-deploy-testing/auto_deploy_on_redhat.xml" target="install.cruise " />
            </tasks>
            <resources>
              <resource>redhat</resource>
            </resources>
            <artifacts>
              <artifact src="auto-deploy-testing/*.txt" />
              <test src="auto-deploy-testing/target/reports/xml" />
            </artifacts>
          </job>
          <job name="fresh.install.cruise.on.suse10">
            <environmentvariables>
              <variable name="MACHINE_IP">10.18.3.196</variable>
              <variable name="PASSWORD">go.pass</variable>
            </environmentvariables>
            <tasks>
              <exec command="/bin/bash" args="-c &quot; rm -f target/pkg/* &quot;" />
              <fetchartifact pipeline="cruise" stage="dist" job="linux-firefox" srcdir="pkg" dest="target" />
              <fetchartifact pipeline="cruise" stage="dist" job="dist-solaris" srcdir="pkg" dest="target" />
              <ant buildfile="auto-deploy-testing/auto_deploy_on_SUSE.xml" target="install.cruise" />
            </tasks>
            <resources>
              <resource>suse</resource>
            </resources>
            <artifacts>
              <artifact src="auto-deploy-testing/*.txt" />
              <test src="auto-deploy-testing/target/reports/xml" />
            </artifacts>
          </job>
          <job name="fresh.install.cruise.on.solaris10">
            <environmentvariables>
              <variable name="MACHINE_IP">10.18.3.198</variable>
              <variable name="PASSWORD">go.pass</variable>
            </environmentvariables>
            <tasks>
              <exec command="/bin/bash" args="-c &quot; rm -f target/pkg/* &quot;" />
              <fetchartifact pipeline="cruise" stage="dist" job="linux-firefox" srcdir="pkg" dest="target" />
              <fetchartifact pipeline="cruise" stage="dist" job="dist-solaris" srcdir="pkg" dest="target" />
              <ant buildfile="auto-deploy-testing/auto_deploy_on_solaris.xml" target="install.cruise" />
            </tasks>
            <resources>
              <resource>solaris</resource>
            </resources>
            <artifacts>
              <artifact src="auto-deploy-testing/*.txt" />
              <test src="auto-deploy-testing/target/reports/xml" />
            </artifacts>
          </job>
        </jobs>
      </stage>
    </pipeline>
    <pipeline name="auto-deploy-testing-ubuntu8.10" labeltemplate="1.3.2.${cruise_pipeline}" isLocked="false">
      <timer>59 59 13 ? * *</timer>
      <materials>
        <hg url="https://abc:def@fmtstdscm01.somewhere.com/cruise_qa" />
        <pipeline pipelineName="cruise" stageName="dist-buildr" materialName="cruise_pipeline" />
      </materials>
      <stage name="fresh-install">
        <jobs>
          <job name="fresh.install.cruise">
            <environmentvariables>
              <variable name="USER_ID">cruise_builder</variable>
              <variable name="PASSWORD">VJamxt6z</variable>
            </environmentvariables>
            <tasks>
              <exec command="/bin/bash" args="-c &quot; rm -f target/pkg/* &quot;" />
              <fetchartifact pipeline="cruise" stage="dist-buildr" job="debian" srcdir="pkg" dest="target" />
              <ant buildfile="auto-deploy-testing/auto_deploy_on_ubuntu.xml" target="install.cruise" />
            </tasks>
            <resources>
              <resource>autodeploy</resource>
              <resource>ubuntu8.10</resource>
            </resources>
            <artifacts>
              <artifact src="auto-deploy-testing/*.txt" />
              <artifact src="/var/log/cruise-server/cruise-server.log" />
              <artifact src="/var/log/cruise-agent/cruise-agent.log" />
              <test src="auto-deploy-testing/target/reports/xml" />
            </artifacts>
          </job>
        </jobs>
      </stage>
      <stage name="auto-upgrade">
        <jobs>
          <job name="upgrade.from.1.3.2.to.latest">
            <environmentvariables>
              <variable name="USER_ID">cruise_builder</variable>
              <variable name="PASSWORD">VJamxt6z</variable>
            </environmentvariables>
            <tasks>
              <exec command="/bin/bash" args="-c &quot; rm -f target/pkg/* &quot;" />
              <fetchartifact pipeline="cruise" stage="dist-buildr" job="debian" srcdir="pkg" dest="target" />
              <ant buildfile="auto-deploy-testing/auto_upgrade_on_ubuntu.xml" target="upgrade.cruise -Dfrom.version='1.3.2'" />
            </tasks>
            <resources>
              <resource>autodeploy</resource>
              <resource>ubuntu8.10</resource>
            </resources>
            <artifacts>
              <artifact src="auto-deploy-testing/*.txt" />
              <artifact src="/var/log/cruise-server/cruise-server.log" />
              <artifact src="/var/log/cruise-agent/cruise-agent.log" />
              <test src="auto-deploy-testing/target/reports/xml" />
            </artifacts>
          </job>
          <job name="upgrade.from.1.3.1.to.latest">
            <environmentvariables>
              <variable name="USER_ID">cruise_builder</variable>
              <variable name="PASSWORD">VJamxt6z</variable>
            </environmentvariables>
            <tasks>
              <exec command="/bin/bash" args="-c &quot; rm -f target/pkg/* &quot;" />
              <fetchartifact pipeline="cruise" stage="dist-buildr" job="debian" srcdir="pkg" dest="target" />
              <ant buildfile="auto-deploy-testing/auto_upgrade_on_ubuntu.xml" target="upgrade.cruise -Dfrom.version='1.3.1'" />
            </tasks>
            <resources>
              <resource>autodeploy</resource>
              <resource>ubuntu8.10</resource>
            </resources>
            <artifacts>
              <artifact src="auto-deploy-testing/*.txt" />
              <artifact src="/var/log/cruise-server/cruise-server.log" />
              <artifact src="/var/log/cruise-agent/cruise-agent.log" />
              <test src="auto-deploy-testing/target/reports/xml" />
            </artifacts>
          </job>
          <job name="upgrade.from.1.3.0.to.latest">
            <environmentvariables>
              <variable name="USER_ID">cruise_builder</variable>
              <variable name="PASSWORD">VJamxt6z</variable>
            </environmentvariables>
            <tasks>
              <exec command="/bin/bash" args="-c &quot; rm -f target/pkg/* &quot;" />
              <fetchartifact pipeline="cruise" stage="dist-buildr" job="debian" srcdir="pkg" dest="target" />
              <ant buildfile="auto-deploy-testing/auto_upgrade_on_ubuntu.xml" target="upgrade.cruise -Dfrom.version='1.3.0'" />
            </tasks>
            <resources>
              <resource>autodeploy</resource>
              <resource>ubuntu8.10</resource>
            </resources>
            <artifacts>
              <artifact src="auto-deploy-testing/*.txt" />
              <artifact src="/var/log/cruise-server/cruise-server.log" />
              <artifact src="/var/log/cruise-agent/cruise-agent.log" />
              <test src="auto-deploy-testing/target/reports/xml" />
            </artifacts>
          </job>
          <job name="upgrade.from.1.2.1.to.latest">
            <environmentvariables>
              <variable name="USER_ID">cruise_builder</variable>
              <variable name="PASSWORD">VJamxt6z</variable>
            </environmentvariables>
            <tasks>
              <exec command="/bin/bash" args="-c &quot; rm -f target/pkg/* &quot;" />
              <fetchartifact pipeline="cruise" stage="dist-buildr" job="debian" srcdir="pkg" dest="target" />
              <ant buildfile="auto-deploy-testing/auto_upgrade_on_ubuntu.xml" target="upgrade.cruise -Dfrom.version='1.2.1'" />
            </tasks>
            <resources>
              <resource>autodeploy</resource>
              <resource>ubuntu8.10</resource>
            </resources>
            <artifacts>
              <artifact src="auto-deploy-testing/*.txt" />
              <artifact src="/var/log/cruise-server/cruise-server.log" />
              <artifact src="/var/log/cruise-agent/cruise-agent.log" />
              <test src="auto-deploy-testing/target/reports/xml" />
            </artifacts>
          </job>
          <job name="upgrade.from.1.2.0.to.latest">
            <environmentvariables>
              <variable name="USER_ID">cruise_builder</variable>
              <variable name="PASSWORD">VJamxt6z</variable>
            </environmentvariables>
            <tasks>
              <exec command="/bin/bash" args="-c &quot; rm -f target/pkg/* &quot;" />
              <fetchartifact pipeline="cruise" stage="dist-buildr" job="debian" srcdir="pkg" dest="target" />
              <ant buildfile="auto-deploy-testing/auto_upgrade_on_ubuntu.xml" target="upgrade.cruise -Dfrom.version='1.2.0'" />
            </tasks>
            <resources>
              <resource>autodeploy</resource>
              <resource>ubuntu8.10</resource>
            </resources>
            <artifacts>
              <artifact src="auto-deploy-testing/*.txt" />
              <artifact src="/var/log/cruise-server/cruise-server.log" />
              <artifact src="/var/log/cruise-agent/cruise-agent.log" />
              <test src="auto-deploy-testing/target/reports/xml" />
            </artifacts>
          </job>
        </jobs>
      </stage>
    </pipeline>
    <pipeline name="auto-deploy-testing-ubuntu9.10" labeltemplate="1.3.2.${cruise_pipeline}" isLocked="false">
      <timer>59 59 13 ? * *</timer>
      <materials>
        <hg url="https://abc:def@fmtstdscm01.somewhere.com/cruise_qa" />
        <pipeline pipelineName="cruise" stageName="dist-buildr" materialName="cruise_pipeline" />
      </materials>
      <stage name="fresh-install">
        <jobs>
          <job name="fresh.install.cruise">
            <environmentvariables>
              <variable name="MACHINE_IP">localhost</variable>
              <variable name="USER_ID">cruise_builder</variable>
              <variable name="PASSWORD">VJamxt6z</variable>
            </environmentvariables>
            <tasks>
              <exec command="/bin/bash" args="-c &quot; rm -f target/pkg/* &quot;" />
              <fetchartifact pipeline="cruise" stage="dist-buildr" job="debian" srcdir="pkg" dest="target" />
              <ant buildfile="auto-deploy-testing/auto_deploy_on_ubuntu.xml" target="install.cruise" />
              <exec command="/bin/bash" args="-c &quot; cp  /var/log/cruise-server/*.log target/ &quot;" />
              <exec command="/bin/bash" args="-c &quot; cp  /var/log/cruise-agent/*.log target/ &quot;" />
              <exec command="/bin/bash" args="-c &quot; cp  /var/lib/cruise-agent/*.log target/ &quot;" />
            </tasks>
            <resources>
              <resource>autodeploy</resource>
              <resource>ubuntu9.10</resource>
            </resources>
            <artifacts>
              <artifact src="auto-deploy-testing/*.txt" />
              <artifact src="target/*.log" />
              <test src="auto-deploy-testing/target/reports/xml" />
            </artifacts>
          </job>
        </jobs>
      </stage>
      <stage name="auto-upgrade">
        <jobs>
          <job name="upgrade.from.1.3.2.to.latest">
            <environmentvariables>
              <variable name="MACHINE_IP">localhost</variable>
              <variable name="USER_ID">cruise_builder</variable>
              <variable name="PASSWORD">VJamxt6z</variable>
            </environmentvariables>
            <tasks>
              <exec command="/bin/bash" args="-c &quot; rm -f target/pkg/* &quot;" />
              <fetchartifact pipeline="cruise" stage="dist-buildr" job="debian" srcdir="pkg" dest="target" />
              <ant buildfile="auto-deploy-testing/auto_upgrade_on_ubuntu.xml" target="upgrade.cruise -Dfrom.version='1.3.2' " />
              <exec command="/bin/bash" args="-c &quot; cp  /var/log/cruise-server/*.log /var/log/cruise-agent/*.log  /etc/cruise/*.xml target/ &quot;" />
            </tasks>
            <resources>
              <resource>autodeploy</resource>
              <resource>ubuntu9.10</resource>
            </resources>
            <artifacts>
              <artifact src="auto-deploy-testing/*.txt" />
              <artifact src="target/*.log" />
              <artifact src="target/*.xml" />
            </artifacts>
          </job>
          <job name="upgrade.from.1.3.1.to.latest">
            <environmentvariables>
              <variable name="MACHINE_IP">localhost</variable>
              <variable name="USER_ID">cruise_builder</variable>
              <variable name="PASSWORD">VJamxt6z</variable>
            </environmentvariables>
            <tasks>
              <exec command="/bin/bash" args="-c &quot; rm -f target/pkg/* &quot;" />
              <fetchartifact pipeline="cruise" stage="dist-buildr" job="debian" srcdir="pkg" dest="target" />
              <ant buildfile="auto-deploy-testing/auto_upgrade_on_ubuntu.xml" target="upgrade.cruise -Dfrom.version='1.3.1' " />
              <exec command="/bin/bash" args="-c &quot; cp  /var/log/cruise-server/*.log /var/log/cruise-agent/*.log  /etc/cruise/*.xml target/ &quot;" />
            </tasks>
            <resources>
              <resource>autodeploy</resource>
              <resource>ubuntu9.10</resource>
            </resources>
            <artifacts>
              <artifact src="auto-deploy-testing/*.txt" />
              <artifact src="target/*.log" />
              <artifact src="target/*.xml" />
            </artifacts>
          </job>
          <job name="upgrade.from.1.3.0.to.latest">
            <environmentvariables>
              <variable name="MACHINE_IP">localhost</variable>
              <variable name="USER_ID">cruise_builder</variable>
              <variable name="PASSWORD">VJamxt6z</variable>
            </environmentvariables>
            <tasks>
              <exec command="/bin/bash" args="-c &quot; rm -f target/pkg/* &quot;" />
              <fetchartifact pipeline="cruise" stage="dist-buildr" job="debian" srcdir="pkg" dest="target" />
              <ant buildfile="auto-deploy-testing/auto_upgrade_on_ubuntu.xml" target="upgrade.cruise -Dfrom.version='1.3.0'" />
              <exec command="/bin/bash" args="-c &quot; cp  /var/log/cruise-server/*.log /var/log/cruise-agent/*.log  /etc/cruise/*.xml target/ &quot;" />
            </tasks>
            <resources>
              <resource>autodeploy</resource>
              <resource>ubuntu9.10</resource>
            </resources>
            <artifacts>
              <artifact src="auto-deploy-testing/*.txt" />
              <artifact src="target/*.log" />
              <artifact src="target/*.xml" />
            </artifacts>
          </job>
          <job name="upgrade.from.1.2.1.to.latest">
            <environmentvariables>
              <variable name="MACHINE_IP">localhost</variable>
              <variable name="USER_ID">cruise_builder</variable>
              <variable name="PASSWORD">VJamxt6z</variable>
            </environmentvariables>
            <tasks>
              <exec command="/bin/bash" args="-c &quot; rm -f target/pkg/* &quot;" />
              <fetchartifact pipeline="cruise" stage="dist-buildr" job="debian" srcdir="pkg" dest="target" />
              <ant buildfile="auto-deploy-testing/auto_upgrade_on_ubuntu.xml" target="upgrade.cruise -Dfrom.version='1.2.1'  " />
              <exec command="/bin/bash" args="-c &quot; cp  /var/log/cruise-server/*.log /var/log/cruise-agent/*.log  /etc/cruise/*.xml target/ &quot;" />
            </tasks>
            <resources>
              <resource>autodeploy</resource>
              <resource>ubuntu9.10</resource>
            </resources>
            <artifacts>
              <artifact src="auto-deploy-testing/*.txt" />
              <artifact src="target/*.log" />
              <artifact src="target/*.xml" />
            </artifacts>
          </job>
          <job name="upgrade.from.1.2.0.to.latest">
            <environmentvariables>
              <variable name="MACHINE_IP">localhost</variable>
              <variable name="USER_ID">cruise_builder</variable>
              <variable name="PASSWORD">VJamxt6z</variable>
            </environmentvariables>
            <tasks>
              <exec command="/bin/bash" args="-c &quot; rm -f target/pkg/* &quot;" />
              <fetchartifact pipeline="cruise" stage="dist-buildr" job="debian" srcdir="pkg" dest="target" />
              <ant buildfile="auto-deploy-testing/auto_upgrade_on_ubuntu.xml" target="upgrade.cruise -Dfrom.version='1.2.0'  " />
              <exec command="/bin/bash" args="-c &quot; cp  /var/log/cruise-server/*.log /var/log/cruise-agent/*.log  /etc/cruise/*.xml target/ &quot;" />
            </tasks>
            <resources>
              <resource>autodeploy</resource>
              <resource>ubuntu9.10</resource>
            </resources>
            <artifacts>
              <artifact src="auto-deploy-testing/*.txt" />
              <artifact src="target/*.log" />
              <artifact src="target/*.xml" />
            </artifacts>
          </job>
        </jobs>
      </stage>
    </pipeline>
    <pipeline name="CandidateForUAT" labeltemplate="1.3.2.${cruise_pipeline}">
      <materials>
        <pipeline pipelineName="cruise" stageName="dist-buildr" materialName="cruise_pipeline" />
      </materials>
      <stage name="GetNewBuild">
        <approval type="manual" />
        <jobs>
          <job name="NewUATBuild">
            <tasks>
              <exec command="/bin/bash" args="-c &quot; rm -f ~/UATBuilds/NewCandidate/* &quot;" />
              <exec command="/bin/bash" args="-c &quot; rm -f target/pkg/* &quot;" />
              <fetchartifact pipeline="cruise" stage="dist-buildr" job="debian" srcdir="pkg" dest="target" />
              <exec command="/bin/bash" args="-c &quot; mv -f target/pkg/*server*.deb ~/UATBuilds/NewCandidate/ &quot;" />
            </tasks>
            <resources>
              <resource>UAT-Server</resource>
            </resources>
          </job>
        </jobs>
      </stage>
    </pipeline>
  </pipelines>
  <pipelines group="Showcase">
    <pipeline name="Manual.Pipeline" isLocked="true">
      <materials>
        <pipeline pipelineName="Pipeline.1" stageName="P1Stage2" />
        <pipeline pipelineName="Pipeline2" stageName="P2Stage2" />
      </materials>
      <stage name="Stage.1">
        <approval type="manual" />
        <jobs>
          <job name="Job.1">
            <tasks>
              <exec command="sleep" args="45" />
            </tasks>
          </job>
        </jobs>
      </stage>
      <stage name="Stage.2">
        <jobs>
          <job name="Job.1">
            <tasks>
              <exec command="sleep" args="5" />
            </tasks>
          </job>
        </jobs>
      </stage>
      <stage name="Stage.3">
        <jobs>
          <job name="Job.1">
            <tasks>
              <exec command="sleep" args="5" />
            </tasks>
          </job>
        </jobs>
      </stage>
      <stage name="Stage.4">
        <approval type="manual" />
        <jobs>
          <job name="Job.1">
            <tasks>
              <exec command="sleep" args="45" />
            </tasks>
          </job>
        </jobs>
      </stage>
      <stage name="Stage.5">
        <jobs>
          <job name="Job.1">
            <tasks>
              <exec command="sleep" args="5" />
            </tasks>
          </job>
        </jobs>
      </stage>
      <stage name="Stage.6">
        <jobs>
          <job name="Job.1">
            <tasks>
              <exec command="sleep" args="5" />
            </tasks>
          </job>
        </jobs>
      </stage>
    </pipeline>
    <pipeline name="Pipeline.1">
      <environmentvariables>
        <variable name="PipelineVar">PipelineVarVal</variable>
      </environmentvariables>
      <materials>
        <svn url="http://subversion.assembla.com/svn/tingtong/" dest="svn-folder" materialName="something" />
      </materials>
      <stage name="P1.Stage1">
        <approval type="manual" />
        <environmentvariables>
          <variable name="Stage1Var">Stage1VarVal</variable>
        </environmentvariables>
        <jobs>
          <job name="P1.S1.Job1">
            <tasks>
              <exec command="ls" args="." />
            </tasks>
          </job>
          <job name="P1.S1.Job2">
            <tasks>
              <exec command="ls" args="." />
            </tasks>
          </job>
        </jobs>
      </stage>
      <stage name="P1Stage2">
        <environmentvariables>
          <variable name="Stage2Var">Stage2VarVal</variable>
        </environmentvariables>
        <jobs>
          <job name="P1S2Job1">
            <environmentvariables>
              <variable name="JobVar">JobVarVal</variable>
            </environmentvariables>
            <tasks>
              <exec command="ls" args="." />
            </tasks>
          </job>
          <job name="P1S2Job2">
            <environmentvariables>
              <variable name="MyVar2">New Value</variable>
            </environmentvariables>
            <tasks>
              <exec command="ls" args="." />
            </tasks>
          </job>
        </jobs>
      </stage>
    </pipeline>
    <pipeline name="Pipeline2">
      <materials>
        <pipeline pipelineName="Pipeline.1" stageName="P1Stage2" />
      </materials>
      <stage name="P2Stage1">
        <approval type="manual" />
        <jobs>
          <job name="P2S1Job1">
            <tasks>
              <exec command="ls" args="." />
            </tasks>
          </job>
          <job name="P2S1Job2">
            <tasks>
              <exec command="ls" args="." />
            </tasks>
          </job>
        </jobs>
      </stage>
      <stage name="P2Stage2">
        <jobs>
          <job name="P2S2Job1" runOnAllAgents="true">
            <tasks>
              <exec command="ls" args="." />
            </tasks>
          </job>
          <job name="P2S2Job2">
            <tasks>
              <exec command="ls" args="." />
            </tasks>
          </job>
        </jobs>
      </stage>
    </pipeline>
    <pipeline name="Pipeline3">
      <timer>1 1/30 * * * ? *</timer>
      <materials>
        <pipeline pipelineName="Pipeline.1" stageName="P1Stage2" />
        <pipeline pipelineName="Pipeline2" stageName="P2Stage2" />
      </materials>
      <stage name="P3Stage1">
        <approval type="manual" />
        <jobs>
          <job name="P3S1Job1">
            <tasks>
              <exec command="ls" args="." />
            </tasks>
            <resources>
              <resource>showcase</resource>
              <resource>agent</resource>
            </resources>
          </job>
          <job name="P3S1Job2">
            <tasks>
              <exec command="ls" args="." />
            </tasks>
          </job>
        </jobs>
      </stage>
      <stage name="P3Stage2">
        <jobs>
          <job name="P3S2Job1" runOnAllAgents="true">
            <environmentvariables>
              <variable name="HOME">New Value</variable>
              <variable name="CRUISE_JOB_NAME">New Value</variable>
            </environmentvariables>
            <tasks>
              <exec command="sleep" args="60" />
            </tasks>
          </job>
          <job name="P3S2Job2">
            <tasks>
              <exec command="ls" args="." />
            </tasks>
          </job>
        </jobs>
      </stage>
    </pipeline>
  </pipelines>
  <pipelines group="dummy-pipelines">
    <pipeline name="DeployedToUAT" labeltemplate="1.3.2.${cruise_pipeline}">
      <materials>
        <pipeline pipelineName="cruise" stageName="dist-buildr" materialName="cruise_pipeline" />
      </materials>
      <stage name="NewBuild">
        <approval type="manual" />
        <jobs>
          <job name="Deploy">
            <tasks>
              <exec command="echo" args="new build deployed" />
            </tasks>
          </job>
        </jobs>
      </stage>
    </pipeline>
    <pipeline name="Production" labeltemplate="1.3.2.${cruise_pipeline}">
      <materials>
        <pipeline pipelineName="cruise-1.1" stageName="dist" materialName="cruise-1.1_pipeline" />
        <pipeline pipelineName="cruise-1.3.2" stageName="dist" materialName="cruise-1.3.2_pipeline" />
        <pipeline pipelineName="cruise" stageName="dist" materialName="cruise_pipeline" />
      </materials>
      <stage name="NewBuild">
        <approval type="manual" />
        <jobs>
          <job name="Deploy">
            <tasks>
              <exec command="echo" args="new build deployed" />
            </tasks>
          </job>
        </jobs>
      </stage>
    </pipeline>
    <pipeline name="Published" labeltemplate="1.3.2.${cruise_pipeline}">
      <materials>
        <pipeline pipelineName="cruise-1.1" stageName="dist" materialName="cruise-1.1_pipeline" />
        <pipeline pipelineName="cruise-1.3.2" stageName="dist" materialName="cruise-1.3.2_pipeline" />
        <pipeline pipelineName="cruise" stageName="dist" materialName="cruise_pipeline" />
      </materials>
      <stage name="NewBuild">
        <approval type="manual" />
        <jobs>
          <job name="Deploy">
            <tasks>
              <exec command="echo" args="new build deployed" />
            </tasks>
          </job>
        </jobs>
      </stage>
    </pipeline>
  </pipelines>
  <pipelines group="external">
    <authorization>
      <view>
        <role>developer</role>
      </view>
      <operate>
        <role>developer</role>
      </operate>
    </authorization>
    <pipeline name="cc.net">
      <materials>
        <svn url="http://ccnet.svn.sourceforge.net/svnroot/ccnet/trunk" />
      </materials>
      <stage name="dev">
        <approval type="manual" />
        <jobs>
          <job name="test">
            <tasks>
              <nant nantpath="tools\nant" buildfile="ccnet.build" target="clean test" />
            </tasks>
            <resources>
              <resource>nant</resource>
              <resource>cc.net</resource>
            </resources>
            <artifacts>
              <test src="build" />
            </artifacts>
          </job>
        </jobs>
      </stage>
    </pipeline>
  </pipelines>
  <pipelines group="internaloss">
    <pipeline name="cruise_client_rb">
      <materials>
        <hg url="https://oss_scm:******@internaloss.somewhere.com/hg/cruise_client_rb" autoUpdate="false" />
      </materials>
      <stage name="dev">
        <approval type="manual" />
        <jobs>
          <job name="build">
            <tasks>
              <rake />
            </tasks>
            <resources>
              <resource>rails</resource>
            </resources>
          </job>
        </jobs>
      </stage>
    </pipeline>
    <pipeline name="cruise_iphone">
      <materials>
        <hg url="https://oss_scm:******@internaloss.somewhere.com/hg/cruise_iphone" autoUpdate="false" />
      </materials>
      <stage name="dev">
        <approval type="manual" />
        <jobs>
          <job name="build">
            <tasks>
              <rake />
            </tasks>
            <resources>
              <resource>rails</resource>
            </resources>
          </job>
        </jobs>
      </stage>
    </pipeline>
  </pipelines>
  <pipelines group="new-performance">
    <pipeline name="cruise-ec2-plugin">
      <materials>
        <hg url="https://pair:zVVD@fmtstdscm01.somewhere.com/cruise-performance" dest="cruise-plugin-ec2" />
      </materials>
      <stage name="dist">
        <jobs>
          <job name="publish">
            <tasks>
              <exec command="/bin/bash" args="-c echo 'Creating artifact for plugin so ec2 agents can download it'" />
            </tasks>
            <resources>
              <resource>deploy-agent</resource>
            </resources>
            <artifacts>
              <artifact src="cruise-plugin-ec2/cruise-plugin-ec2" />
              <artifact src="cruise-plugin-ec2/performance-scripts" />
            </artifacts>
          </job>
        </jobs>
      </stage>
    </pipeline>
    <pipeline name="ec2-demo">
      <materials>
        <pipeline pipelineName="cruise-ec2-plugin" stageName="dist" />
        <pipeline pipelineName="cruise" stageName="dist-zip" />
      </materials>
      <stage name="ec2-setup">
        <jobs>
          <job name="start-ec2-agents">
            <environmentvariables>
              <variable name="CRUISE_USER">jez</variable>
              <variable name="CRUISE_PASSWORD">badger</variable>
            </environmentvariables>
            <tasks>
              <exec command="/bin/rm" workingdir="cruise-plugin-ec2">
                <arg value="-rf" />
                <arg value="artifacts" />
              </exec>
              <fetchartifact pipeline="cruise-ec2-plugin" stage="dist" job="publish" srcdir="cruise-plugin-ec2" />
              <exec command="/bin/bash" workingdir="cruise-plugin-ec2">
                <arg value="lib/jruby/bin/jruby" />
                <arg value="scripts/start-agents.rb" />
                <arg value="resources=[ec2,server]" />
              </exec>
              <exec command="/bin/bash" workingdir="cruise-plugin-ec2">
                <arg value="lib/jruby/bin/jruby" />
                <arg value="scripts/start-agents.rb" />
                <arg value="resources=[ec2,agent]" />
              </exec>
              <exec command="/bin/bash" workingdir="cruise-plugin-ec2">
                <arg value="lib/jruby/bin/jruby" />
                <arg value="scripts/start-agents.rb" />
                <arg value="resources=[ec2,load-machine]" />
              </exec>
            </tasks>
            <resources>
              <resource>deploy-agent</resource>
            </resources>
            <artifacts>
              <artifact src="cruise-plugin-ec2/artifacts" dest="cruise-plugin-ec2" />
            </artifacts>
          </job>
        </jobs>
      </stage>
      <stage name="run-on-ec2">
        <jobs>
          <job name="start-server">
            <tasks>
              <fetchartifact pipeline="cruise" stage="dist-zip" job="zip" srcdir="pkg" dest="performance-scripts" />
              <fetchartifact pipeline="cruise-ec2-plugin" stage="dist" job="publish" srcdir="performance-scripts" />
              <exec command="/bin/bash">
                <arg value="performance-scripts/start-server.sh" />
              </exec>
            </tasks>
            <resources>
              <resource>ec2</resource>
              <resource>server</resource>
            </resources>
          </job>
          <job name="start-agent">
            <tasks>
              <fetchartifact pipeline="ec2-demo" stage="ec2-setup" job="start-ec2-agents" srcdir="cruise-plugin-ec2/artifacts" dest="performance-scripts" />
              <fetchartifact pipeline="cruise-ec2-plugin" stage="dist" job="publish" srcdir="performance-scripts" />
              <exec command="/usr/bin/ruby" workingdir="performance-scripts">
                <arg value="start-performance-agents.rb" />
              </exec>
            </tasks>
            <resources>
              <resource>ec2</resource>
              <resource>agent</resource>
            </resources>
          </job>
        </jobs>
      </stage>
      <stage name="run-performance-tests">
        <jobs>
          <job name="server">
            <tasks>
              <fetchartifact pipeline="ec2-demo" stage="ec2-setup" job="start-ec2-agents" srcdir="cruise-plugin-ec2/artifacts" dest="performance-scripts" />
              <fetchartifact pipeline="cruise-ec2-plugin" stage="dist" job="publish" srcdir="performance-scripts" />
              <fetchartifact pipeline="cruise-ec2-plugin" stage="dist" job="publish" srcdir="cruise-plugin-ec2" />
              <exec command="/bin/bash" workingdir="performance-scripts">
                <arg value="../cruise-plugin-ec2/jruby/bin/jruby" />
                <arg value="start-server-load.rb" />
              </exec>
            </tasks>
            <resources>
              <resource>ec2</resource>
              <resource>server</resource>
            </resources>
            <artifacts>
              <artifact src="performance-scripts/results" />
            </artifacts>
          </job>
          <job name="load-machine">
            <tasks>
              <fetchartifact pipeline="ec2-demo" stage="ec2-setup" job="start-ec2-agents" srcdir="cruise-plugin-ec2/artifacts" dest="performance-scripts" />
              <fetchartifact pipeline="cruise-ec2-plugin" stage="dist" job="publish" srcdir="performance-scripts" />
              <exec command="/usr/bin/ruby" workingdir="performance-scripts">
                <arg value="start-load-machine.rb" />
              </exec>
            </tasks>
            <resources>
              <resource>ec2</resource>
              <resource>load-machine</resource>
            </resources>
            <artifacts>
              <artifact src="performance-scripts/results" />
            </artifacts>
          </job>
        </jobs>
      </stage>
      <stage name="collect-results">
        <jobs>
          <job name="analyse-results">
            <tasks>
              <fetchartifact pipeline="cruise-ec2-plugin" stage="dist" job="publish" srcdir="performance-scripts" />
              <exec command="/bin/rm" args="-rf server/results" workingdir="performance-scripts" />
              <exec command="/bin/rm" args="-rf load-machine/results" workingdir="performance-scripts" />
              <exec command="/bin/rm" args="-rf results" workingdir="performance-scripts" />
              <fetchartifact pipeline="ec2-demo" stage="run-performance-tests" job="server" srcdir="results" dest="performance-scripts/server" />
              <fetchartifact pipeline="ec2-demo" stage="run-performance-tests" job="load-machine" srcdir="results" dest="performance-scripts/load-machine" />
              <exec command="/usr/bin/ruby" workingdir="performance-scripts">
                <arg value="analyse-results.rb" />
              </exec>
            </tasks>
            <tabs>
              <tab name="results" path="results/analysis.html" />
            </tabs>
            <resources>
              <resource>deploy-agent</resource>
            </resources>
            <artifacts>
              <artifact src="performance-scripts/results" />
            </artifacts>
          </job>
        </jobs>
      </stage>
      <stage name="ec2-teardown">
        <jobs>
          <job name="stop-ec2-agents">
            <environmentvariables>
              <variable name="CRUISE_USER">jez</variable>
              <variable name="CRUISE_PASSWORD">badger</variable>
            </environmentvariables>
            <tasks>
              <fetchartifact stage="ec2-setup" job="start-ec2-agents" srcdir="cruise-plugin-ec2/artifacts" dest="cruise-plugin-ec2" />
              <fetchartifact pipeline="cruise-ec2-plugin" stage="dist" job="publish" srcdir="cruise-plugin-ec2" />
              <exec command="/bin/bash" args="lib/jruby/bin/jruby scripts/stop-agents.rb" workingdir="cruise-plugin-ec2" />
            </tasks>
            <resources>
              <resource>deploy-agent</resource>
            </resources>
          </job>
        </jobs>
      </stage>
    </pipeline>
  </pipelines>
  <pipelines group="others">
    <pipeline name="test-load-balancer" labeltemplate="1.1.${COUNT}">
      <materials>
        <git url="git://github.com/skizz/test-load-balancer.git">
          <filter>
            <ignore pattern="README" />
          </filter>
        </git>
      </materials>
      <stage name="checkin-gate">
        <approval type="success">
          <authorization>
            <user>jez</user>
          </authorization>
        </approval>
        <jobs>
          <job name="test1">
            <tasks>
              <ant buildfile="build.xml" />
            </tasks>
            <resources>
              <resource>tlb</resource>
            </resources>
          </job>
          <job name="test2">
            <resources>
              <resource>tlb</resource>
            </resources>
          </job>
        </jobs>
      </stage>
      <stage name="dist">
        <jobs>
          <job name="dist-jar">
            <tasks>
              <ant buildfile="build.xml" target="jar" />
            </tasks>
            <resources>
              <resource>tl</resource>
            </resources>
            <artifacts>
              <artifact src="target/test-load-balancer.jar" dest="dist" />
            </artifacts>
          </job>
        </jobs>
      </stage>
    </pipeline>
    <pipeline name="cleanup-agents">
      <materials>
        <pipeline pipelineName="cruise" stageName="dev" />
      </materials>
      <stage name="cleanup-agents">
        <approval type="manual" />
        <jobs>
          <job name="cleanup-agent" runOnAllAgents="true">
            <tasks>
              <exec command="/bin/bash" args="-c &quot;rm -r ../testing&quot;" />
            </tasks>
            <resources>
              <resource>cleanup</resource>
            </resources>
          </job>
        </jobs>
      </stage>
    </pipeline>
  </pipelines>
  <environments>
    <environment name="UAT">
      <agents>
        <physical uuid="c0103097-134a-4aac-83b7-bbe29173c358" />
      </agents>
      <pipelines>
        <pipeline name="DeployedToUAT" />
        <pipeline name="CandidateForUAT" />
      </pipelines>
    </environment>
    <environment name="AutoDeployTesting">
      <environmentvariables>
        <variable name="USER_ID">cce</variable>
      </environmentvariables>
      <agents>
        <physical uuid="91aeab95-60f8-46a5-be08-cc215f8f5fa4" />
        <physical uuid="48a2aad2-2ca8-40bc-a9c6-61162bf2c1d4" />
        <physical uuid="e33b27e5-17e5-4a48-aa1b-7f99b5e3444a" />
      </agents>
      <pipelines>
        <pipeline name="auto-deploy-testing-ubuntu9.10" />
        <pipeline name="auto-deploy-testing-ubuntu8.10" />
      </pipelines>
    </environment>
    <environment name="performance">
      <environmentvariables>
        <variable name="NUMBER_OF_AGENTS">5</variable>
        <variable name="DURATION">15m</variable>
        <variable name="AB_TOTAL">500</variable>
        <variable name="AB_CONCURRENCY">10</variable>
      </environmentvariables>
      <pipelines>
        <pipeline name="cruise-ec2-plugin" />
        <pipeline name="ec2-demo" />
      </pipelines>
    </environment>
    <environment name="PersonalBuildServer">
      <agents>
        <physical uuid="8d1f62b5-6ee5-409c-9912-7bdf3c0bb2e6" />
      </agents>
      <pipelines>
        <pipeline name="PBS-SFO" />
      </pipelines>
    </environment>
    <environment name="OutOfDoor">
      <agents>
        <physical uuid="c0103097-134a-4aac-83b7-bbe29173c358" />
      </agents>
      <pipelines>
        <pipeline name="Production" />
        <pipeline name="Published" />
      </pipelines>
    </environment>
    <environment name="Showcase">
      <environmentvariables>
        <variable name="MyVar1">Default Value1</variable>
        <variable name="MyVar2">Default Value2</variable>
      </environmentvariables>
      <agents>
        <physical uuid="c0103097-134a-4aac-83b7-bbe29173c358" />
        <physical uuid="8d1f62b5-6ee5-409c-9912-7bdf3c0bb2e6" />
        <physical uuid="a97a1f22-5a32-4294-b6b6-a1f83269f9f3" />
        <physical uuid="91aeab95-60f8-46a5-be08-cc215f8f5fa4" />
      </agents>
      <pipelines>
        <pipeline name="Pipeline2" />
        <pipeline name="Pipeline.1" />
      </pipelines>
    </environment>
    <environment name="Showcase2">
      <agents>
        <physical uuid="a97a1f22-5a32-4294-b6b6-a1f83269f9f3" />
        <physical uuid="91aeab95-60f8-46a5-be08-cc215f8f5fa4" />
        <physical uuid="c0103097-134a-4aac-83b7-bbe29173c358" />
      </agents>
      <pipelines>
        <pipeline name="Manual.Pipeline" />
        <pipeline name="Pipeline3" />
      </pipelines>
    </environment>
  </environments>
  <agents>
    <agent hostname="fmtstdcsruat04.somewhere.com" ipaddress="10.38.10.4" uuid="2826d47f-8bea-443a-9013-ab6bb9b02661">
      <resources>
        <resource>linux</resource>
        <resource>twist-new</resource>
      </resources>
    </agent>
    <agent hostname="fmtstdcsruat12.somewhere.com" ipaddress="10.38.10.12" uuid="4a2298ae-daa7-43d2-821a-c683e00f9a0e">
      <resources>
        <resource>dev</resource>
        <resource>java</resource>
        <resource>linux</resource>
      </resources>
    </agent>
    <agent hostname="fmtstdcsruat08.somewhere.com" ipaddress="10.38.10.8" uuid="32912050-9545-4950-a6e9-afbef7364479">
      <resources>
        <resource>dev</resource>
        <resource>java</resource>
        <resource>linux</resource>
        <resource>debian</resource>
        <resource>tlb</resource>
      </resources>
    </agent>
    <agent hostname="fmtstdcsruat10.somewhere.com" ipaddress="10.38.10.10" uuid="d8b9df8f-49db-468b-b524-797c9f07f8ad">
      <resources>
        <resource>dev</resource>
        <resource>java</resource>
        <resource>linux</resource>
        <resource>debian</resource>
      </resources>
    </agent>
    <agent hostname="fmtstdcsr02" ipaddress="10.38.10.252" uuid="c0103097-134a-4aac-83b7-bbe29173c358">
      <resources>
        <resource>UAT-Server</resource>
      </resources>
    </agent>
    <agent hostname="fmtstdcsruat13.somewhere.com" ipaddress="10.38.10.13" uuid="d6149aa5-417d-4915-a8f9-dd80212dbe4c">
      <resources>
        <resource>java</resource>
        <resource>solaris</resource>
      </resources>
    </agent>
    <agent hostname="fmtstdcsruat02.somewhere.com" ipaddress="10.38.10.2" uuid="dcff174d-2271-4828-8191-8323ef23d4af">
      <resources>
        <resource>deploy-agent</resource>
        <resource>linux</resource>
        <resource>tlb</resource>
        <resource>twist-new</resource>
      </resources>
    </agent>
    <agent hostname="fmtstdcsruat01" ipaddress="10.38.10.1" uuid="a698331e-5aeb-4828-b164-1bd3ada2c50f">
      <resources>
        <resource>twist-new</resource>
        <resource>windows</resource>
      </resources>
    </agent>
    <agent hostname="fmtstdcsruat03" ipaddress="10.38.10.3" uuid="089c722a-08ff-4e11-917b-abbe4e0caafe">
      <resources>
        <resource>windows</resource>
        <resource>twist-new</resource>
      </resources>
    </agent>
    <agent hostname="fmtstdcsruat05" ipaddress="10.38.10.5" uuid="126c201b-4a94-43a9-9e0d-21ec13b2a745">
      <resources>
        <resource>dev</resource>
        <resource>java</resource>
        <resource>windows</resource>
      </resources>
    </agent>
    <agent hostname="fmtstdcsruat09" ipaddress="10.38.10.9" uuid="d5a09e4e-e2e6-42ca-924f-5bf698bef111">
      <resources>
        <resource>dev</resource>
        <resource>java</resource>
        <resource>windows</resource>
      </resources>
    </agent>
    <agent hostname="fmtstdcsruat11" ipaddress="10.38.10.11" uuid="bdb7ba9d-a79c-48f9-939a-d966a39330f5">
      <resources>
        <resource>dev</resource>
        <resource>java</resource>
        <resource>windows</resource>
      </resources>
    </agent>
    <agent hostname="fmtstdcsrato01" ipaddress="10.38.10.51" uuid="48a2aad2-2ca8-40bc-a9c6-61162bf2c1d4">
      <resources>
        <resource>autodeploy</resource>
        <resource>win2008</resource>
      </resources>
    </agent>
    <agent hostname="FMTSTDCSRATO02" ipaddress="10.38.10.52" uuid="e33b27e5-17e5-4a48-aa1b-7f99b5e3444a">
      <resources>
        <resource>autodeploy</resource>
        <resource>win7</resource>
      </resources>
    </agent>
    <agent hostname="fmtstdcsrato09" ipaddress="10.38.10.59" uuid="91aeab95-60f8-46a5-be08-cc215f8f5fa4">
      <resources>
        <resource>autodeploy</resource>
        <resource>ubuntu9.10</resource>
      </resources>
    </agent>
    <agent hostname="fmtstdcsrato08" ipaddress="10.38.10.58" uuid="a97a1f22-5a32-4294-b6b6-a1f83269f9f3">
      <resources>
        <resource>ubuntu8.10</resource>
        <resource>linux</resource>
        <resource>performance-server</resource>
        <resource>autodeploy</resource>
        <resource>showcase</resource>
      </resources>
    </agent>
    <agent hostname="ubuntu-test01" ipaddress="10.18.3.66" uuid="49ce4a47-57dc-41c0-bac7-d0667fe351a5">
      <resources>
        <resource>autodeploy</resource>
        <resource>ubuntu</resource>
      </resources>
    </agent>
    <agent hostname="fmtstdcsr03.somewhere.com" ipaddress="10.38.10.251" uuid="8d1f62b5-6ee5-409c-9912-7bdf3c0bb2e6">
      <resources>
        <resource>pbs-sfo</resource>
        <resource>autodeploy</resource>
      </resources>
    </agent>
    <agent hostname="fmtstdcsruat14.somewhere.com" ipaddress="10.38.10.14" uuid="74e84369-e14f-4e3f-ba0e-37a0fdecc4d1">
      <resources>
        <resource>dev</resource>
        <resource>java</resource>
        <resource>linux</resource>
      </resources>
    </agent>
    <agent hostname="fmtstdcsruat16.somewhere.com" ipaddress="10.38.10.16" uuid="6ee1ea95-8e08-414d-b9ca-d4f8652812df">
      <resources>
        <resource>linux</resource>
        <resource>twist-new</resource>
      </resources>
    </agent>
    <agent hostname="fmtstdcsruat18.somewhere.com" ipaddress="10.38.10.18" uuid="f211b746-6596-4a2b-9c13-4a926887774d">
      <resources>
        <resource>linux</resource>
        <resource>twist-new</resource>
      </resources>
    </agent>
    <agent hostname="fmtstdcsruat20.somewhere.com" ipaddress="10.38.10.20" uuid="fcc665c7-b266-4670-962e-d01456c5f629">
      <resources>
        <resource>dev</resource>
        <resource>java</resource>
        <resource>linux</resource>
      </resources>
    </agent>
    <agent hostname="fmtstdcsruat22.somewhere.com" ipaddress="10.38.10.22" uuid="6718b70f-b894-42ac-bd6d-0ae48f645934">
      <resources>
        <resource>dev</resource>
        <resource>java</resource>
        <resource>linux</resource>
      </resources>
    </agent>
    <agent hostname="fmtstdcsruat24.somewhere.com" ipaddress="10.38.10.24" uuid="4ae63bdb-ff40-4490-926d-d3aff29cde89">
      <resources>
        <resource>dev</resource>
        <resource>java</resource>
        <resource>linux</resource>
      </resources>
    </agent>
    <agent hostname="fmtstdshnbgr01.somewhere.com" ipaddress="10.38.9.1" uuid="d0f45c0b-c3a8-4fa4-a97d-ed23c6114ae7">
      <resources>
        <resource>shine</resource>
      </resources>
    </agent>
    <agent hostname="fmtstdcsruat07" ipaddress="10.38.10.7" uuid="ab0d1e37-541e-48d9-88d5-51d46176a166">
      <resources>
        <resource>dev</resource>
        <resource>java</resource>
        <resource>windows</resource>
      </resources>
    </agent>
    <agent hostname="fmtstdcsruat15" ipaddress="10.38.10.15" uuid="8b4419ea-e648-4d76-b0fb-a790e12b5bc2" isDisabled="true">
      <resources>
        <resource>twist-new</resource>
        <resource>windows</resource>
      </resources>
    </agent>
    <agent hostname="fmtstdcsruat17" ipaddress="10.38.10.17" uuid="c56ff6cc-1152-45ef-ac7e-0ae5d49e3890" isDisabled="true">
      <resources>
        <resource>twist-new</resource>
        <resource>windows</resource>
      </resources>
    </agent>
    <agent hostname="fmtstdcsruat19" ipaddress="10.38.10.19" uuid="535a27b4-5dfc-4e41-b2ac-b42f166425db">
      <resources>
        <resource>dev</resource>
        <resource>java</resource>
        <resource>windows</resource>
      </resources>
    </agent>
    <agent hostname="fmtstdcsruat21" ipaddress="10.38.10.21" uuid="a3003279-d5e1-450a-a0a6-c684bbaf1141">
      <resources>
        <resource>dev</resource>
        <resource>java</resource>
        <resource>windows</resource>
      </resources>
    </agent>
    <agent hostname="fmtstdcsruat23" ipaddress="10.38.10.23" uuid="9eb67999-d743-4ac0-a914-f077942e979b">
      <resources>
        <resource>dev</resource>
        <resource>java</resource>
        <resource>windows</resource>
      </resources>
    </agent>
    <agent hostname="fmtstdcsruat25" ipaddress="10.38.10.25" uuid="a2710e41-3087-469e-8ef8-3643203e455a">
      <resources>
        <resource>dev</resource>
        <resource>java</resource>
        <resource>windows</resource>
      </resources>
    </agent>
    <agent hostname="fmtstdcsruat27" ipaddress="10.38.10.27" uuid="5e205922-e47b-42de-bdf2-6436e8956450">
      <resources>
        <resource>dev</resource>
        <resource>java</resource>
        <resource>windows</resource>
      </resources>
    </agent>
    <agent hostname="fmtstdcsruat29" ipaddress="10.38.10.29" uuid="f6d4d730-8d57-49b1-b0f6-8d2c946efa01" isDisabled="true">
      <resources>
        <resource>twist-new</resource>
        <resource>windows</resource>
      </resources>
    </agent>
    <agent hostname="fmtstdcsruat31" ipaddress="10.38.10.31" uuid="148a67f3-4c18-44f5-a180-5f7dcb6f533c">
      <resources>
        <resource>twist-new</resource>
        <resource>windows</resource>
      </resources>
    </agent>
    <agent hostname="fmtstdcsruat33" ipaddress="10.38.10.33" uuid="31883898-3a95-42b8-a6eb-dfbe950308ff" isDisabled="true">
      <resources>
        <resource>twist-new</resource>
        <resource>windows</resource>
      </resources>
    </agent>
    <agent hostname="fmtstdcsruat06.somewhere.com" ipaddress="10.38.10.6" uuid="6a8a6422-c519-46e2-937c-f39f73cb7fd1">
      <resources>
        <resource>dev</resource>
        <resource>java</resource>
        <resource>linux</resource>
      </resources>
    </agent>
    <agent hostname="fmtstdcsruat26.somewhere.com" ipaddress="10.38.10.26" uuid="566ab0cc-080a-4bde-b12e-32c0a6b36960">
      <resources>
        <resource>dev</resource>
        <resource>java</resource>
        <resource>linux</resource>
      </resources>
    </agent>
    <agent hostname="fmtstdcsruat28.somewhere.com" ipaddress="10.38.10.28" uuid="870cbf84-6ab1-43cd-8ab7-beab30777110">
      <resources>
        <resource>dev</resource>
        <resource>java</resource>
        <resource>linux</resource>
      </resources>
    </agent>
    <agent hostname="fmtstdcsruat30.somewhere.com" ipaddress="10.38.10.30" uuid="b520917b-35bb-4fb6-a19c-d173cf6af56c">
      <resources>
        <resource>linux</resource>
        <resource>twist-new</resource>
      </resources>
    </agent>
    <agent hostname="fmtstdcsruat32.somewhere.com" ipaddress="10.38.10.32" uuid="5c397900-9bf9-4c03-8d6c-16e8cdd01347">
      <resources>
        <resource>linux</resource>
        <resource>twist-new</resource>
      </resources>
    </agent>
    <agent hostname="fmtstdcsruat34.somewhere.com" ipaddress="10.38.10.34" uuid="24c6d9a4-13de-4e3f-86d1-125eb643b526" isDisabled="true">
      <resources>
        <resource>linux</resource>
        <resource>twist-new</resource>
      </resources>
    </agent>
    <agent hostname="fmtstdcsruat35" ipaddress="10.38.10.35" uuid="4ee78dec-5e7c-456f-bde8-9e893ac0d67c">
      <resources>
        <resource>dev</resource>
        <resource>java</resource>
        <resource>windows</resource>
      </resources>
    </agent>
    <agent hostname="blrstdcrsuat01.somewhere.com" ipaddress="10.4.8.1" uuid="d2b4637e-0412-4148-b272-ae4273eb3250">
      <resources>
        <resource>dev</resource>
        <resource>java</resource>
        <resource>linux</resource>
      </resources>
    </agent>
    <agent hostname="blrstdcrsuat101" ipaddress="10.4.8.101" uuid="91063e8f-a584-41cb-a2fd-23ec510197ea">
      <resources>
        <resource>dev</resource>
        <resource>java</resource>
        <resource>windows</resource>
      </resources>
    </agent>
    <agent hostname="blrstdcrsuat101" ipaddress="10.4.8.101" uuid="5cd57d1f-1231-4776-abdc-ee664041f579">
      <resources>
        <resource>dev</resource>
        <resource>java</resource>
        <resource>windows</resource>
      </resources>
    </agent>
    <agent hostname="blrstdcrsuat02.somewhere.com" ipaddress="10.4.8.2" uuid="4f94dea2-c0bc-4347-9a7e-5bcfbe1c335b" isDisabled="true">
      <resources>
        <resource>linux</resource>
        <resource>blr</resource>
        <resource>twist-new</resource>
      </resources>
    </agent>
    <agent hostname="blrstdcrsuat102" ipaddress="10.4.8.102" uuid="856162ec-5cc4-4f56-90ec-6864d33423b1">
      <resources>
        <resource>blr</resource>
        <resource>dev</resource>
        <resource>java</resource>
        <resource>twist-new</resource>
        <resource>windows</resource>
      </resources>
    </agent>
  </agents>
</cruise>

